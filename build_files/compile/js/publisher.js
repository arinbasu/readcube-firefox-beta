webpackJsonp([0],[,,,,,,function(t,e,n){var i=n(3),r=n(10),o=n(1),a=n(0),s=n(7);t.exports=i(r,{getMetadata:function(t){for(var e=["doi","pmid"],n=this.getIdentifiers(t),i=null,r=0;r<e.length;r++){var l=e[r];if(o.get(n,l,null)){i={},i[l]=o.get(n,l);break}}return i?this.getAngularInjector(function(t){return s.post(a.URL_ARTICLES_METADATA,{ext_ids:[i]}).then(function(e){var n=o.get(e,"data.[0]",null);return n?o.pick(n,"title","year","journal","authors","chapter"):t.reject("No article metadata on Readcube")}).catch(function(t){return console.error(t),null})}):null}})},function(t,e,n){function i(t,e,n,i,a){var s=r.defer(),l=new XMLHttpRequest;return l.open(e,t,!0),l.onload=function(){l.status>=200&&l.status<400?s.resolve({data:i?l.responseText:JSON.parse(l.responseText),status:l.status,url:l.responseURL}):s.reject({status:l.status})},l.onerror=function(){s.reject("Error in xhr."+e)},o.isReadcubeUrl(t)&&c.forEach(function(t){l.setRequestHeader(t[0],t[1])}),a&&l.setRequestHeader("Accept",a),n?(l.setRequestHeader("Content-Type","application/json; charset=UTF-8"),l.send(JSON.stringify(n))):l.send(),s.promise}var r=n(8),o=n(13),a=n(5).sprintf,s=n(0),l=chrome.runtime.getManifest().version,c=[["Sync-Version",s.HEADER_SYNC_VERSION],["X-Readcube-Sync-Token",a(s.HEADER_VALUE_SYNC_TOKEN,l)],["X-Readcube-Sync-Client",a(s.HEADER_VALUE_SYNC_CLIENT,"chrome",l)]];!function(){var t}();t.exports={get:function(t,e,n){return i(t,"GET",null,e,n)},patch:function(t,e){return i(t,"PATCH",e)},delete:function(t){return i(t,"DELETE")},post:function(t,e){return i(t,"POST",e)}}},function(t,e,n){(function(e,n){/*!
 *
 * Copyright 2009-2012 Kris Kowal under the terms of the MIT
 * license found at http://github.com/kriskowal/q/raw/master/LICENSE
 *
 * With parts by Tyler Close
 * Copyright 2007-2009 Tyler Close under the terms of the MIT X license found
 * at http://www.opensource.org/licenses/mit-license.html
 * Forked at ref_send.js version: 2009-05-11
 *
 * With parts by Mark Miller
 * Copyright (C) 2011 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */
!function(e){"use strict";if("function"==typeof bootstrap)bootstrap("promise",e);else{t.exports=e()}}(function(){"use strict";function t(t){return function(){return q.apply(t,arguments)}}function i(t){return t===Object(t)}function r(t){return"[object StopIteration]"===nt(t)||t instanceof $}function o(t,e){if(G&&e.stack&&"object"==typeof t&&null!==t&&t.stack&&-1===t.stack.indexOf(it)){for(var n=[],i=e;i;i=i.source)i.stack&&n.unshift(i.stack);n.unshift(t.stack);var r=n.join("\n"+it+"\n");t.stack=a(r)}}function a(t){for(var e=t.split("\n"),n=[],i=0;i<e.length;++i){var r=e[i];c(r)||s(r)||!r||n.push(r)}return n.join("\n")}function s(t){return-1!==t.indexOf("(module.js:")||-1!==t.indexOf("(node.js:")}function l(t){var e=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(t);if(e)return[e[1],Number(e[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(t);if(n)return[n[1],Number(n[2])];var i=/.*@(.+):(\d+)$/.exec(t);return i?[i[1],Number(i[2])]:void 0}function c(t){var e=l(t);if(!e)return!1;var n=e[0],i=e[1];return n===X&&i>=W&&i<=lt}function u(){if(G)try{throw new Error}catch(i){var t=i.stack.split("\n"),e=t[0].indexOf("@")>0?t[1]:t[2],n=l(e);if(!n)return;return X=n[0],n[1]}}function d(t){return t instanceof g?t:b(t)?P(t):R(t)}function f(){function t(t){e=t,o.source=t,Q(n,function(e,n){d.nextTick(function(){t.promiseDispatch.apply(t,n)})},void 0),n=void 0,i=void 0}var e,n=[],i=[],r=Z(f.prototype),o=Z(g.prototype);if(o.promiseDispatch=function(t,r,o){var a=z(arguments);n?(n.push(a),"when"===r&&o[1]&&i.push(o[1])):d.nextTick(function(){e.promiseDispatch.apply(e,a)})},o.valueOf=function(){if(n)return o;var t=m(e);return _(t)&&(e=t),t},o.inspect=function(){return e?e.inspect():{state:"pending"}},d.longStackSupport&&G)try{throw new Error}catch(t){o.stack=t.stack.substring(t.stack.indexOf("\n")+1)}return r.promise=o,r.resolve=function(n){e||t(d(n))},r.fulfill=function(n){e||t(R(n))},r.reject=function(n){e||t(L(n))},r.notify=function(t){e||Q(i,function(e,n){d.nextTick(function(){n(t)})},void 0)},r}function p(t){if("function"!=typeof t)throw new TypeError("resolver must be a function.");var e=f();try{t(e.resolve,e.reject,e.notify)}catch(t){e.reject(t)}return e.promise}function h(t){return p(function(e,n){for(var i=0,r=t.length;i<r;i++)d(t[i]).then(e,n)})}function g(t,e,n){void 0===e&&(e=function(t){return L(new Error("Promise does not support operation: "+t))}),void 0===n&&(n=function(){return{state:"unknown"}});var i=Z(g.prototype);if(i.promiseDispatch=function(n,r,o){var a;try{a=t[r]?t[r].apply(i,o):e.call(i,r,o)}catch(t){a=L(t)}n&&n(a)},i.inspect=n,n){var r=n();"rejected"===r.state&&(i.exception=r.reason),i.valueOf=function(){var t=n();return"pending"===t.state||"rejected"===t.state?i:t.value}}return i}function v(t,e,n,i){return d(t).then(e,n,i)}function m(t){if(_(t)){var e=t.inspect();if("fulfilled"===e.state)return e.value}return t}function _(t){return t instanceof g}function b(t){return i(t)&&"function"==typeof t.then}function y(t){return _(t)&&"pending"===t.inspect().state}function E(t){return!_(t)||"fulfilled"===t.inspect().state}function A(t){return _(t)&&"rejected"===t.inspect().state}function w(){rt.length=0,ot.length=0,st||(st=!0)}function I(t,n){st&&("object"==typeof e&&"function"==typeof e.emit&&d.nextTick.runAfter(function(){-1!==J(ot,t)&&(e.emit("unhandledRejection",n,t),at.push(t))}),ot.push(t),n&&void 0!==n.stack?rt.push(n.stack):rt.push("(no stack) "+n))}function T(t){if(st){var n=J(ot,t);-1!==n&&("object"==typeof e&&"function"==typeof e.emit&&d.nextTick.runAfter(function(){var i=J(at,t);-1!==i&&(e.emit("rejectionHandled",rt[n],t),at.splice(i,1))}),ot.splice(n,1),rt.splice(n,1))}}function L(t){var e=g({when:function(e){return e&&T(this),e?e(t):this}},function(){return this},function(){return{state:"rejected",reason:t}});return I(e,t),e}function R(t){return g({when:function(){return t},get:function(e){return t[e]},set:function(e,n){t[e]=n},delete:function(e){delete t[e]},post:function(e,n){return null===e||void 0===e?t.apply(void 0,n):t[e].apply(t,n)},apply:function(e,n){return t.apply(e,n)},keys:function(){return et(t)}},void 0,function(){return{state:"fulfilled",value:t}})}function P(t){var e=f();return d.nextTick(function(){try{t.then(e.resolve,e.reject,e.notify)}catch(t){e.reject(t)}}),e.promise}function S(t){return g({isDef:function(){}},function(e,n){return N(t,e,n)},function(){return d(t).inspect()})}function x(t,e,n){return d(t).spread(e,n)}function O(t){return function(){function e(t,e){var a;if("undefined"==typeof StopIteration){try{a=n[t](e)}catch(t){return L(t)}return a.done?d(a.value):v(a.value,i,o)}try{a=n[t](e)}catch(t){return r(t)?d(t.value):L(t)}return v(a,i,o)}var n=t.apply(this,arguments),i=e.bind(e,"next"),o=e.bind(e,"throw");return i()}}function U(t){d.done(d.async(t)())}function D(t){throw new $(t)}function C(t){return function(){return x([this,k(arguments)],function(e,n){return t.apply(e,n)})}}function N(t,e,n){return d(t).dispatch(e,n)}function k(t){return v(t,function(t){var e=0,n=f();return Q(t,function(i,r,o){var a;_(r)&&"fulfilled"===(a=r.inspect()).state?t[o]=a.value:(++e,v(r,function(i){t[o]=i,0==--e&&n.resolve(t)},n.reject,function(t){n.notify({index:o,value:t})}))},void 0),0===e&&n.resolve(t),n.promise})}function j(t){if(0===t.length)return d.resolve();var e=d.defer(),n=0;return Q(t,function(i,r,o){function a(t){e.resolve(t)}function s(){0===--n&&e.reject(new Error("Can't get fulfillment value from any promise, all promises were rejected."))}function l(t){e.notify({index:o,value:t})}var c=t[o];n++,v(c,a,s,l)},void 0),e.promise}function B(t){return v(t,function(t){return t=K(t,d),v(k(K(t,function(t){return v(t,Y,Y)})),function(){return t})})}function M(t){return d(t).allSettled()}function H(t,e){return d(t).then(void 0,void 0,e)}function F(t,e){return d(t).nodeify(e)}var G=!1;try{throw new Error}catch(t){G=!!t.stack}var X,$,W=u(),Y=function(){},V=function(){function t(){for(var t,e;r.next;)r=r.next,t=r.task,r.task=void 0,e=r.domain,e&&(r.domain=void 0,e.enter()),i(t,e);for(;c.length;)t=c.pop(),i(t);a=!1}function i(e,n){try{e()}catch(e){if(l)throw n&&n.exit(),setTimeout(t,0),n&&n.enter(),e;setTimeout(function(){throw e},0)}n&&n.exit()}var r={task:void 0,next:null},o=r,a=!1,s=void 0,l=!1,c=[];if(V=function(t){o=o.next={task:t,domain:l&&e.domain,next:null},a||(a=!0,s())},"object"==typeof e&&"[object process]"===e.toString()&&e.nextTick)l=!0,s=function(){e.nextTick(t)};else if("function"==typeof n)s="undefined"!=typeof window?n.bind(window,t):function(){n(t)};else if("undefined"!=typeof MessageChannel){var u=new MessageChannel;u.port1.onmessage=function(){s=d,u.port1.onmessage=t,t()};var d=function(){u.port2.postMessage(0)};s=function(){setTimeout(t,0),d()}}else s=function(){setTimeout(t,0)};return V.runAfter=function(t){c.push(t),a||(a=!0,s())},V}(),q=Function.call,z=t(Array.prototype.slice),Q=t(Array.prototype.reduce||function(t,e){var n=0,i=this.length;if(1===arguments.length)for(;;){if(n in this){e=this[n++];break}if(++n>=i)throw new TypeError}for(;n<i;n++)n in this&&(e=t(e,this[n],n));return e}),J=t(Array.prototype.indexOf||function(t){for(var e=0;e<this.length;e++)if(this[e]===t)return e;return-1}),K=t(Array.prototype.map||function(t,e){var n=this,i=[];return Q(n,function(r,o,a){i.push(t.call(e,o,a,n))},void 0),i}),Z=Object.create||function(t){function e(){}return e.prototype=t,new e},tt=t(Object.prototype.hasOwnProperty),et=Object.keys||function(t){var e=[];for(var n in t)tt(t,n)&&e.push(n);return e},nt=t(Object.prototype.toString);$="undefined"!=typeof ReturnValue?ReturnValue:function(t){this.value=t};var it="From previous event:";d.resolve=d,d.nextTick=V,d.longStackSupport=!1,"object"==typeof e&&e&&e.env&&e.env.Q_DEBUG&&(d.longStackSupport=!0),d.defer=f,f.prototype.makeNodeResolver=function(){var t=this;return function(e,n){e?t.reject(e):arguments.length>2?t.resolve(z(arguments,1)):t.resolve(n)}},d.Promise=p,d.promise=p,p.race=h,p.all=k,p.reject=L,p.resolve=d,d.passByCopy=function(t){return t},g.prototype.passByCopy=function(){return this},d.join=function(t,e){return d(t).join(e)},g.prototype.join=function(t){return d([this,t]).spread(function(t,e){if(t===e)return t;throw new Error("Can't join: not the same: "+t+" "+e)})},d.race=h,g.prototype.race=function(){return this.then(d.race)},d.makePromise=g,g.prototype.toString=function(){return"[object Promise]"},g.prototype.then=function(t,e,n){function i(e){try{return"function"==typeof t?t(e):e}catch(t){return L(t)}}function r(t){if("function"==typeof e){o(t,s);try{return e(t)}catch(t){return L(t)}}return L(t)}function a(t){return"function"==typeof n?n(t):t}var s=this,l=f(),c=!1;return d.nextTick(function(){s.promiseDispatch(function(t){c||(c=!0,l.resolve(i(t)))},"when",[function(t){c||(c=!0,l.resolve(r(t)))}])}),s.promiseDispatch(void 0,"when",[void 0,function(t){var e,n=!1;try{e=a(t)}catch(t){if(n=!0,!d.onerror)throw t;d.onerror(t)}n||l.notify(e)}]),l.promise},d.tap=function(t,e){return d(t).tap(e)},g.prototype.tap=function(t){return t=d(t),this.then(function(e){return t.fcall(e).thenResolve(e)})},d.when=v,g.prototype.thenResolve=function(t){return this.then(function(){return t})},d.thenResolve=function(t,e){return d(t).thenResolve(e)},g.prototype.thenReject=function(t){return this.then(function(){throw t})},d.thenReject=function(t,e){return d(t).thenReject(e)},d.nearer=m,d.isPromise=_,d.isPromiseAlike=b,d.isPending=y,g.prototype.isPending=function(){return"pending"===this.inspect().state},d.isFulfilled=E,g.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},d.isRejected=A,g.prototype.isRejected=function(){return"rejected"===this.inspect().state};var rt=[],ot=[],at=[],st=!0;d.resetUnhandledRejections=w,d.getUnhandledReasons=function(){return rt.slice()},d.stopUnhandledRejectionTracking=function(){w(),st=!1},w(),d.reject=L,d.fulfill=R,d.master=S,d.spread=x,g.prototype.spread=function(t,e){return this.all().then(function(e){return t.apply(void 0,e)},e)},d.async=O,d.spawn=U,d.return=D,d.promised=C,d.dispatch=N,g.prototype.dispatch=function(t,e){var n=this,i=f();return d.nextTick(function(){n.promiseDispatch(i.resolve,t,e)}),i.promise},d.get=function(t,e){return d(t).dispatch("get",[e])},g.prototype.get=function(t){return this.dispatch("get",[t])},d.set=function(t,e,n){return d(t).dispatch("set",[e,n])},g.prototype.set=function(t,e){return this.dispatch("set",[t,e])},d.del=d.delete=function(t,e){return d(t).dispatch("delete",[e])},g.prototype.del=g.prototype.delete=function(t){return this.dispatch("delete",[t])},d.mapply=d.post=function(t,e,n){return d(t).dispatch("post",[e,n])},g.prototype.mapply=g.prototype.post=function(t,e){return this.dispatch("post",[t,e])},d.send=d.mcall=d.invoke=function(t,e){return d(t).dispatch("post",[e,z(arguments,2)])},g.prototype.send=g.prototype.mcall=g.prototype.invoke=function(t){return this.dispatch("post",[t,z(arguments,1)])},d.fapply=function(t,e){return d(t).dispatch("apply",[void 0,e])},g.prototype.fapply=function(t){return this.dispatch("apply",[void 0,t])},d.try=d.fcall=function(t){return d(t).dispatch("apply",[void 0,z(arguments,1)])},g.prototype.fcall=function(){return this.dispatch("apply",[void 0,z(arguments)])},d.fbind=function(t){var e=d(t),n=z(arguments,1);return function(){return e.dispatch("apply",[this,n.concat(z(arguments))])}},g.prototype.fbind=function(){var t=this,e=z(arguments);return function(){return t.dispatch("apply",[this,e.concat(z(arguments))])}},d.keys=function(t){return d(t).dispatch("keys",[])},g.prototype.keys=function(){return this.dispatch("keys",[])},d.all=k,g.prototype.all=function(){return k(this)},d.any=j,g.prototype.any=function(){return j(this)},d.allResolved=function(t,e,n){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(e+" is deprecated, use "+n+" instead.",new Error("").stack),t.apply(t,arguments)}}(B,"allResolved","allSettled"),g.prototype.allResolved=function(){return B(this)},d.allSettled=M,g.prototype.allSettled=function(){return this.then(function(t){return k(K(t,function(t){function e(){return t.inspect()}return t=d(t),t.then(e,e)}))})},d.fail=d.catch=function(t,e){return d(t).then(void 0,e)},g.prototype.fail=g.prototype.catch=function(t){return this.then(void 0,t)},d.progress=H,g.prototype.progress=function(t){return this.then(void 0,void 0,t)},d.fin=d.finally=function(t,e){return d(t).finally(e)},g.prototype.fin=g.prototype.finally=function(t){return t=d(t),this.then(function(e){return t.fcall().then(function(){return e})},function(e){return t.fcall().then(function(){throw e})})},d.done=function(t,e,n,i){return d(t).done(e,n,i)},g.prototype.done=function(t,n,i){var r=function(t){d.nextTick(function(){if(o(t,a),!d.onerror)throw t;d.onerror(t)})},a=t||n||i?this.then(t,n,i):this;"object"==typeof e&&e&&e.domain&&(r=e.domain.bind(r)),a.then(void 0,r)},d.timeout=function(t,e,n){return d(t).timeout(e,n)},g.prototype.timeout=function(t,e){var n=f(),i=setTimeout(function(){e&&"string"!=typeof e||(e=new Error(e||"Timed out after "+t+" ms"),e.code="ETIMEDOUT"),n.reject(e)},t);return this.then(function(t){clearTimeout(i),n.resolve(t)},function(t){clearTimeout(i),n.reject(t)},n.notify),n.promise},d.delay=function(t,e){return void 0===e&&(e=t,t=void 0),d(t).delay(e)},g.prototype.delay=function(t){return this.then(function(e){var n=f();return setTimeout(function(){n.resolve(e)},t),n.promise})},d.nfapply=function(t,e){return d(t).nfapply(e)},g.prototype.nfapply=function(t){var e=f(),n=z(t);return n.push(e.makeNodeResolver()),this.fapply(n).fail(e.reject),e.promise},d.nfcall=function(t){var e=z(arguments,1);return d(t).nfapply(e)},g.prototype.nfcall=function(){var t=z(arguments),e=f();return t.push(e.makeNodeResolver()),this.fapply(t).fail(e.reject),e.promise},d.nfbind=d.denodeify=function(t){var e=z(arguments,1);return function(){var n=e.concat(z(arguments)),i=f();return n.push(i.makeNodeResolver()),d(t).fapply(n).fail(i.reject),i.promise}},g.prototype.nfbind=g.prototype.denodeify=function(){var t=z(arguments);return t.unshift(this),d.denodeify.apply(void 0,t)},d.nbind=function(t,e){var n=z(arguments,2);return function(){function i(){return t.apply(e,arguments)}var r=n.concat(z(arguments)),o=f();return r.push(o.makeNodeResolver()),d(i).fapply(r).fail(o.reject),o.promise}},g.prototype.nbind=function(){var t=z(arguments,0);return t.unshift(this),d.nbind.apply(void 0,t)},d.nmapply=d.npost=function(t,e,n){return d(t).npost(e,n)},g.prototype.nmapply=g.prototype.npost=function(t,e){var n=z(e||[]),i=f();return n.push(i.makeNodeResolver()),this.dispatch("post",[t,n]).fail(i.reject),i.promise},d.nsend=d.nmcall=d.ninvoke=function(t,e){var n=z(arguments,2),i=f();return n.push(i.makeNodeResolver()),d(t).dispatch("post",[e,n]).fail(i.reject),i.promise},g.prototype.nsend=g.prototype.nmcall=g.prototype.ninvoke=function(t){var e=z(arguments,1),n=f();return e.push(n.makeNodeResolver()),this.dispatch("post",[t,e]).fail(n.reject),n.promise},d.nodeify=F,g.prototype.nodeify=function(t){if(!t)return this;this.then(function(e){d.nextTick(function(){t(null,e)})},function(e){d.nextTick(function(){t(e)})})},d.noConflict=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var lt=u();return d})}).call(e,n(14),n(20).setImmediate)},,function(t,e,n){var i=n(3),r=n(1),o=n(4),a=n(5).sprintf,s=n(2),l=n(0),c=n(72);t.exports=i(c,{insertAngularDirectives:function(){if(0==this.getArticleHolders().length)return!1;var t=o("body");return t.attr({"ng-controller":"List as list"}),t.append(n(30)),this.insertButtons(),!0},bootstrapAngular:function(){s.bootstrap(o("body").get(0),["App"],{strictDi:!0})},get:function(){return r.map(this.getArticleHolders(),function(t){var e=o(t);return r.extend(this.getIdentifiers(e),{metadata:this.getMetadata(e)})}.bind(this))},getPlain:function(){return r.map(this.getArticleHolders(),function(t){return this.getIdentifiers(o(t))}.bind(this))},getIdentifiers:function(t){return{doi:null,pmid:null,gsid:null}},getMetadata:function(t){return{title:null,journal:null,year:null,authors:[]}},getArticleHolders:function(){return[]},isAbstractPage:function(){return!0},getButtonHolder:function(t){return t},insertButtons:function(){var t=n(59);r.each(this.getArticleHolders(),function(e,n){var i=a(t,n);this.getButtonHolder(o(e)).append(i)}.bind(this))},getAngularInjector:function(t,e){return e||(e=["$q","$http"]),e.push(t),s.injector(["ng"]).invoke(e)},getExecutePromise:function(){return this.getAngularInjector(function(t){return t.resolve("The angular app can be inserted")},["$q"])},getDoiFromElement:function(t){return t&&0!=t.length?r.get(t.text().match(l.REGEXP_DOI),"[0]",null):null}})},function(t,e){t.exports={100:"Continue",101:"Switching Protocols",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Time-out",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Large",415:"Unsupported Media Type",416:"Requested Range not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",429:"Too Many Requests",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Time-out",505:"HTTP Version not Supported",507:"Insufficient Storage",CONTINUE:100,SWITCHING_PROTOCOLS:101,OK:200,CREATED:201,ACCEPTED:202,NON_AUTHORITATIVE_INFORMATION:203,NO_CONTENT:204,RESET_CONTENT:205,PARTIAL_CONTENT:206,MULTIPLE_CHOICES:300,MOVED_PERMANENTLY:301,FOUND:302,SEE_OTHER:303,NOT_MODIFIED:304,USE_PROXY:305,TEMPORARY_REDIRECT:307,BAD_REQUEST:400,UNAUTHORIZED:401,PAYMENT_REQUIRED:402,FORBIDDEN:403,NOT_FOUND:404,METHOD_NOT_ALLOWED:405,NOT_ACCEPTABLE:406,PROXY_AUTHENTICATION_REQUIRED:407,REQUEST_TIMEOUT:408,CONFLICT:409,GONE:410,LENGTH_REQUIRED:411,PRECONDITION_FAILED:412,REQUEST_ENTITY_TOO_LARGE:413,REQUEST_URI_TOO_LONG:414,UNSUPPORTED_MEDIA_TYPE:415,REQUESTED_RANGE_NOT_SATISFIABLE:416,EXPECTATION_FAILED:417,UNPROCESSABLE_ENTITY:422,LOCKED:423,FAILED_DEPENDENCY:424,TOO_MANY_REQUESTS:429,UNAVAILABLE_FOR_LEGAL_REASONS:451,INTERNAL_SERVER_ERROR:500,NOT_IMPLEMENTED:501,BAD_GATEWAY:502,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,HTTP_VERSION_NOT_SUPPORTED:505,INSUFFICIENT_STORAGE:507}},function(t,e,n){var i=n(1),r=n(0),o=n(78);t.exports={splitAuthorString:function(t){return i.chain(t.split(/,\s|\sand\s/)).map(function(t){return i.trim(t)}).filter(function(t){return t}).value()},getAuthorsArray:function(t){return i.chain(t).thru(function(t){return t&&0!=t.length?t.split(","):[]}).map(function(t){return i.trim(t)}).value()},refmanToMetadata:function(t){function e(t){var e=i.find(n,function(e){return e[0]==t});return e?e[1]:""}var n=t.split("\r\n").filter(function(t){return t}).reduce(function(t,e){var n=e.split("  - ");return t.push(n),t},[]),a=i.flow([o.default,o.fullnameForAuthor]),s=n.reduce(function(t,e){return"A1"==e[0]&&t.push(a(e[1])),t},[]),l=i.get(e("Y1").match(r.REGEXP_YEAR),"0","");return{title:e("T1"),journal:e("JO"),year:l,authors:s,volume:e("VL")}}}},function(t,e,n){var i=n(1),r=n(9),o=n(0),a={getPdfFilenameFromUrl:function(t){return"string"!=typeof t||0===t.length?"":i.chain(r.parse(t)).get("pathname","").thru(function(t){return t.split("/")}).last().thru(function(t){var e=decodeURIComponent(t).toLowerCase();return i.endsWith(e,".pdf")?e:""}).value()},isReadcubeUrl:function(t){return-1!==t.indexOf(o.DOMAIN_READCUBE)},isUrlAbsolute:function(t){return t.indexOf("://")>0||0===t.indexOf("//")},isProtocol:function(t,e){return"string"==typeof t&&0!=t.length&&i.chain(r.parse(t)).get("protocol","").thru(function(t){return-1!==e.indexOf(t)}).value()},getHostnameFromUrl:function(t){return"string"!=typeof t||0===t.length?"":r.parse(t).hostname},getUrlWithoutQuery:function(t){return"string"!=typeof t||0===t.length?"":r.format(i.extend(r.parse(t),{hash:null,query:null,search:null}))},publisherWebsiteRegExps:i.reduce(o,function(t,e,n){return n.indexOf("URL_REGEXP_PUBLISHER")>-1?t.concat(e):t},[]),isPublisherWebsite:function(t){if("string"!=typeof t||0===t.length)return!1;var e=a.getUrlWithoutQuery(t);return a.publisherWebsiteRegExps.some(function(t){return"string"==typeof t?-1!==t.indexOf(e):t.test(e)})},isRsc:function(t){if("string"!=typeof t||0===t.length)return!1;var e=a.getUrlWithoutQuery(t);return o.URL_REGEXP_PUBLISHER_RSC.test(e)},isGoogleScholar:function(t){if("string"!=typeof t||0===t.length)return!1;var e=a.getUrlWithoutQuery(t);return o.URL_REGEXP_SOURCE_GOOGLE_SCHOLAR.test(e)},isPubmed:function(t){if("string"!=typeof t||0===t.length)return!1;var e=a.getUrlWithoutQuery(t);return o.URL_REGEXP_SOURCE_PUBMED.test(e)},isReadcubeWebLibrary:function(t){if("string"!=typeof t||0===t.length)return!1;var e=a.getUrlWithoutQuery(t);return o.URL_REGEXP_WEB_LIBRARY_URL.test(e)}};t.exports=a},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function r(t){if(u===setTimeout)return setTimeout(t,0);if((u===n||!u)&&setTimeout)return u=setTimeout,setTimeout(t,0);try{return u(t,0)}catch(e){try{return u.call(null,t,0)}catch(e){return u.call(this,t,0)}}}function o(t){if(d===clearTimeout)return clearTimeout(t);if((d===i||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(t);try{return d(t)}catch(e){try{return d.call(null,t)}catch(e){return d.call(this,t)}}}function a(){g&&p&&(g=!1,p.length?h=p.concat(h):v=-1,h.length&&s())}function s(){if(!g){var t=r(a);g=!0;for(var e=h.length;e;){for(p=h,h=[];++v<e;)p&&p[v].run();v=-1,e=h.length}p=null,g=!1,o(t)}}function l(t,e){this.fun=t,this.array=e}function c(){}var u,d,f=t.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:n}catch(t){u=n}try{d="function"==typeof clearTimeout?clearTimeout:i}catch(t){d=i}}();var p,h=[],g=!1,v=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];h.push(new l(t,e)),1!==h.length||g||r(s)},l.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=c,f.addListener=c,f.once=c,f.off=c,f.removeListener=c,f.removeAllListeners=c,f.emit=c,f.prependListener=c,f.prependOnceListener=c,f.listeners=function(t){return[]},f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(t,e,n){var i=n(3),r=n(1),o=n(0);n(9);t.exports=i({__constructor:function(t){this.id=null,this.pmid=null,this.doi=null,this.gsid=null,this.inLibraryStatus=o.STATUS_NOT_FOUND,this.isReadyForShowing=!1,this.metadata={},this.pdfUrl=null,this.usingPdfUrl=null,this.url=null,this.pdfHash=null,this.hasPdf=!1,this.note="",this.progressPercent=0,this.progressType=o.PROGRESS_DOWNLOAD,r.isObject(t)&&this.extend(t)},extend:function(t){return r.extend(this,t),this},getIdentifiers:function(){return r.pick(this,["doi","pmid","gsid"])},setInLibraryStatus:function(t,e){return t==o.STATUS_IN_LIBRARY?e?this.hasPdf?this.inLibraryStatus=o.STATUS_IN_LIBRARY_WITH_PDF:this.inLibraryStatus=o.STATUS_IN_LIBRARY_WITHOUT_PDF:this.inLibraryStatus=this.hasPdf?o.STATUS_IN_LIBRARY_WITH_PDF:o.STATUS_IN_LIBRARY:this.inLibraryStatus=o.STATUS_NOT_FOUND,this},isProcessingStatus:function(){return this.inLibraryStatus==o.STATUS_METADATA_ADDING||this.inLibraryStatus==o.STATUS_PDF_DOWNLOADING},finishProcessingStatus:function(t){this.hasPdf?this.inLibraryStatus=o.STATUS_IN_LIBRARY_WITH_PDF:this.inLibraryStatus==o.STATUS_METADATA_ADDING?this.inLibraryStatus=o.STATUS_NOT_FOUND:this.inLibraryStatus==o.STATUS_PDF_DOWNLOADING&&(this.inLibraryStatus=t?o.STATUS_IN_LIBRARY_WITHOUT_PDF_WARNING_PROXY:o.STATUS_IN_LIBRARY_WITHOUT_PDF_WARNING)},isInLibrary:function(){var t=!1;switch(this.inLibraryStatus){case o.STATUS_IN_LIBRARY:case o.STATUS_IN_LIBRARY_WITH_PDF:case o.STATUS_IN_LIBRARY_WITHOUT_PDF:case o.STATUS_IN_LIBRARY_WITHOUT_PDF_WARNING:case o.STATUS_IN_LIBRARY_WITHOUT_PDF_WARNING_PROXY:t=!0}return t},isPdfDownloadFailed:function(){var t=!1;switch(this.inLibraryStatus){case o.STATUS_IN_LIBRARY_WITHOUT_PDF_WARNING:case o.STATUS_IN_LIBRARY_WITHOUT_PDF_WARNING_PROXY:t=!0}return t},toJsonForAPI:function(t){var e={ext_ids:this.getIdentifiers(),note:null,return_item:!0};return e.ext_ids.gsid&&e.ext_ids.gsid.indexOf("null")>-1&&(e.ext_ids.gsid=null),r.get(t,"includeMetadata",!1)&&(e.article=this.metadata),r.get(t,"includeNote",!1)&&(e.note=this.note,e.user_data={notes:this.note}),e},toJson:function(){var t={};for(var e in this)"function"!=typeof this[e]&&(t[e]=this[e]);return t},getPdfUrl:function(){return this.pdfUrl?this.pdfUrl:null}})},,function(t,e,n){"use strict";var i=function(){function t(t,e){this.location=t,this.length=e}return t.prototype.notFound=function(){return void 0==this.location||null==this.location},t.prototype.maxRange=function(){return this.location+this.length},t.prototype.sliceArray=function(t){return t.slice(this.location,this.location+this.length)},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e,n){"use strict";function i(t){var e=t.toLowerCase(),n="."==e[e.length-1]?e.substring(0,e.length-1):e;return d[n]}function r(t){return t.trim().toLowerCase()}function o(t){return["firstName","middle","dropped","nondropped","lastName","suffix"].reduce(function(e,n){var i=t[n];return i?e?e+" "+i:i:e},"")}function a(t){for(var e,n,i=0,r=t;i<r.length;i++){var o=r[i];e?n=n?n+" "+o:o:e=o}return[e,n]}function s(t,e){void 0===e&&(e=!1);var n=t.length;if(0==n)return new c.default;for(var i=new c.default,r=0,o=0,a=t;o<a.length;o++){var s=a[o];if((s.length>2||s.toUpperCase()!=s)&&(s=s.toLowerCase()),u.default[s]){i=new c.default(r,1);break}if(e)break;r++}if(n<2)return i;if(i.notFound())return i;if(void 0==i.location)return i;var l=n-1;for(e&&(l=1),r=i.location;r<l;r++){var d=t[r].toLowerCase(),f=t[r+1].toLowerCase(),p=[d,f],h=p.join(" ");if(u.default[h])return new c.default(r,2)}return i}function l(t){var e=t.join(" "),n=u.default[e.toLowerCase()],i=n[0],o=n[1],a=r(e).length<2,s=a||e.toUpperCase()!=e,l=r(i+" "+o),d=r(e)==l;if(s&&d){for(var f=0,p=0,h=t.length,g=function(t,e,n){var i=t-e+1;return new c.default(e,i).sliceArray(n).join(" ")},v="",m=i.toLowerCase();p<h&&v.toLowerCase()!=m;)v=g(p,f,t),p++;f=p;for(var _="",b=o.toLowerCase();p<h&&_.toLowerCase()!=b;)_=g(p,f,t),p++;i=v,o=_}return[i,o]}var c=n(17),u=n(79),d={jr:"Jr",sr:"Sr",ii:"II",iii:"III",iv:"IV",v:"V"};e.tryGetSuffix=i,e.canonicalString=r,e.fullnameForAuthor=o,e.firstAndMiddleFromTokens=a,e.particlesRangeInTokens=s,e.splitParticleParts=l},function(t,e,n){(function(t,e){!function(t,n){"use strict";function i(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:t,args:e};return c[l]=i,s(l),l++}function r(t){delete c[t]}function o(t){var e=t.callback,i=t.args;switch(i.length){case 0:e();break;case 1:e(i[0]);break;case 2:e(i[0],i[1]);break;case 3:e(i[0],i[1],i[2]);break;default:e.apply(n,i)}}function a(t){if(u)setTimeout(a,0,t);else{var e=c[t];if(e){u=!0;try{o(e)}finally{r(t),u=!1}}}}if(!t.setImmediate){var s,l=1,c={},u=!1,d=t.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(t);f=f&&f.setTimeout?f:t,"[object process]"==={}.toString.call(t.process)?function(){s=function(t){e.nextTick(function(){a(t)})}}():function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?function(){var e="setImmediate$"+Math.random()+"$",n=function(n){n.source===t&&"string"==typeof n.data&&0===n.data.indexOf(e)&&a(+n.data.slice(e.length))};t.addEventListener?t.addEventListener("message",n,!1):t.attachEvent("onmessage",n),s=function(n){t.postMessage(e+n,"*")}}():t.MessageChannel?function(){var t=new MessageChannel;t.port1.onmessage=function(t){a(t.data)},s=function(e){t.port2.postMessage(e)}}():d&&"onreadystatechange"in d.createElement("script")?function(){var t=d.documentElement;s=function(e){var n=d.createElement("script");n.onreadystatechange=function(){a(e),n.onreadystatechange=null,t.removeChild(n),n=null},t.appendChild(n)}}():function(){s=function(t){setTimeout(a,0,t)}}(),f.setImmediate=i,f.clearImmediate=r}}("undefined"==typeof self?void 0===t?this:t:self)}).call(e,n(16),n(14))},function(t,e,n){function i(t,e){this._id=t,this._clearFn=e}var r=Function.prototype.apply;e.setTimeout=function(){return new i(r.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new i(r.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(19),e.setImmediate=setImmediate,e.clearImmediate=clearImmediate},function(t,e,n){var i=n(2),r=n(0);i.module("App").run(["Mixpanel",function(t){var e=chrome.runtime.getManifest().version;t.setProperty(r.MIXPANEL_PROPERTY_BROWSER_EXTENSION_VERSION,e);var n={};n[r.MIXPANEL_SUPER_PROPERTY_CLIENT]="Browser Ext",n[r.MIXPANEL_SUPER_PROPERTY_BROWSER_EXTENSION_VERSION]=e,t.setSuperProperty(n),t.union(r.MIXPANEL_PROPERTY_CLIENTS_USED,"browser_ext")}])},function(t,e,n){function i(t,e){var n=!1;o.init(a.MIXPANEL_TOKEN,{api_host:a.MIXPANEL_API_URL});var i={get:function(){return n?t.resolve(o):(n=!0,e.evaluateLoggedInUserDetail().then(function(e){return e.id?(o.identify(e.id),o):t.reject("Unable to get user id")}).catch(function(e){return console.error(e),t.reject(e)}))},getObjectFromParams:function(t,e){var n={};return"string"==typeof t?n[t]=e:n=t,n},setProperty:function(t,e){return i.get().then(function(n){return n.people.set(i.getObjectFromParams(t,e)),!0})},setSuperProperty:function(t,e){return i.get().then(function(n){return n.register(i.getObjectFromParams(t,e)),!0})},incrementProperty:function(t,e){return i.get().then(function(n){return n.people.increment(i.getObjectFromParams(t,e)),!0})},trackEvent:function(t,e){return i.get().then(function(n){return n.track(t,e),!0})},union:function(t,e){return i.get().then(function(n){return n.people.union(t,e),!0})}};return i}i.$inject=["$q","User"];var r=n(2),o=n(47),a=n(0);r.module("App").factory("Mixpanel",i)},function(t,e,n){function i(t){return{sendToBackground:function(e,n){var i=t.defer();return chrome.runtime.sendMessage({method:e,data:n},function(t){i.resolve(t)}),i.promise},listenForMessages:function(t){function e(e,n,i){return t(e,i),!0}chrome.runtime.onMessage.addListener(e),window.onbeforeunload=function(){chrome.runtime.onMessage.hasListener(e)&&chrome.runtime.onMessage.removeListener(e)}},sendToActiveTab:function(e){var n=t.defer();return chrome.tabs.query({active:!0,currentWindow:!0},function(t){if(0==t.length)return void n.reject("No active tabs were found");chrome.tabs.sendMessage(t[0].id,e,n.resolve)}),n.promise}}}i.$inject=["$q"],n(2).module("App").factory("Message",i)},function(t,e,n){function i(t,e,n){var i={INITIAL:0,PROCESSING:1,DONE:2},r=i.INITIAL,c=[],u={getLoggedInUserDetails:function(){return e.get(o.STORAGE_KEY_LOGGED_IN_USER_DETAILS,null).then(function(t){return a.get(t,"id")?t:n.reject("User data not available in the storage")})},evaluateLoggedInUserDetail:function(){var t=this,e=n.defer();if(r===i.INITIAL)r=i.PROCESSING,c.push(e),t.queryUserDetails().then(function(t){u.setLoggedInUserDetails(t),r=i.DONE,c.forEach(function(e){e.resolve(t)})}).catch(function(e){t.clearLoggedInUserDetails(),r=i.INITIAL,c.forEach(function(t){t.reject(e)})}).finally(function(){c=[]});else{if(r!==i.PROCESSING)return u.getLoggedInUserDetails();c.push(e)}return e.promise},clearProcessingStatus:function(){r=i.INITIAL},getInstitutionProxy:function(){return this.evaluateLoggedInUserDetail().then(function(t){switch(a.get(t,"proxy_url_selection",null)){case o.VALUE_PROXY_URL_SELECTION_NONE:case o.VALUE_PROXY_URL_SELECTION_NULL:return n.reject('Proxy url selection is "none" or "null"');case o.VALUE_PROXY_URL_SELECTION_MANUAL:var e=a.get(t,"proxy_url",null);return e||n.reject("Proxy url is not available");case o.VALUE_PROXY_URL_SELECTION_INSTITUTION:var i=a.get(t,"institution_proxy_url",null);return i||n.reject("Institution proxy url is not available");default:return n.reject("Unknown proxy selection option")}})},getSfxUrlByDoiAndPmid:function(t,e){return this.evaluateLoggedInUserDetail().then(function(i){var r=a.get(i,"sfx_url",null);if(!r)return n.reject("Sfx url is not available");var o=l.parse(r,!0);return t&&(o.query.__DOI__="doi:"+t),e&&(o.query.__PMID__="pmid:"+e),l.format(o).replace("__DOI__","id").replace("__PMID__","id")})},getSubscriptionStatus:function(){return this.querySubscriptionStatus().then(function(t){return"free"===t.account?"expired"===t.status?"trial"===t.previous_type?o.SUBSCRIPTION_TRIAL_EXPIRED:o.SUBSCRIPTION_PRO_EXPIRED:o.SUBSCRIPTION_FREE:o.SUBSCRIPTION_PRO}).catch(function(){return o.SUBSCRIPTION_FREE})},setLoggedInUserDetails:function(t){e.set(o.STORAGE_KEY_LOGGED_IN_USER_DETAILS,t)},clearLoggedInUserDetails:function(){e.set(o.STORAGE_KEY_LOGGED_IN_USER_DETAILS,null),e.set(o.STORAGE_KEY_DISPLAYED_GO_PRO_TOOLTIP,!1)},queryUserDetails:function(){return s.get(o.URL_USER_DETAILS).then(function(t){var e=a.get(t,"data",null);return e?{email:e.email,name:e.full_name,id:e.id,institution:e.institution,institution_proxy_url:e.institution_proxy_url,proxy_url:e.proxy_url,proxy_url_selection:e.proxy_url_selection,sfx_url:e.sfx_url}:n.reject("Unable to get user details")})},querySubscriptionStatus:function(){return s.get(o.URL_SUBSCRIPTION_STATUS).then(function(t){var e=a.get(t,"data",null);return e||n.reject("Unable to load subscription details")})},logout:function(){return s.get(o.URL_LOGOUT,!0)}};return u}i.$inject=["$http","Storage","$q"];var r=n(2),o=n(0),a=n(1),s=n(7),l=n(9);r.module("App").factory("User",i)},function(t,e){function n(t){for(var e=atob(t.split(",")[1]),n=new ArrayBuffer(e.length),i=new Uint8Array(n),r=0;r<e.length;r++)i[r]=e.charCodeAt(r);return n}e.toArrayBuffer=n,e.toBlob=function(t){return new Blob([n(t)])}},function(t,e,n){var i=chrome.storage.local,r=n(8);t.exports={get:function(t,e){void 0===e&&(e=null);var n=r.defer();return i.get(t,function(i){"string"==typeof t&&null==i[t]?n.resolve(e):"object"==typeof t&&null==i?n.resolve(e):"string"==typeof t?n.resolve(i[t]):n.resolve(i)}),n.promise},set:function(t,e){var n={},o=r.defer();if("string"==typeof t)n[t]=e;else{if("object"!=typeof t)return!1;n=t}return i.set(n,o.resolve),o.promise}}},function(t,e,n){"use strict";function i(t){for(var e="",n=0;n<r.default.length;n++){var i=r.default[n],o=t[i];o&&(e=e+"["+(n+1)+"] "+o+" ")}return e}var r=n(75);Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e,n){"use strict";function i(t){return t.split(/{(.+)}|\s/).filter(function(t){return t})}Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e){t.exports='<div class="tether-content">\n  <div class="readcube-tooltip {{ viewClass }}">\n    <div class="readcube-tooltip-icons">\n      <span ng-if="viewRetry == \'yes\'" title="Retry" class="readcube-icon-close"\n            ng-click="onRetryClick($event)">&#8634;</span>\n      <span ng-if="viewClose == \'yes\'" title="Close tooltip" class="readcube-icon-close"\n            ng-click="onCloseTooltipClick($event)">×</span>\n    </div>\n\n    <div ng-include="viewUrl" ng-if="viewUrl" ng-controller="PdfWarning"></div>\n    <div class="readcube-tooltip-title" ng-if="viewText">{{ viewText }}</div>\n  </div>\n</div>'},function(t,e){t.exports='<div list-dropdown id="readcube-injected-button-dropdown" on-add-to-library-click="list.onAddToLibraryClick(index)" is-below-button="true" should-display-add-button="true"></div>\n<div login-iframe when-successfully-logged-in="list.onSuccessfullyLoggedIn(userData)" show="list.loginIframe.show"></div>\n'},function(t,e,n){var i,r;/*! tether 1.4.0 */
!function(o,a){i=a,void 0!==(r="function"==typeof i?i.call(e,n,e,t):i)&&(t.exports=r)}(0,function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t){var e=t.getBoundingClientRect(),n={};for(var i in e)n[i]=e[i];if(t.ownerDocument!==document){var o=t.ownerDocument.defaultView.frameElement;if(o){var a=r(o);n.top+=a.top,n.bottom+=a.top,n.left+=a.left,n.right+=a.left}}return n}function o(t){var e=getComputedStyle(t)||{},n=e.position,i=[];if("fixed"===n)return[t];for(var r=t;(r=r.parentNode)&&r&&1===r.nodeType;){var o=void 0;try{o=getComputedStyle(r)}catch(t){}if(void 0===o||null===o)return i.push(r),i;var a=o,s=a.overflow,l=a.overflowX;/(auto|scroll)/.test(s+a.overflowY+l)&&("absolute"!==n||["relative","absolute","fixed"].indexOf(o.position)>=0)&&i.push(r)}return i.push(t.ownerDocument.body),t.ownerDocument!==document&&i.push(t.ownerDocument.defaultView),i}function a(){T&&document.body.removeChild(T),T=null}function s(t){var e=void 0;t===document?(e=document,t=document.documentElement):e=t.ownerDocument;var n=e.documentElement,i=r(t),o=P();return i.top-=o.top,i.left-=o.left,void 0===i.width&&(i.width=document.body.scrollWidth-i.left-i.right),void 0===i.height&&(i.height=document.body.scrollHeight-i.top-i.bottom),i.top=i.top-n.clientTop,i.left=i.left-n.clientLeft,i.right=e.body.clientWidth-i.width-i.left,i.bottom=e.body.clientHeight-i.height-i.top,i}function l(t){return t.offsetParent||document.documentElement}function c(){if(S)return S;var t=document.createElement("div");t.style.width="100%",t.style.height="200px";var e=document.createElement("div");u(e.style,{position:"absolute",top:0,left:0,pointerEvents:"none",visibility:"hidden",width:"200px",height:"150px",overflow:"hidden"}),e.appendChild(t),document.body.appendChild(e);var n=t.offsetWidth;e.style.overflow="scroll";var i=t.offsetWidth;n===i&&(i=e.clientWidth),document.body.removeChild(e);var r=n-i;return S={width:r,height:r}}function u(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=[];return Array.prototype.push.apply(e,arguments),e.slice(1).forEach(function(e){if(e)for(var n in e)({}).hasOwnProperty.call(e,n)&&(t[n]=e[n])}),t}function d(t,e){if(void 0!==t.classList)e.split(" ").forEach(function(e){e.trim()&&t.classList.remove(e)});else{var n=new RegExp("(^| )"+e.split(" ").join("|")+"( |$)","gi"),i=h(t).replace(n," ");g(t,i)}}function f(t,e){if(void 0!==t.classList)e.split(" ").forEach(function(e){e.trim()&&t.classList.add(e)});else{d(t,e);var n=h(t)+" "+e;g(t,n)}}function p(t,e){if(void 0!==t.classList)return t.classList.contains(e);var n=h(t);return new RegExp("(^| )"+e+"( |$)","gi").test(n)}function h(t){return t.className instanceof t.ownerDocument.defaultView.SVGAnimatedString?t.className.baseVal:t.className}function g(t,e){t.setAttribute("class",e)}function v(t,e,n){n.forEach(function(n){-1===e.indexOf(n)&&p(t,n)&&d(t,n)}),e.forEach(function(e){p(t,e)||f(t,e)})}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _(t,e){var n=arguments.length<=2||void 0===arguments[2]?1:arguments[2];return t+n>=e&&e>=t-n}function b(){return"undefined"!=typeof performance&&void 0!==performance.now?performance.now():+new Date}function y(){for(var t={top:0,left:0},e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];return n.forEach(function(e){var n=e.top,i=e.left;"string"==typeof n&&(n=parseFloat(n,10)),"string"==typeof i&&(i=parseFloat(i,10)),t.top+=n,t.left+=i}),t}function E(t,e){return"string"==typeof t.left&&-1!==t.left.indexOf("%")&&(t.left=parseFloat(t.left,10)/100*e.width),"string"==typeof t.top&&-1!==t.top.indexOf("%")&&(t.top=parseFloat(t.top,10)/100*e.height),t}function A(t,e){return"scrollParent"===e?e=t.scrollParents[0]:"window"===e&&(e=[pageXOffset,pageYOffset,innerWidth+pageXOffset,innerHeight+pageYOffset]),e===document&&(e=e.documentElement),void 0!==e.nodeType&&function(){var t=e,n=s(e),i=n,r=getComputedStyle(e);if(e=[i.left,i.top,n.width+i.left,n.height+i.top],t.ownerDocument!==document){var o=t.ownerDocument.defaultView;e[0]+=o.pageXOffset,e[1]+=o.pageYOffset,e[2]+=o.pageXOffset,e[3]+=o.pageYOffset}z.forEach(function(t,n){t=t[0].toUpperCase()+t.substr(1),"Top"===t||"Left"===t?e[n]+=parseFloat(r["border"+t+"Width"]):e[n]-=parseFloat(r["border"+t+"Width"])})}(),e}var w=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),I=void 0;void 0===I&&(I={modules:[]});var T=null,L=function(){var t=0;return function(){return++t}}(),R={},P=function(){var t=T;t&&document.body.contains(t)||(t=document.createElement("div"),t.setAttribute("data-tether-id",L()),u(t.style,{top:0,left:0,position:"absolute"}),document.body.appendChild(t),T=t);var e=t.getAttribute("data-tether-id");return void 0===R[e]&&(R[e]=r(t),O(function(){delete R[e]})),R[e]},S=null,x=[],O=function(t){x.push(t)},U=function(){for(var t=void 0;t=x.pop();)t()},D=function(){function t(){i(this,t)}return w(t,[{key:"on",value:function(t,e,n){var i=!(arguments.length<=3||void 0===arguments[3])&&arguments[3];void 0===this.bindings&&(this.bindings={}),void 0===this.bindings[t]&&(this.bindings[t]=[]),this.bindings[t].push({handler:e,ctx:n,once:i})}},{key:"once",value:function(t,e,n){this.on(t,e,n,!0)}},{key:"off",value:function(t,e){if(void 0!==this.bindings&&void 0!==this.bindings[t])if(void 0===e)delete this.bindings[t];else for(var n=0;n<this.bindings[t].length;)this.bindings[t][n].handler===e?this.bindings[t].splice(n,1):++n}},{key:"trigger",value:function(t){if(void 0!==this.bindings&&this.bindings[t]){for(var e=0,n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];for(;e<this.bindings[t].length;){var o=this.bindings[t][e],a=o.handler,s=o.ctx,l=o.once,c=s;void 0===c&&(c=this),a.apply(c,i),l?this.bindings[t].splice(e,1):++e}}}}]),t}();I.Utils={getActualBoundingClientRect:r,getScrollParents:o,getBounds:s,getOffsetParent:l,extend:u,addClass:f,removeClass:d,hasClass:p,updateClasses:v,defer:O,flush:U,uniqueId:L,Evented:D,getScrollBarSize:c,removeUtilElements:a};var C=function(){function t(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),w=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),N=function(t,e,n){for(var i=!0;i;){var r=t,o=e,a=n;i=!1,null===r&&(r=Function.prototype);var s=Object.getOwnPropertyDescriptor(r,o);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var c=Object.getPrototypeOf(r);if(null===c)return;t=c,e=o,n=a,i=!0,s=c=void 0}};if(void 0===I)throw new Error("You must include the utils.js file before tether.js");var k=I.Utils,o=k.getScrollParents,s=k.getBounds,l=k.getOffsetParent,u=k.extend,f=k.addClass,d=k.removeClass,v=k.updateClasses,O=k.defer,U=k.flush,c=k.getScrollBarSize,a=k.removeUtilElements,j=function(){if("undefined"==typeof document)return"";for(var t=document.createElement("div"),e=["transform","WebkitTransform","OTransform","MozTransform","msTransform"],n=0;n<e.length;++n){var i=e[n];if(void 0!==t.style[i])return i}}(),B=[],M=function(){B.forEach(function(t){t.position(!1)}),U()};!function(){var t=null,e=null,n=null,i=function i(){if(void 0!==e&&e>16)return e=Math.min(e-16,250),void(n=setTimeout(i,250));void 0!==t&&b()-t<10||(null!=n&&(clearTimeout(n),n=null),t=b(),M(),e=b()-t)};"undefined"!=typeof window&&void 0!==window.addEventListener&&["resize","scroll","touchmove"].forEach(function(t){window.addEventListener(t,i)})}();var H={center:"center",left:"right",right:"left"},F={middle:"middle",top:"bottom",bottom:"top"},G={top:0,left:0,middle:"50%",center:"50%",bottom:"100%",right:"100%"},X=function(t,e){var n=t.left,i=t.top;return"auto"===n&&(n=H[e.left]),"auto"===i&&(i=F[e.top]),{left:n,top:i}},$=function(t){var e=t.left,n=t.top;return void 0!==G[t.left]&&(e=G[t.left]),void 0!==G[t.top]&&(n=G[t.top]),{left:e,top:n}},W=function(t){var e=t.split(" "),n=C(e,2);return{top:n[0],left:n[1]}},Y=W,V=function(t){function e(t){var n=this;i(this,e),N(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.position=this.position.bind(this),B.push(this),this.history=[],this.setOptions(t,!1),I.modules.forEach(function(t){void 0!==t.initialize&&t.initialize.call(n)}),this.position()}return m(e,t),w(e,[{key:"getClass",value:function(){var t=arguments.length<=0||void 0===arguments[0]?"":arguments[0],e=this.options.classes;return void 0!==e&&e[t]?this.options.classes[t]:this.options.classPrefix?this.options.classPrefix+"-"+t:t}},{key:"setOptions",value:function(t){var e=this,n=arguments.length<=1||void 0===arguments[1]||arguments[1],i={offset:"0 0",targetOffset:"0 0",targetAttachment:"auto auto",classPrefix:"tether"};this.options=u(i,t);var r=this.options,a=r.element,s=r.target,l=r.targetModifier;if(this.element=a,this.target=s,this.targetModifier=l,"viewport"===this.target?(this.target=document.body,this.targetModifier="visible"):"scroll-handle"===this.target&&(this.target=document.body,this.targetModifier="scroll-handle"),["element","target"].forEach(function(t){if(void 0===e[t])throw new Error("Tether Error: Both element and target must be defined");void 0!==e[t].jquery?e[t]=e[t][0]:"string"==typeof e[t]&&(e[t]=document.querySelector(e[t]))}),f(this.element,this.getClass("element")),!1!==this.options.addTargetClasses&&f(this.target,this.getClass("target")),!this.options.attachment)throw new Error("Tether Error: You must provide an attachment");this.targetAttachment=Y(this.options.targetAttachment),this.attachment=Y(this.options.attachment),this.offset=W(this.options.offset),this.targetOffset=W(this.options.targetOffset),void 0!==this.scrollParents&&this.disable(),"scroll-handle"===this.targetModifier?this.scrollParents=[this.target]:this.scrollParents=o(this.target),!1!==this.options.enabled&&this.enable(n)}},{key:"getTargetBounds",value:function(){if(void 0===this.targetModifier)return s(this.target);if("visible"===this.targetModifier){if(this.target===document.body)return{top:pageYOffset,left:pageXOffset,height:innerHeight,width:innerWidth};var t=s(this.target),e={height:t.height,width:t.width,top:t.top,left:t.left};return e.height=Math.min(e.height,t.height-(pageYOffset-t.top)),e.height=Math.min(e.height,t.height-(t.top+t.height-(pageYOffset+innerHeight))),e.height=Math.min(innerHeight,e.height),e.height-=2,e.width=Math.min(e.width,t.width-(pageXOffset-t.left)),e.width=Math.min(e.width,t.width-(t.left+t.width-(pageXOffset+innerWidth))),e.width=Math.min(innerWidth,e.width),e.width-=2,e.top<pageYOffset&&(e.top=pageYOffset),e.left<pageXOffset&&(e.left=pageXOffset),e}if("scroll-handle"===this.targetModifier){var t=void 0,n=this.target;n===document.body?(n=document.documentElement,t={left:pageXOffset,top:pageYOffset,height:innerHeight,width:innerWidth}):t=s(n);var i=getComputedStyle(n),r=n.scrollWidth>n.clientWidth||[i.overflow,i.overflowX].indexOf("scroll")>=0||this.target!==document.body,o=0;r&&(o=15);var a=t.height-parseFloat(i.borderTopWidth)-parseFloat(i.borderBottomWidth)-o,e={width:15,height:.975*a*(a/n.scrollHeight),left:t.left+t.width-parseFloat(i.borderLeftWidth)-15},l=0;a<408&&this.target===document.body&&(l=-11e-5*Math.pow(a,2)-.00727*a+22.58),this.target!==document.body&&(e.height=Math.max(e.height,24));var c=this.target.scrollTop/(n.scrollHeight-a);return e.top=c*(a-e.height-l)+t.top+parseFloat(i.borderTopWidth),this.target===document.body&&(e.height=Math.max(e.height,24)),e}}},{key:"clearCache",value:function(){this._cache={}}},{key:"cache",value:function(t,e){return void 0===this._cache&&(this._cache={}),void 0===this._cache[t]&&(this._cache[t]=e.call(this)),this._cache[t]}},{key:"enable",value:function(){var t=this,e=arguments.length<=0||void 0===arguments[0]||arguments[0];!1!==this.options.addTargetClasses&&f(this.target,this.getClass("enabled")),f(this.element,this.getClass("enabled")),this.enabled=!0,this.scrollParents.forEach(function(e){e!==t.target.ownerDocument&&e.addEventListener("scroll",t.position)}),e&&this.position()}},{key:"disable",value:function(){var t=this;d(this.target,this.getClass("enabled")),d(this.element,this.getClass("enabled")),this.enabled=!1,void 0!==this.scrollParents&&this.scrollParents.forEach(function(e){e.removeEventListener("scroll",t.position)})}},{key:"destroy",value:function(){var t=this;this.disable(),B.forEach(function(e,n){e===t&&B.splice(n,1)}),0===B.length&&a()}},{key:"updateAttachClasses",value:function(t,e){var n=this;t=t||this.attachment,e=e||this.targetAttachment;var i=["left","top","bottom","right","middle","center"];void 0!==this._addAttachClasses&&this._addAttachClasses.length&&this._addAttachClasses.splice(0,this._addAttachClasses.length),void 0===this._addAttachClasses&&(this._addAttachClasses=[]);var r=this._addAttachClasses;t.top&&r.push(this.getClass("element-attached")+"-"+t.top),t.left&&r.push(this.getClass("element-attached")+"-"+t.left),e.top&&r.push(this.getClass("target-attached")+"-"+e.top),e.left&&r.push(this.getClass("target-attached")+"-"+e.left);var o=[];i.forEach(function(t){o.push(n.getClass("element-attached")+"-"+t),o.push(n.getClass("target-attached")+"-"+t)}),O(function(){void 0!==n._addAttachClasses&&(v(n.element,n._addAttachClasses,o),!1!==n.options.addTargetClasses&&v(n.target,n._addAttachClasses,o),delete n._addAttachClasses)})}},{key:"position",value:function(){var t=this,e=arguments.length<=0||void 0===arguments[0]||arguments[0];if(this.enabled){this.clearCache();var n=X(this.targetAttachment,this.attachment);this.updateAttachClasses(this.attachment,n);var i=this.cache("element-bounds",function(){return s(t.element)}),r=i.width,o=i.height;if(0===r&&0===o&&void 0!==this.lastSize){var a=this.lastSize;r=a.width,o=a.height}else this.lastSize={width:r,height:o};var u=this.cache("target-bounds",function(){return t.getTargetBounds()}),d=u,f=E($(this.attachment),{width:r,height:o}),p=E($(n),d),h=E(this.offset,{width:r,height:o}),g=E(this.targetOffset,d);f=y(f,h),p=y(p,g);for(var v=u.left+p.left-f.left,m=u.top+p.top-f.top,_=0;_<I.modules.length;++_){var b=I.modules[_],A=b.position.call(this,{left:v,top:m,targetAttachment:n,targetPos:u,elementPos:i,offset:f,targetOffset:p,manualOffset:h,manualTargetOffset:g,scrollbarSize:R,attachment:this.attachment});if(!1===A)return!1;void 0!==A&&"object"==typeof A&&(m=A.top,v=A.left)}var w={page:{top:m,left:v},viewport:{top:m-pageYOffset,bottom:pageYOffset-m-o+innerHeight,left:v-pageXOffset,right:pageXOffset-v-r+innerWidth}},T=this.target.ownerDocument,L=T.defaultView,R=void 0;return L.innerHeight>T.documentElement.clientHeight&&(R=this.cache("scrollbar-size",c),w.viewport.bottom-=R.height),L.innerWidth>T.documentElement.clientWidth&&(R=this.cache("scrollbar-size",c),w.viewport.right-=R.width),-1!==["","static"].indexOf(T.body.style.position)&&-1!==["","static"].indexOf(T.body.parentElement.style.position)||(w.page.bottom=T.body.scrollHeight-m-o,w.page.right=T.body.scrollWidth-v-r),void 0!==this.options.optimizations&&!1!==this.options.optimizations.moveElement&&void 0===this.targetModifier&&function(){var e=t.cache("target-offsetparent",function(){return l(t.target)}),n=t.cache("target-offsetparent-bounds",function(){return s(e)}),i=getComputedStyle(e),r=n,o={};if(["Top","Left","Bottom","Right"].forEach(function(t){o[t.toLowerCase()]=parseFloat(i["border"+t+"Width"])}),n.right=T.body.scrollWidth-n.left-r.width+o.right,n.bottom=T.body.scrollHeight-n.top-r.height+o.bottom,w.page.top>=n.top+o.top&&w.page.bottom>=n.bottom&&w.page.left>=n.left+o.left&&w.page.right>=n.right){var a=e.scrollTop,c=e.scrollLeft;w.offset={top:w.page.top-n.top+a-o.top,left:w.page.left-n.left+c-o.left}}}(),this.move(w),this.history.unshift(w),this.history.length>3&&this.history.pop(),e&&U(),!0}}},{key:"move",value:function(t){var e=this;if(void 0!==this.element.parentNode){var n={};for(var i in t){n[i]={};for(var r in t[i]){for(var o=!1,a=0;a<this.history.length;++a){var s=this.history[a];if(void 0!==s[i]&&!_(s[i][r],t[i][r])){o=!0;break}}o||(n[i][r]=!0)}}var c={top:"",left:"",right:"",bottom:""},d=function(t,n){if(!1!==(void 0!==e.options.optimizations?e.options.optimizations.gpu:null)){var i=void 0,r=void 0;t.top?(c.top=0,i=n.top):(c.bottom=0,i=-n.bottom),t.left?(c.left=0,r=n.left):(c.right=0,r=-n.right),window.matchMedia&&(window.matchMedia("only screen and (min-resolution: 1.3dppx)").matches||window.matchMedia("only screen and (-webkit-min-device-pixel-ratio: 1.3)").matches||(r=Math.round(r),i=Math.round(i))),c[j]="translateX("+r+"px) translateY("+i+"px)","msTransform"!==j&&(c[j]+=" translateZ(0)")}else t.top?c.top=n.top+"px":c.bottom=n.bottom+"px",t.left?c.left=n.left+"px":c.right=n.right+"px"},f=!1;if((n.page.top||n.page.bottom)&&(n.page.left||n.page.right)?(c.position="absolute",d(n.page,t.page)):(n.viewport.top||n.viewport.bottom)&&(n.viewport.left||n.viewport.right)?(c.position="fixed",d(n.viewport,t.viewport)):void 0!==n.offset&&n.offset.top&&n.offset.left?function(){c.position="absolute";var i=e.cache("target-offsetparent",function(){return l(e.target)});l(e.element)!==i&&O(function(){e.element.parentNode.removeChild(e.element),i.appendChild(e.element)}),d(n.offset,t.offset),f=!0}():(c.position="absolute",d({top:!0,left:!0},t.page)),!f)if(this.options.bodyElement)this.options.bodyElement.appendChild(this.element);else{for(var p=!0,h=this.element.parentNode;h&&1===h.nodeType&&"BODY"!==h.tagName;){if("static"!==getComputedStyle(h).position){p=!1;break}h=h.parentNode}p||(this.element.parentNode.removeChild(this.element),this.element.ownerDocument.body.appendChild(this.element))}var g={},v=!1;for(var r in c){var m=c[r];this.element.style[r]!==m&&(v=!0,g[r]=m)}v&&O(function(){u(e.element.style,g),e.trigger("repositioned")})}}}]),e}(D);V.modules=[],I.position=M;var q=u(V,I),C=function(){function t(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),k=I.Utils,s=k.getBounds,u=k.extend,v=k.updateClasses,O=k.defer,z=["left","top","right","bottom"];I.modules.push({position:function(t){var e=this,n=t.top,i=t.left,r=t.targetAttachment;if(!this.options.constraints)return!0;var o=this.cache("element-bounds",function(){return s(e.element)}),a=o.height,l=o.width;if(0===l&&0===a&&void 0!==this.lastSize){var c=this.lastSize;l=c.width,a=c.height}var d=this.cache("target-bounds",function(){return e.getTargetBounds()}),f=d.height,p=d.width,h=[this.getClass("pinned"),this.getClass("out-of-bounds")];this.options.constraints.forEach(function(t){var e=t.outOfBoundsClass,n=t.pinnedClass;e&&h.push(e),n&&h.push(n)}),h.forEach(function(t){["left","top","right","bottom"].forEach(function(e){h.push(t+"-"+e)})});var g=[],m=u({},r),_=u({},this.attachment);return this.options.constraints.forEach(function(t){var o=t.to,s=t.attachment,c=t.pin;void 0===s&&(s="");var u=void 0,d=void 0;if(s.indexOf(" ")>=0){var h=s.split(" "),v=C(h,2);d=v[0],u=v[1]}else u=d=s;var b=A(e,o);"target"!==d&&"both"!==d||(n<b[1]&&"top"===m.top&&(n+=f,m.top="bottom"),n+a>b[3]&&"bottom"===m.top&&(n-=f,m.top="top")),"together"===d&&("top"===m.top&&("bottom"===_.top&&n<b[1]?(n+=f,m.top="bottom",n+=a,_.top="top"):"top"===_.top&&n+a>b[3]&&n-(a-f)>=b[1]&&(n-=a-f,m.top="bottom",_.top="bottom")),"bottom"===m.top&&("top"===_.top&&n+a>b[3]?(n-=f,m.top="top",n-=a,_.top="bottom"):"bottom"===_.top&&n<b[1]&&n+(2*a-f)<=b[3]&&(n+=a-f,m.top="top",_.top="top")),"middle"===m.top&&(n+a>b[3]&&"top"===_.top?(n-=a,_.top="bottom"):n<b[1]&&"bottom"===_.top&&(n+=a,_.top="top"))),"target"!==u&&"both"!==u||(i<b[0]&&"left"===m.left&&(i+=p,m.left="right"),i+l>b[2]&&"right"===m.left&&(i-=p,m.left="left")),"together"===u&&(i<b[0]&&"left"===m.left?"right"===_.left?(i+=p,m.left="right",i+=l,_.left="left"):"left"===_.left&&(i+=p,m.left="right",i-=l,_.left="right"):i+l>b[2]&&"right"===m.left?"left"===_.left?(i-=p,m.left="left",i-=l,_.left="right"):"right"===_.left&&(i-=p,m.left="left",i+=l,_.left="left"):"center"===m.left&&(i+l>b[2]&&"left"===_.left?(i-=l,_.left="right"):i<b[0]&&"right"===_.left&&(i+=l,_.left="left"))),"element"!==d&&"both"!==d||(n<b[1]&&"bottom"===_.top&&(n+=a,_.top="top"),n+a>b[3]&&"top"===_.top&&(n-=a,_.top="bottom")),"element"!==u&&"both"!==u||(i<b[0]&&("right"===_.left?(i+=l,_.left="left"):"center"===_.left&&(i+=l/2,_.left="left")),i+l>b[2]&&("left"===_.left?(i-=l,_.left="right"):"center"===_.left&&(i-=l/2,_.left="right"))),"string"==typeof c?c=c.split(",").map(function(t){return t.trim()}):!0===c&&(c=["top","left","right","bottom"]),c=c||[];var y=[],E=[];n<b[1]&&(c.indexOf("top")>=0?(n=b[1],y.push("top")):E.push("top")),n+a>b[3]&&(c.indexOf("bottom")>=0?(n=b[3]-a,y.push("bottom")):E.push("bottom")),i<b[0]&&(c.indexOf("left")>=0?(i=b[0],y.push("left")):E.push("left")),i+l>b[2]&&(c.indexOf("right")>=0?(i=b[2]-l,y.push("right")):E.push("right")),y.length&&function(){var t=void 0;t=void 0!==e.options.pinnedClass?e.options.pinnedClass:e.getClass("pinned"),g.push(t),y.forEach(function(e){g.push(t+"-"+e)})}(),E.length&&function(){var t=void 0;t=void 0!==e.options.outOfBoundsClass?e.options.outOfBoundsClass:e.getClass("out-of-bounds"),g.push(t),E.forEach(function(e){g.push(t+"-"+e)})}(),(y.indexOf("left")>=0||y.indexOf("right")>=0)&&(_.left=m.left=!1),(y.indexOf("top")>=0||y.indexOf("bottom")>=0)&&(_.top=m.top=!1),m.top===r.top&&m.left===r.left&&_.top===e.attachment.top&&_.left===e.attachment.left||(e.updateAttachClasses(_,m),e.trigger("update",{attachment:_,targetAttachment:m}))}),O(function(){!1!==e.options.addTargetClasses&&v(e.target,g,h),v(e.element,g,h)}),{top:n,left:i}}});var k=I.Utils,s=k.getBounds,v=k.updateClasses,O=k.defer;I.modules.push({position:function(t){var e=this,n=t.top,i=t.left,r=this.cache("element-bounds",function(){return s(e.element)}),o=r.height,a=r.width,l=this.getTargetBounds(),c=n+o,u=i+a,d=[];n<=l.bottom&&c>=l.top&&["left","right"].forEach(function(t){var e=l[t];e!==i&&e!==u||d.push(t)}),i<=l.right&&u>=l.left&&["top","bottom"].forEach(function(t){var e=l[t];e!==n&&e!==c||d.push(t)});var f=[],p=[],h=["left","top","right","bottom"];return f.push(this.getClass("abutted")),h.forEach(function(t){f.push(e.getClass("abutted")+"-"+t)}),d.length&&p.push(this.getClass("abutted")),d.forEach(function(t){p.push(e.getClass("abutted")+"-"+t)}),O(function(){!1!==e.options.addTargetClasses&&v(e.target,p,f),v(e.element,p,f)}),!0}});var C=function(){function t(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();return I.modules.push({position:function(t){var e=t.top,n=t.left;if(this.options.shift){var i=this.options.shift;"function"==typeof this.options.shift&&(i=this.options.shift.call(this,{top:e,left:n}));var r=void 0,o=void 0;if("string"==typeof i){i=i.split(" "),i[1]=i[1]||i[0];var a=i,s=C(a,2);r=s[0],o=s[1],r=parseFloat(r,10),o=parseFloat(o,10)}else r=i.top,o=i.left;return e+=r,n+=o,{top:e,left:n}}}}),q})},function(t,e,n){function i(t,e,n,i,r){function c(n){var r=s.parse(n,!0),a=o.parseInt(t.viewIndex);i.sendToBackground("tabs.CurrentTabId").then(function(n){return o.extend(r.query,{readcubeId:t.viewModel.id,tabId:n,articleIndex:a||0}),e.openTab(s.format(r)),!0}).catch(function(){return e.openTab(s.format(r)),!1})}function u(t){e.openTab(l(a.URL_DOI_RESOLVER,t))}function d(t,i){n.getInstitutionProxy().then(function(n){var r=s.parse(t,!0);o.extend(r.query,{readcubeId:i.id}),e.openTab(n.replace(a.EZPROXY_URL_REPLACE_KEY,s.format(r)))})}function f(e){t.viewModel&&r.downloadPdf(t.viewModel,e)}function p(){e.openTab(a.URL_ACCOUNT)}function h(){e.openTab(a.URL_GET_TRIAL)}function g(){return a.URL_ACCOUNT}t.onOpenLinkClick=c,t.onLoginWithProxyClick=d,t.onDownloadPdfClick=f,t.onOpenDoiClick=u,t.onOpenAccountClick=p,t.onGetTrialClick=h,t.getAccountLink=g,t.proxyIsNotAvailable=!1,t.pdfUrlsAvailable=!1,t.searchingPdfUrls=!1,t.institutionName=null,t.sfxUrl=null,t.pdfUrls=[],n.getInstitutionProxy().catch(function(){t.proxyIsNotAvailable=!0});var v=t.viewModel;v&&(v.doi||v.pmid)&&n.getSfxUrlByDoiAndPmid(v.doi,v.pmid).then(function(e){t.sfxUrl=e}),n.evaluateLoggedInUserDetail().then(function(e){t.institutionName=o.get(e,"institution",null)});var m=t.$watch("viewVisibility.visible",function(e){if(e&&t.viewModel&&t.viewModel.isPdfDownloadFailed()){t.searchingPdfUrls=!0;var n=o.get(t.viewModel,"metadata.title");n&&(t.pdfUrlsAvailable=!0,i.sendToBackground("request.GetPdfUrlsFromGoogleScholar",n).then(function(e){Array.isArray(e)&&e.length>0?t.pdfUrls=e:t.pdfUrlsAvailable=!1,t.searchingPdfUrls=!1})),m()}})}i.$inject=["$scope","BrowserTab","User","Message","TooltipApi"];var r=n(2),o=n(1),a=n(0),s=n(9),l=n(5).sprintf;r.module("App").controller("PdfWarning",i)},function(t,e,n){function i(t){return{restrict:"E",transclude:"element",replace:!0,scope:{viewVisibility:"="},link:function(e,n,i,r,l){e.viewVisibility||(e.viewVisibility={visible:!1});var c=s.extend(t.getOptions(),s.pick(i,["parentSelector","attachment","targetAttachment","targetOffset"])),u=null,d=null,f=null;l(function(t,e){d=a(t[0]).addClass("readcube-tooltip-container").appendTo(a("body")),f=e,u=new o({element:d.get(0),target:a(n).parents(c.parentSelector).get(0),attachment:c.attachment,targetAttachment:c.targetAttachment,targetOffset:c.targetOffset,constraints:c.constraints})}),e.$watch("viewVisibility.visible",function(t){d&&d.toggleClass("readcube-tooltip-hidden",!t)}),e.$on("$destroy",function(){u&&u.destroy(),d&&d.remove(),f&&f.$destroy()});var p=!1;e.$watch(function(){p||(p=!0,e.$$postDigest(function(){p=!1,u.position()}))})}}}i.$inject=["tetherTooltipConfig"];var r=n(2),o=n(31),a=n(4),s=n(1);r.module("App").directive("tetherTooltip",i)},function(t,e,n){function i(){this.config={parentSelector:".readcube-button-holder:first",attachment:"bottom center",targetAttachment:"top center",targetOffset:"-6px 0",constraints:[{to:"scrollParent"}]},this.setOptions=function(t){o.extend(this.config,t)},this.getOptions=function(){return this.config},this.$get=function(){return this}}var r=n(2),o=n(1);r.module("App").provider("tetherTooltipConfig",i)},function(t,e,n){function i(){return{restrict:"E",templateUrl:"tooltip/index",replace:!0,scope:{side:"@",viewModel:"=",viewVisibility:"=",viewText:"@",viewUrl:"@",viewIndex:"@",viewClass:"@",viewClose:"@",viewRetry:"@",viewRetryMethod:"&"},link:function(t,e,n){function i(e){e.stopPropagation(),t.viewVisibility.visible=!1}function r(e){"function"==typeof t.viewRetryMethod&&t.viewRetryMethod()}t.onCloseTooltipClick=i,t.onRetryClick=r,t.viewVisibility||(t.viewVisibility={visible:!1})}}}n(2).module("App").directive("tooltip",i)},function(t,e,n){function i(t,e){return{openLibrary:function(){return e.sendToBackground("tabs.OpenLibrary",null)},openItemInLibrary:function(t,n){return e.sendToBackground("tabs.OpenItemInLibrary",{itemId:t,collectionId:n})},openDocumentInLibrary:function(e,n){return t.open(a(o.URL_LIBRARY_DOCUMENT,e,n))},openTab:function(e){return t.open(e)},openOptions:function(){chrome.tabs.create({url:"options.html"})}}}i.$inject=["$window","Message"];var r=n(2),o=n(0),a=n(5).sprintf;r.module("App").factory("BrowserTab",i)},function(t,e,n){function i(t){return{connectWithBackground:function(e,n){var i=t.defer(),r=chrome.runtime.connect({name:"readcube-extension-connection"}),a=!1;return r.postMessage({message:o.MESSAGE_START,data:n,method:e}),r.onMessage.addListener(function(t){t.message==o.MESSAGE_FINISH?(i.resolve(t.data),a=!0):t.message==o.MESSAGE_PROGRESS&&i.notify(t.data)}),r.onDisconnect.addListener(function(){a||i.resolve(null)}),i.promise}}}i.$inject=["$q"];var r=n(2),o=n(0);r.module("App").factory("Connection",i)},function(t,e,n){function i(t){return{getUploadPromise:function(e,n){var i=new XMLHttpRequest,r=t.defer();return i.upload.addEventListener("progress",function(t){t.lengthComputable?r.notify(parseInt(t.loaded/t.total*100)):r.notify(50)}),i.onreadystatechange=function(t){4==t.target.readyState&&(200==t.target.status?r.resolve(t.target):r.reject(t.target))},i.open("PUT",e,!0),i.setRequestHeader("Content-Type","application/pdf"),i.send(n),r.promise}}}i.$inject=["$q"],n(2).module("App").factory("FileRequest",i)},function(t,e,n){function i(t){var e=t.navigator.onLine;return t.addEventListener("offline",function(){e=!1}),t.addEventListener("online",function(){e=!0}),{isOnline:function(){return e},isOffline:function(){return!e}}}i.$inject=["$window"],n(2).module("App").factory("OnlineStatus",i)},function(t,e,n){function i(t,e){return{status:function(t){if(t.ext_ids.length>100){idsCopy=[].concat(t.ext_ids);var n=idsCopy.splice(0,100);return e.all({statuses:s.post(o.URL_ARTICLES_STATUS,{ext_ids:n}),others:s.post(o.URL_ARTICLES_STATUS,{ext_ids:idsCopy})}).then(function(t){var e=l.get(t,"statuses.data.items",[]),n=l.get(t,"others.data.items",[]);return t.statuses.data.items=e.concat(n),t.statuses})}return s.post(o.URL_ARTICLES_STATUS,t)},updateStatusForArticle:function(t){return this.status({ext_ids:[t.getIdentifiers()]}).then(function(e){var n=l.get(e,"data.items[0]",null);n&&(t.collections=n.collections,t.collection_id=n.collection_id,t.hasPdf=n.has_file,t.id=n.id)})},metadata:function(t){return s.post(o.URL_ARTICLES_METADATA,t)},getStatusWithMetadata:function(t){var n={ext_ids:t};return e.all({articlesStatus:this.status(n),articlesMetadata:this.metadata(n)}).then(function(n){var i=l.get(n,"articlesStatus.data.items",[]),r=l.get(n,"articlesMetadata.data",[]);return 0==i.length?e.reject("No items in the response"):0==r.length?i:(t.forEach(function(t,e){var n=l.find(r,function(e){if(t.doi&&e.doi){if(t.doi.toLowerCase()==e.doi.toLowerCase())return!0}return!(!t.pmid||e.pmid!=t.pmid)||!(!t.gsid||e.gsid!=t.gsid)});n&&l.extend(i[e],{pdfUrl:l.get(n,"pdf_urls[0]",null),pdfHash:l.get(n,"hash",null),url:l.get(n,"url",null)})}),i)})},add:function(t){return s.post(o.URL_ADD_ARTICLE,t)},addWithMetadata:function(t){return s.post(o.URL_ADD_ARTICLE_METADATA,t)},update:function(t,e,n){return s.patch(a(o.URL_COLLECTION_ARTICLE,e,t),n)},get:function(t){return s.get(a(o.URL_ARTICLE_GET,t))}}}i.$inject=["$http","$q"];var r=n(2),o=n(0),a=n(5).sprintf,s=n(7),l=n(1);r.module("App").factory("Article",i)},function(t,e,n){function i(t,e,n){function i(t){return!t.group_id&&!t.name}function r(){return l.get(o.URL_COLLECTIONS).then(function(t){var e=s.get(t,"data.collections",[]),n=[];return e.forEach(function(t){i(t)&&(t.name=o.DEFAULT_PERSONAL_LIBRARY_NAME),n.push(l.get(c(o.URL_COLLECTION_LISTS,t.collection_id)).then(function(e){var n=s.get(e,"data.lists",[]);return t.lists=d(n),!0}))}),a.all(n).then(function(){return u().then(function(t){return{groups:s.reduce(t,function(t,n,i){return t.push({group_id:i,collections:s.filter(e,{group_id:parseInt(i)||null})}),t},[]).sort(function(t){return null!==t}),groupNames:t}})})})}function u(){return l.get(o.URL_GROUPS).then(function(t){var e=s.get(t,"data.groups",[]);return s.reduce(e,function(t,e){return t[e.id]=e.name,t},{null:"Personal"})})}function d(t){function e(t,n,i,r){return s.sortBy(t,"name").forEach(function(t){t.level=i,r.push(t);var o=s.partition(n,{parent_id:t.id});e(o[0],o[1],i+1,r)}),r}var n=s.partition(t,function(t){return!t.parent_id});return e(n[0],n[1],0,[])}return{queryFlat:function(){return r()},queryStorage:function(){return e.get("lists",null).then(function(t){return s.isNull(t)?n.reject("The lists array is empty"):t})},addItems:function(t,e){return l.post(c(o.URL_LISTS_ADD_ITEMS,t),{item_ids:e})},clear:function(){e.set("lists",null)}}}i.$inject=["$http","Storage","$q"];var r=n(2),o=n(0),a=n(8),s=n(1),l=n(7),c=n(5).sprintf;r.module("App").factory("List",i)},function(t,e,n){function i(t,e,n,i){return u(t,{getArticlePdfResolvePromise:function(t){function i(){s--,r.getArticleIdFromFileHash(t).then(function(t){n.cancel(l),a.resolve(t),r.article.extend({id:t,inLibraryStatus:o.STATUS_IN_LIBRARY_WITH_PDF})}),0==s&&(n.cancel(l),a.reject("The PDF was not resolved during 1 minute"),r.article.inLibraryStatus=o.STATUS_PDF_RESOLVE_WARNING)}var r=this,a=e.defer(),s=10;r.article.inLibraryStatus=o.STATUS_PDF_RESOLVING,i();var l=n(i,6e3);return a.promise},getArticleIdFromFileHash:function(t){return c.get(a(o.URL_FILES,t)).then(function(t){var n=s.chain(t).get("data.items",[]).compact().get("[0]",null).value();return n||e.reject("Article id not found")})},upload:function(){var t=this;return t.article.extend({progressPercent:0,progressType:o.PROGRESS_DOWNLOAD,inLibraryStatus:o.STATUS_PDF_DOWNLOADING,usingPdfUrl:t.article.pdfUrl}),e.when(function(){return t.article.pdfUrl?t.getDownloadPromise({url:t.article.pdfUrl,isProxied:!1}):e.reject("Pdf url not available")}()).catch(function(n){return t.article.inLibraryStatus=o.STATUS_IN_LIBRARY_WITHOUT_PDF_WARNING,e.reject(n)}).then(function(n){return t.getArticleIdFromFileHash(n.sha256Hash).then(function(e){return t.article.id=e,t.article.inLibraryStatus=o.STATUS_IN_LIBRARY_WITH_PDF,e}).catch(function(i){if(i.status==l.UNAUTHORIZED)return t.article.inLibraryStatus=o.STATUS_NOT_LOGGED_IN,e.reject(i);var r="";t.article.pdfUrl&&t.article.pdfUrl.length&&(r=encodeURIComponent(t.article.pdfUrl.substring(0,500))),t.article.progressPercent=0,t.article.progressType=o.PROGRESS_UPLOAD;var u,d=t.fixPdfFilename(n.fileName);return u=t.article.collection_id&&t.article.id?a(o.URL_UPLOAD,t.article.collection_id,"false",n.sha256Hash,"","",n.fileSize,t.article.id,encodeURIComponent(d),r):a(o.URL_UPLOAD_DEFAULT,t.article.id?"false":"true",n.sha256Hash,"","",n.fileSize,t.article.id?t.article.id:"",encodeURIComponent(d),r),c.get(u).then(function(i){var r=s.get(i,"data.url");return r?t.getUploadPromise(r,n.blob):e.reject("Unable to receive the upload url")}).then(null,null,function(e){t.article.progressPercent=e}).catch(function(e){return t.evaluateUploadError(e,o.STATUS_IN_LIBRARY_WITHOUT_PDF_WARNING)}).then(function(){return t.article.id?(t.article.inLibraryStatus=o.STATUS_IN_LIBRARY_WITH_PDF,!0):t.getArticlePdfResolvePromise(n.sha256Hash)})})})}})}i.$inject=["Upload","$q","$interval","$http"];var r=n(2),o=n(0),a=n(5).sprintf,s=n(1),l=n(11),c=n(7),u=n(3);r.module("App").factory("RawUpload",i)},function(t,e,n){function i(t,e,n){return a({__constructor:function(t){this.article=t},getUploadPromise:function(e,n){var i=new XMLHttpRequest,r=t.defer();return i.upload.addEventListener("progress",function(t){t.lengthComputable?r.notify(parseInt(t.loaded/t.total*100)):r.notify(50)}),i.onreadystatechange=function(t){4==t.target.readyState&&(200==t.target.status?r.resolve(t.target):r.reject(t.target))},i.open("PUT",e,!0),i.setRequestHeader("Content-Type","application/pdf"),i.send(n),r.promise},getDownloadPromise:function(n){var i=this;return n.url?e.connectWithBackground("request.GetPdfBase64",n).then(function(e){return e&&e.base64&&e.sha256Hash?{blob:o.toBlob(e.base64),sha256Hash:e.sha256Hash,fileSize:e.fileSize,fileName:e.fileName}:t.reject("No PDF file was found")},null,function(t){i.article.progressPercent=t.percent}):t.reject("No PDF url provided")},upload:function(){throw new Error("Method not implemented")},evaluateUploadError:function(e,i){var r=this;return e.status===s.UNPROCESSABLE_ENTITY?e:e.status===s.FORBIDDEN?n.getSubscriptionStatus().then(function(e){switch(e){case l.SUBSCRIPTION_TRIAL_EXPIRED:return r.article.inLibraryStatus=l.STATUS_IN_LIBRARY_WITHOUT_PDF_EXPIRED_TRIAL,t.reject("Unable to add pdf because the trial period is expired");case l.SUBSCRIPTION_PRO_EXPIRED:return r.article.inLibraryStatus=l.STATUS_IN_LIBRARY_WITHOUT_PDF_EXPIRED_SUBSCRIPTION,t.reject("Unable to add pdf because the subscription is expired");default:return r.article.inLibraryStatus=l.STATUS_IN_LIBRARY_WITHOUT_PDF_NO_SUBSCRIPTION,t.reject("Unable to add pdf because the account is without subscription")}}):(i&&(r.article.inLibraryStatus=i),t.reject(e))},fixPdfFilename:function(t){if(t)return t;var e=c.get(this.article,"metadata.title",""),n=(new Date).toLocaleString();return e?e+".pdf":this.article.usingPdfUrl?u.getHostnameFromUrl(this.article.usingPdfUrl)+" "+n+".pdf":n+".pdf"}})}i.$inject=["$q","Connection","User"];var r=n(2),o=n(25),a=n(3),s=n(11),l=n(0),c=n(1),u=n(13);r.module("App").factory("Upload",i)},function(t,e,n){function i(){return{downloadPdf:function(t,e){this.article=t,this.pdfUrl=e,++this.messageCount},article:null,pdfUrl:null,messageCount:0}}n(2).module("App").factory("TooltipApi",i)},function(t,e,n){var i=n(8);e.sendToTabById=function(t,e){var n=i.defer();return t?chrome.tabs.sendMessage(t,e,n.resolve):n.reject("No tab id was provided"),n.promise},e.sendToBackground=function(t,e){var n=i.defer();return chrome.runtime.sendMessage({method:t,data:e},function(t){n.resolve(t)}),n.promise},e.getActiveTabId=function(){var t=i.defer();return chrome.tabs.query({active:!0,currentWindow:!0},function(e){if(0==e.length)return void t.reject("No active tabs were found");t.resolve(e[0].id)}),t.promise}},,,function(t,e){t.exports='<div ng-switch="buttonData.inLibraryStatus" class="readcube-relative">\n  <a ng-switch-when="in_library"  class="readcube-button right-space" href ng-click="onInLibraryClick($event)">\n    <span class="readcube-icon-extended readcube-icon-check"></span> In Library\n    <span class="readcube-triangle-holder" ng-click="onTriangleClick($event)" ng-hide="isPopup">\n      <span class="readcube-icon readcube-icon-triangle readcube-icon-triangle-imported"></span>\n    </span>\n  </a>\n\n  <a ng-switch-when="in_library_with_pdf" class="readcube-button right-space-icon" href ng-click="onInLibraryClick($event)">\n    <span class="readcube-icon-extended readcube-icon-check"></span> In Library\n    <span class="readcube-triangle-holder" ng-click="onTriangleClick($event)" ng-hide="isPopup">\n      <span class="readcube-icon readcube-icon-triangle readcube-icon-triangle-imported"></span>\n    </span>\n    <span class="readcube-right-box" ng-click="onInLibraryDocumentClick($event)">\n      <span class="readcube-icon-extended readcube-icon-document"></span>\n    </span>\n  </a>\n\n  <a ng-switch-when="in_library_without_pdf" class="readcube-button right-space-icon" href ng-click="onInLibraryClick($event)">\n    <span class="readcube-icon-extended readcube-icon-check"></span> In Library\n    <span class="readcube-triangle-holder" ng-click="onTriangleClick($event)" ng-hide="isPopup">\n      <span class="readcube-icon readcube-icon-triangle readcube-icon-triangle-imported"></span>\n    </span>\n    <span class="readcube-right-box-gray" ng-click="onDownloadPdfClick($event)">\n      <span class="readcube-icon-extended readcube-icon-arrow-down"></span>\n    </span>\n  </a>\n\n  <a ng-switch-when="in_library_without_pdf_warning_proxy" class="readcube-button right-space-icon" href\n     ng-click="onInLibraryClick($event)">\n    <span class="readcube-icon-extended readcube-icon-check"></span> In Library\n    <span class="readcube-triangle-holder" ng-click="onTriangleClick($event)" ng-hide="isPopup">\n      <span class="readcube-icon readcube-icon-triangle readcube-icon-triangle-imported"></span>\n    </span>\n    <span class="readcube-right-box-orange" ng-click="onShowTooltipClick($event)">\n      <span class="readcube-exclamation">!</span>\n    </span>\n  </a>\n\n  <div ng-switch-when="in_library_without_pdf_warning_proxy">\n    <tether-tooltip view-visibility="tooltipVisibility">\n      <tooltip view-visibility="tooltipVisibility" view-url="tooltip/pdf_warning_proxy" view-class="readcube-tooltip-warning"\n        view-model="buttonData" view-index="{{buttonIndex}}" view-close="yes"></tooltip>\n    </tether-tooltip>\n  </div>\n\n  <a ng-switch-when="in_library_without_pdf_warning" class="readcube-button right-space-icon" href ng-click="onInLibraryClick($event)">\n    <span class="readcube-icon-extended readcube-icon-check"></span> In Library\n    <span class="readcube-triangle-holder" ng-click="onTriangleClick($event)" ng-hide="isPopup">\n      <span class="readcube-icon readcube-icon-triangle readcube-icon-triangle-imported"></span>\n    </span>\n    <span class="readcube-right-box-orange" ng-click="onShowTooltipClick($event)">\n      <span class="readcube-exclamation">!</span>\n    </span>\n  </a>\n  <div ng-switch-when="in_library_without_pdf_warning">\n    <tether-tooltip view-visibility="tooltipVisibility">\n      <tooltip view-url="tooltip/pdf_warning" view-class="readcube-tooltip-warning" view-visibility="tooltipVisibility"\n        view-model="buttonData" view-index="{{buttonIndex}}" view-close="yes"></tooltip>\n    </tether-tooltip>\n  </div>\n\n  <a ng-switch-when="not_found" class="readcube-button readcube-decolored" href ng-click="onAddToLibraryClick($event)"\n     ng-mouseenter="onMouseEnter()" ng-mouseleave="onMouseLeave()">\n    <span class="readcube-icon readcube-icon-add"></span>\n    ReadCube\n    <span class="readcube-triangle-holder" ng-click="onTriangleClick($event)">\n      <span class="readcube-icon readcube-icon-triangle"></span>\n    </span>\n  </a>\n\n  <a ng-switch-when="metadata_adding" class="readcube-button right-space-icon left-space" href="#"\n     ng-click="preventPropagation($event)">\n    Importing...\n    <span class="readcube-right-box" ng-click="onShowTooltipClick($event)">\n      <span class="readcube-icon-extended readcube-icon-circle"></span>\n    </span>\n  </a>\n  <div ng-switch-when="metadata_adding">\n    <tether-tooltip view-visibility="tooltipVisibility">\n      <tooltip view-visibility="tooltipVisibility" view-text="Adding metadata to your library..." view-close="yes"></tooltip>\n    </tether-tooltip>\n  </div>\n\n  <a ng-switch-when="pdf_downloading" class="readcube-button right-space-icon" href="#">\n    <span class="readcube-icon-extended readcube-icon-check"></span> In Library\n    <span class="readcube-triangle-holder" ng-click="onTriangleClick($event)" ng-hide="isPopup">\n      <span class="readcube-icon readcube-icon-triangle readcube-icon-triangle-imported"></span>\n    </span>\n    <span class="readcube-right-box" ng-click="onShowTooltipClick($event)">\n      <span class="readcube-icon-extended readcube-icon-circle"></span>\n    </span>\n  </a>\n  <div ng-switch-when="pdf_downloading">\n    <tether-tooltip view-visibility="tooltipVisibility">\n      <tooltip view-url="tooltip/pdf_downloading" view-model="buttonData" view-visibility="tooltipVisibility"\n               view-class="readcube-tooltip-progress" view-close="yes"></tooltip>\n    </tether-tooltip>\n  </div>\n\n  <a href="#" ng-switch-when="status_in_library_without_pdf_no_subscription" class="readcube-button right-space-icon"\n     ng-click="onInLibraryClick($event)">\n    <span class="readcube-icon-extended readcube-icon-check"></span> In Library\n    <span class="readcube-triangle-holder" ng-click="onTriangleClick($event)" ng-hide="isPopup">\n      <span class="readcube-icon readcube-icon-triangle readcube-icon-triangle-imported"></span>\n    </span>\n    <span class="readcube-right-box" ng-click="onShowTooltipClick($event)">\n      <span class="readcube-icon-extended readcube-icon-arrow-down"></span>\n    </span>\n  </a>\n  <div ng-switch-when="status_in_library_without_pdf_no_subscription">\n    <tether-tooltip view-visibility="tooltipVisibility">\n      <tooltip view-close="yes" view-class="readcube-tooltip-warning" view-url="tooltip/pdf_no_subscription"\n               view-visibility="tooltipVisibility"></tooltip>\n    </tether-tooltip>\n  </div>\n\n  <a href="#" ng-switch-when="status_in_library_without_pdf_expired_subscription" class="readcube-button right-space-icon"\n     ng-click="onInLibraryClick($event)">\n    <span class="readcube-icon-extended readcube-icon-check"></span> In Library\n    <span class="readcube-triangle-holder" ng-click="onTriangleClick($event)" ng-hide="isPopup">\n      <span class="readcube-icon readcube-icon-triangle readcube-icon-triangle-imported"></span>\n    </span>\n    <span class="readcube-right-box" ng-click="onShowTooltipClick($event)">\n      <span class="readcube-icon-extended readcube-icon-arrow-down"></span>\n    </span>\n  </a>\n  <div ng-switch-when="status_in_library_without_pdf_expired_subscription">\n    <tether-tooltip view-visibility="tooltipVisibility">\n      <tooltip view-close="yes" view-class="readcube-tooltip-warning" view-url="tooltip/pdf_expired_subscription"\n               view-visibility="tooltipVisibility"></tooltip>\n    </tether-tooltip>\n  </div>\n\n  <a href="#" ng-switch-when="status_in_library_without_pdf_expired_trial" class="readcube-button right-space-icon"\n     ng-click="onInLibraryClick($event)">\n    <span class="readcube-icon-extended readcube-icon-check"></span> In Library\n    <span class="readcube-triangle-holder" ng-click="onTriangleClick($event)" ng-hide="isPopup">\n      <span class="readcube-icon readcube-icon-triangle readcube-icon-triangle-imported"></span>\n    </span>\n    <span class="readcube-right-box" ng-click="onShowTooltipClick($event)">\n      <span class="readcube-icon-extended readcube-icon-arrow-down"></span>\n    </span>\n  </a>\n  <div ng-switch-when="status_in_library_without_pdf_expired_trial">\n    <tether-tooltip view-visibility="tooltipVisibility">\n      <tooltip view-close="yes" view-class="readcube-tooltip-warning" view-url="tooltip/pdf_expired_trial"\n               view-visibility="tooltipVisibility"></tooltip>\n    </tether-tooltip>\n  </div>\n\n  <div ng-if="offlineTooltipVisibility.visible">\n    <tether-tooltip view-visibility="offlineTooltipVisibility">\n      <tooltip view-close="yes" view-text="Import error - please check your network connection and try again"\n               view-visibility="offlineTooltipVisibility"></tooltip>\n    </tether-tooltip>\n  </div>\n</div>\n'},function(t,e){t.exports='<div class="readcube-dropdown-container" ng-show="show">\n  <div class="dropdown-menu-triangle" ng-class="{down :!isBelowButton, up: isBelowButton}" ng-style="triangleStyle"></div>\n  <ul class="dropdown-menu" ng-style="boxStyle">\n    <button ng-if="shouldDisplayAddButton" ng-click="addToLibrary()" type="button"\n            class="add-to-library-button"\n            style="margin:0 auto; display:block;">\n      Add to Library\n    </button>\n    <li ng-repeat="data in options.groups"\n      class="dropdown-group-name">\n      <span class="dropdown-collection-header" ng-if="hasMultipleCollections()">\n        {{ options.groupNames[data.group_id] }}\n      </span>\n      <ul class="dropdown-group-list" ng-repeat="collection in data.collections">\n        <li class="dropdown-collection-name">\n          <label\n            ng-click="$event.stopPropagation()"\n            style="padding-left: 20px"\n            class="dropdown-truncate">\n            <input\n              class="dropdown-checkbox"\n              type="checkbox"\n              ng-disabled="collection.disabled"\n              ng-model="collection.selected">\n              {{ collection.name }}<span\n                ng-show="!shouldDisplayAddButton && collection._imported"\n                style="cursor: pointer"\n                ng-click="onClickOpenArrow($event, collection.collection_id)"> ➜</span>\n          </label>\n        </li>\n        <ul class="dropdown-group-list" ng-repeat="list in collection.lists">\n          <li class="dropdown-list-name">\n            <label\n              ng-click="$event.stopPropagation()"\n              ng-style="{\'padding-left\': ((list.level + 2) * 20) + \'px\' }"\n              class="dropdown-truncate">\n              <input\n                class="dropdown-checkbox"\n                type="checkbox"\n                ng-disabled="list.disabled"\n                ng-model="list.selected">\n                {{ list.name }}<span\n                  ng-show="!shouldDisplayAddButton && list._imported"\n                  style="cursor: pointer"\n                  ng-click="onClickOpenArrow($event, collection.collection_id)"> ➜</span>\n            </label>\n          </li>\n        </ul>\n      </ul>\n    </li>\n  </ul>\n</div>\n'},function(t,e){t.exports='<div class="readcube-login-container" ng-if="show" ng-click="onCloseButtonClick()">\n  <div class="readcube-login-close">\n    <div class="readcube-login-close-button">×</div>\n  </div>\n  <iframe class="readcube-login-iframe" src="{{iframeUrl}}"></iframe>\n</div>'},function(t,e){t.exports='<span\n  ng-if="isInSharedLibrary()"\n  class="readcube-icon-shared-library"\n  ng-attr-title="{{sharedLibrariesTooltip()}}"\n></span>\n'},function(t,e){t.exports='<div class="readcube-progress-bar"\n     ng-class="{\'readcube-progress-bar-upload\': viewModel.progressType == \'progress_upload\',\n      \'readcube-cancel-transition\': viewModel.progressPercent == 100 }"\n     style="width: {{ viewModel.progressPercent }}%"></div>\n<div class="reacube-tooltip-content">\n  <div class="readcube-tooltip-title">\n    Downloading PDF from {{ viewModel.usingPdfUrl | hostname }}...\n  </div>\n</div>'},function(t,e){t.exports='<div class="readcube-tooltip-title">\n  Article metadata imported. <br/> Your <a href="{{ getAccountLink() }}" target="_blank">ReadCube Pro</a> has expired -\n  re-subscribe to also automatically find and import PDFs\n</div>\n<div>\n  <button ng-click="onOpenAccountClick()" class="readcube-blue-button">\n    Go Pro\n  </button>\n  <button ng-click="viewVisibility.visible = false" class="readcube-blue-button readcube-blue-button-disabled">\n    Later\n  </button>\n</div>'},function(t,e){t.exports='<div class="readcube-tooltip-title">\n  Article metadata imported. Your ReadCube Pro has expired - <a href="{{ getAccountLink() }}" target="_blank">re-subscribe</a>\n  or get another 30 day free trial to automatically find and import PDFs\n</div>\n<div>\n  <button ng-click="onOpenAccountClick()" class="readcube-blue-button readcube-small-button">\n    Go Pro\n  </button>\n  <button ng-click="onGetTrialClick()" class="readcube-blue-button readcube-small-button">\n    Get Trial\n  </button>\n  <button ng-click="viewVisibility.visible = false" class="readcube-blue-button readcube-blue-button-disabled readcube-small-button">\n    Later\n  </button>\n</div>'},function(t,e){t.exports='<div ng-if="searchingPdfUrls" class="readcube-tooltip-searching-locations">\n  <span class="readcube-icon-extended readcube-icon-circle"></span> Searching for more download locations...\n</div>\n<div ng-if="!searchingPdfUrls" class="readcube-tooltip-pdf-text">\n  This full text PDF of this article may be available from one or more of the following sites:\n</div>\n<div ng-if="!searchingPdfUrls" class="readcube-tooltip-pdfs-list">\n  <div class="readcube-tooltip-pdf" ng-repeat="pdfUrl in pdfUrls">\n    <span ng-click="onDownloadPdfClick(pdfUrl)" title="Import pdf" class="readcube-tooltip-pdf-download">\n      <span class="readcube-icon-extended readcube-icon-download"></span>\n    </span>\n    <span class="readcube-tooltip-pdf-hostname" title="Open pdf file {{ pdfUrl }}" ng-click="onOpenLinkClick(pdfUrl)">{{pdfUrl | hostname}}</span>\n  </div>\n</div>\n'},function(t,e){t.exports='<div class="readcube-tooltip-title">\n  Article metadata imported. <br/> Try <a href="{{ getAccountLink() }}" target="_blank">ReadCube Pro</a> to also automatically\n  find and import PDFs. Start your risk-free 30 day trial?\n</div>\n<div>\n  <button ng-click="onOpenAccountClick()" class="readcube-blue-button">\n    Start trial\n  </button>\n  <button ng-click="viewVisibility.visible = false" class="readcube-blue-button readcube-blue-button-disabled">\n    Later\n  </button>\n</div>'},function(t,e){t.exports='<div class="readcube-tooltip-title">\n  Automatic PDF Download Unsuccessful\n</div>\n<div>\n  <button ng-if="viewModel.url" ng-click="onOpenLinkClick(viewModel.url)" class="readcube-blue-button">\n    Go to Article Page\n  </button>\n  <button ng-if="!viewModel.url && viewModel.doi" ng-click="onOpenDoiClick(viewModel.doi)" class="readcube-blue-button">\n    Go to Article Page\n  </button>\n  <span class="readcube-icon-holder">\n    <button ng-if="viewModel.pdfUrl" ng-click="onOpenLinkClick(viewModel.pdfUrl)" class="readcube-blue-button">\n      Go to PDF\n    </button>\n    <span ng-if="viewModel.pdfUrl" class="readcube-icon-extended readcube-icon-lock"></span>\n  </span>\n  <div ng-if="institutionName && sfxUrl" class="readcube-institution-sfx">\n    <a href="{{ sfxUrl }}" target="_blank"><span class="readcube-icon-extended readcube-icon-arrow-orange"></span></a>\n    <a href="{{ sfxUrl }}" target="_blank">Find at {{ institutionName }} (SFX)</a>\n  </div>\n  <div ng-if="pdfUrlsAvailable" ng-include="\'tooltip/pdf_list\'" class="readcube-pdf-advanced-search"></div>\n</div>'},function(t,e){t.exports='<div class="readcube-tooltip-title">\n  Automatic PDF Download Unsuccessful\n</div>\n<div>\n  <button ng-if="viewModel.url" ng-click="onLoginWithProxyClick(viewModel.url, viewModel)" class="readcube-blue-button">\n    Go to Article Page\n  </button>\n  <button ng-if="!viewModel.url && viewModel.doi" ng-click="onOpenDoiClick(viewModel.doi)" class="readcube-blue-button">\n    Go to Article Page\n  </button>\n  <span class="readcube-icon-holder">\n    <button ng-if="viewModel.pdfUrl" ng-click="onLoginWithProxyClick(viewModel.pdfUrl, viewModel)"\n            class="readcube-blue-button">\n      Go to PDF\n    </button>\n    <span ng-if="viewModel.pdfUrl" class="readcube-icon-extended readcube-icon-lock"></span>\n  </span>\n  <div ng-if="institutionName && sfxUrl" class="readcube-institution-sfx">\n    <a href="{{ sfxUrl }}" target="_blank"><span class="readcube-icon-extended readcube-icon-arrow-orange"></span></a>\n    <a href="{{ sfxUrl }}" target="_blank">Find at {{ institutionName }} (SFX)</a>\n  </div>\n  <div ng-if="pdfUrlsAvailable" ng-include="\'tooltip/pdf_list\'" class="readcube-pdf-advanced-search"></div>\n</div>'},function(t,e){t.exports='<div class="readcube-button-holder" add-to-library-button\n     ng-show="list.articlesList[%1$d].isReadyForShowing"\n     when-add-to-library-click="list.onAddToLibraryClick(index)"\n     when-in-library-click="list.onInLibraryClick(index)"\n     when-in-library-document-click="list.onInLibraryDocumentClick(index)"\n     when-download-pdf-click="list.onDownloadPdfClick(index)"\n     when-triangle-click="list.onTriangleClick(event, index, isInLibrary)"\n     button-data="list.articlesList[%1$d]"\n     button-index="%1$d"></div>\n'},function(t,e,n){n(2).module("App").run(["$templateCache",function(t){t.put("tooltip/pdf_expired_subscription",n(53)),t.put("tooltip/pdf_expired_trial",n(54)),t.put("tooltip/pdf_no_subscription",n(56)),t.put("tooltip/pdf_downloading",n(52)),t.put("tooltip/pdf_warning",n(57)),t.put("tooltip/pdf_warning_proxy",n(58)),t.put("tooltip/pdf_list",n(55)),t.put("tooltip/index",n(29))}])},function(t,e,n){var i=n(2),r=n(0);i.module("App").config(["$sceDelegateProvider",function(t){t.resourceUrlWhitelist(["self",r.URL_REGEXP_MAIN_URL])}])},function(t,e,n){function i(t,e,n,i,r,c,u,d,f,p,h,g,v,m){function _(t){r.listenForMessages(function(e,n){switch(e.message){case o.MESSAGE_GET_ARTICLES:n(N.articlesList);break;case o.MESSAGE_UPDATE_ARTICLE:var i=a.get(e,"data.updateDetails",{}),r=a.get(e,"data.index",null);if(!a.isNull(r)&&!a.isEmpty(i)){var s=N.articlesList.filter(function(t){return t.isReadyForShowing});a.extend(s[r],i),v.$apply()}n(!0);break;case o.MESSAGE_IS_ABSTRACT_PAGE:n(t.isAbstractPage());break;case o.MESSAGE_SELECT_ALL_SHOW:n(!0);break;case o.MESSAGE_SHOW_LOGIN:N.loginIframe.show=!0,N.queuedArticleIndexes=a.get(e,"data.queuedArticleIndexes",[]),v.$apply(),n(!0);break;default:n(null)}})}function b(){v.tooltipApi=m,v.$watchGroup(["tooltipApi.article","tooltipApi.pdfUrl","tooltipApi.messageCount"],function(t){var e=a.get(t,"[0]"),n=a.get(t,"[1]");e&&n&&N.onDownloadRawPdf(e,n)})}function y(t){var e=N.articlesList[t];n.openDocumentInLibrary(e.collection_id,e.id)}function E(t){var e=N.articlesList[t];n.openItemInLibrary(e.id,e.collection_id),h.trackEvent(o.MIXPANEL_EVENT_INJECTED_BUTTON_IN_LIBRARY_CLICKED)}function A(){var t=!1,e=!1;return d.get(o.SETTING_BUTTON_AVAILABLE_ON,[o.VALUE_BUTTON_AVAILABLE_ON_GOOGLE_SCHOLAR,o.VALUE_BUTTON_AVAILABLE_ON_PUBMED,o.VALUE_BUTTON_AVAILABLE_ON_PUBLISHER_WEBSITES]).then(function(e){return t=e.indexOf(g)>-1,d.get(o.SETTING_PDF_DOWNLOAD,o.VALUE_PDF_DOWNLOAD_AUTOMATIC_ENABLED)}).then(function(t){e=t==o.VALUE_PDF_DOWNLOAD_AUTOMATIC_ENABLED;var n=w();return n.length?i.getStatusWithMetadata(n):[]}).then(function(n){n.forEach(function(n,i){var r=N.articlesList[i];r.extend({isReadyForShowing:r.metadata&&t,id:a.get(n,"id",null),note:n.notes,pdfUrl:n.pdfUrl,pdfHash:n.pdfHash,hasPdf:n.has_file,collections:n.collections,collection_id:n.collection_id,url:n.url}).setInLibraryStatus(n.status,e)})}).catch(function(e){return a.each(N.articlesList,function(e){e.isReadyForShowing=t}),console.error(e),!0}).finally(function(){var t=N.articlesList.filter(function(t){return t.isReadyForShowing});r.sendToBackground("browser_action.SetBadgeAndIcon",t.length)})}function w(){return a.map(N.articlesList,function(t){return t.getIdentifiers()})}function I(t){t.get().forEach(function(t){N.articlesList.push(new l(t))})}function T(t,e,n){var i=N.articlesList[e];c.toggleDropdown(t,e,i,n)}function L(t){c.hideDropdown();var e=N.articlesList[t],n="";switch(g){case o.VALUE_BUTTON_AVAILABLE_ON_GOOGLE_SCHOLAR:n="Google scholar";break;case o.VALUE_BUTTON_AVAILABLE_ON_PUBMED:n="Pubmed";break;default:n="Publisher sites"}return h.trackEvent(o.MIXPANEL_EVENT_INJECTED_BUTTON_ADD_TO_LIBRARY_CLICKED,{"Browser Ext Site Type":n}),!e.isProcessingStatus()&&(e.inLibraryStatus=o.STATUS_METADATA_ADDING,x(e,t).then(function(t){return S(e)}).finally(function(){N.updateStatusForArticle(e).then(function(){D(e).then(function(){chrome.runtime.sendMessage({message:o.MESSAGE_UPDATE_POPUP_ARTICLE_FROM_CONTENT_SCRIPT,data:{index:t,updateDetails:{id:e.id,inLibraryStatus:e.inLibraryStatus,collection_id:e.collection_id,collections:e.collections}}})})})}))}function R(t){var e=N.articlesList[t];return!e.isProcessingStatus()&&S(e).finally(function(){D(e)})}function P(t,n){var i=new e(t),r=t.pdfUrl,a=t.inLibraryStatus;return t.extend({pdfUrl:n,usingPdfUrl:n}),h.setProperty(o.MIXPANEL_PROPERTY_BROWSER_EXTENSION_LAST_SEEN,(new Date).toISOString()),i.upload().then(function(t){h.incrementProperty(o.MIXPANEL_PROPERTY_BROWSER_EXTENSION_PDF,1),h.trackEvent(o.MIXPANEL_EVENT_PDF_DOWNLOADED)}).catch(function(t){h.trackEvent(o.MIXPANEL_EVENT_PDF_DOWNLOAD_FAILED)}).finally(function(){t.pdfUrl=r,t.isPdfDownloadFailed()&&(t.inLibraryStatus=a)})}function S(e,n,i){return d.get(o.SETTING_PDF_DOWNLOAD,o.VALUE_PDF_DOWNLOAD_AUTOMATIC_ENABLED).then(function(n){return n!==o.VALUE_PDF_DOWNLOAD_AUTOMATIC_ENABLED?u.reject("Automatic PDF upload is not enabled"):(h.setProperty(o.MIXPANEL_PROPERTY_BROWSER_EXTENSION_LAST_SEEN,(new Date).toISOString()),e.inLibraryStatus=o.STATUS_PDF_DOWNLOADING,new t(e).upload(i).then(function(t){h.incrementProperty(o.MIXPANEL_PROPERTY_BROWSER_EXTENSION_PDF,1),h.trackEvent(o.MIXPANEL_EVENT_PDF_DOWNLOADED),a.extend(e,{inLibraryStatus:o.STATUS_IN_LIBRARY_WITH_PDF})}).catch(function(t){return h.trackEvent(o.MIXPANEL_EVENT_PDF_DOWNLOAD_FAILED),console.error(t),u.reject("PDF upload and resolve failed")}))})}function x(t,e,n){return void 0===n&&(n=!1),h.setProperty(o.MIXPANEL_PROPERTY_BROWSER_EXTENSION_LAST_SEEN,(new Date).toISOString()),r.sendToBackground("article.AddFromMetadata",{article:t.toJson(),index:e,includeNote:n}).then(function(n){return n.success?(t.extend(n.article),h.incrementProperty(o.MIXPANEL_PROPERTY_BROWSER_EXTENSION_IMPORTED,1),h.trackEvent(o.MIXPANEL_EVENT_METADATA_IMPORTED),n):n.status===s.UNAUTHORIZED?(N.loginIframe.show=!0,N.queuedArticleIndexes=[e],u.reject("User is not authorized")):u.reject(n)})}function O(t){N.loginIframe.show=!1,N.loadArticles().then(c.loadListOptions).then(N.addQueuedArticles).finally(function(){N.queuedArticleIndexes=[]}),p.setLoggedInUserDetails(t)}function U(){var t=[];return a.each(N.queuedArticleIndexes,function(e){N.articlesList[e].isInLibrary()||t.push(N.onAddToLibraryClick(e))}),u.all(t)}function D(t){return p.getInstitutionProxy().then(function(e){return t.finishProcessingStatus(!0),!0}).catch(function(){return t.finishProcessingStatus(!1),!1})}function C(t){h.trackEvent(o.MIXPANEL_EVENT_INJECTED_BUTTON_LIST_SELECTED),this.onAddToLibraryClick(t)}var N=this;N.articlesList=[],N.loginIframe={show:!1},N.queuedArticleIndexes=[],N.onInLibraryDocumentClick=y,N.onInLibraryClick=E,N.onTriangleClick=T,N.onAddToLibraryClick=L,N.onDownloadRawPdf=P,N.onDownloadPdfClick=R,N.onListClick=C,N.onSuccessfullyLoggedIn=O,N.addArticleFromPDF=S,N.addArticleFromMetadata=x,N.initArticles=I,N.loadArticles=A,N.listenForMessages=_,N.listenForTooltip=b,N.finishArticleStatus=D,N.addQueuedArticles=U,N.updateStatusForArticle=i.updateStatusForArticle.bind(i)}i.$inject=["ProxyUpload","RawUpload","BrowserTab","Article","Message","ListDropdownApi","$q","Storage","List","User","Mixpanel","SiteType","$scope","TooltipApi"];var r=n(2),o=n(0),a=n(1),s=n(11),l=n(15);r.module("App").controller("GeneralList",i)},function(t,e,n){function i(t,e){return{restrict:"A",template:n(48),scope:{buttonIndex:"@",buttonData:"=",isPopup:"=",whenAddToLibraryClick:"&",whenInLibraryClick:"&",whenInLibraryDocumentClick:"&",whenDownloadPdfClick:"&",whenTriangleClick:"&"},controller:["$scope",function(n){function i(t){d(t),h()&&o.isFunction(n.whenAddToLibraryClick)&&n.whenAddToLibraryClick({index:n.buttonIndex})}function r(t){d(t),h()&&o.isFunction(n.whenInLibraryClick)&&n.whenInLibraryClick({index:n.buttonIndex})}function s(t){d(t),h()&&o.isFunction(n.whenInLibraryDocumentClick)&&n.whenInLibraryDocumentClick({index:n.buttonIndex})}function l(t){d(t);var e="not_found"!=n.buttonData.inLibraryStatus;if(h())return o.isFunction(n.whenTriangleClick)&&n.whenTriangleClick({index:n.buttonIndex,event:t,isInLibrary:e}),!1}function c(t){d(t),h()&&o.isFunction(n.whenDownloadPdfClick)&&n.whenDownloadPdfClick({index:n.buttonIndex})}function u(t){d(t),h()&&(n.tooltipVisibility.visible=!0)}function d(t){t instanceof MouseEvent&&(t.preventDefault(),t.stopPropagation())}function f(){h(!1)&&(n.tooltipVisibility.visible=!0)}function p(){n.tooltipVisibility.visible=!1}function h(t){return void 0===t&&(t=!0),e.isOffline()?(n.tooltipVisibility.visible=!1,t&&(n.offlineTooltipVisibility.visible=!0)):n.offlineTooltipVisibility.visible=!1,e.isOnline()}n.onAddToLibraryClick=i,n.onInLibraryClick=r,n.onInLibraryDocumentClick=s,n.onTriangleClick=l,n.preventPropagation=d,n.onDownloadPdfClick=c,n.onShowTooltipClick=u,n.onMouseEnter=f,n.onMouseLeave=p,n.tooltipVisibility={visible:!1},n.offlineTooltipVisibility={visible:!1},n.online=navigator.onLine,n.$watch("buttonData.inLibraryStatus",function(e){e===a.STATUS_IN_LIBRARY_WITHOUT_PDF_EXPIRED_SUBSCRIPTION||e===a.STATUS_IN_LIBRARY_WITHOUT_PDF_NO_SUBSCRIPTION?t.get(a.STORAGE_KEY_DISPLAYED_GO_PRO_TOOLTIP,!1).then(function(e){e?n.tooltipVisibility.visible=!1:(t.set(a.STORAGE_KEY_DISPLAYED_GO_PRO_TOOLTIP,!0),n.tooltipVisibility.visible=!0)}):n.tooltipVisibility.visible=!1})}]}}i.$inject=["Storage","OnlineStatus"];var r=n(2),o=n(1),a=n(0);r.module("App").directive("addToLibraryButton",i)},function(t,e,n){function i(t,e,i,r,f,p,h,g){return{restrict:"A",template:n(49),scope:{isBelowButton:"=?",selectedListName:"=?",whenListClick:"&",onAddToLibraryClick:"&",isAnySelected:"=?"},link:function(n,v,m){function _(){o.isFunction(n.onAddToLibraryClick)&&n.onAddToLibraryClick({index:n.api.index})}function b(t,e){t.stopPropagation(),t.preventDefault();var r=n.api.article,o=w(e,r);i.openItemInLibrary(o,e)}function y(t,e){if(e){var i=o.flatten(o.values(n.selectedItems));return o.includes(i,e)}return o.has(n.selectedItems,t)}function E(t){o.each(n.options.groups,function(e){o.each(e.collections,function(e){e._imported=o.some(t.collections,function(t){return e.collection_id==t.id}),o.each(e.lists,function(e){e._imported=o.some(e.item_ids,function(e){return o.some(t.collections,{item_id:e})})})})})}function A(t,e){return!t&&e?o.has(n.selectedItems,e)?delete n.selectedItems[e]:n.selectedItems[e]=[]:o.has(n.selectedItems,e)?o.includes(n.selectedItems[e],t)?o.pull(n.selectedItems[e],t):n.selectedItems[e].push(t):n.selectedItems[e]=[t],n.isAnySelected=!o.isEmpty(n.selectedItems),f.set({selectedItems:n.selectedItems}),!1}function w(t,e){var n=o.find(e.collections,{id:t});return o.get(n,"item_id")}function I(t,e,n){if(1==n){var i=s(c.URL_COLLECTION_IMPORT_FROM_COLLECTION,e.collection_id);return l.post(i,{from_collection_id:t.collection_id,item_ids:[t.id],annotations:!1}).then(function(n){return T(t,e,n),!0})}var r=w(e.collection_id,t),o=s(c.URL_REMOVE_FROM_COLLECTION,e.collection_id,r);return l.delete(o)}function T(t,e,n){var i=o.get(n,"data.items[0]");if(e.collection_id==i.collection_id){o.some(t.collections,{id:e.collection_id})||t.collections.push({id:i.collection_id,item_id:i.id,name:e.name,shared:e.shared})}}function L(t,e,n,i){if(1==i){var r=w(e.collection_id,t);if(r)return l.post(s(c.URL_ADD_TO_COLLECTION_LIST,e.collection_id,n.id),{item_ids:[r]}).then(function(t){R(o.get(t,"data.list"))});var a=s(c.URL_COLLECTION_IMPORT_FROM_COLLECTION,e.collection_id);return l.post(a,{from_collection_id:t.collection_id,item_ids:[t.id],annotations:!1}).then(function(i){if(i.status==d.OK){T(t,e,i);var r=o.get(i,"data.items[0].id");return e._imported=!0,l.post(s(c.URL_ADD_TO_COLLECTION_LIST,e.collection_id,n.id),{item_ids:[r]}).then(function(t){R(o.get(t,"data.list"))})}})}var r=w(e.collection_id,t);return l.post(s(c.URL_REMOVE_FROM_COLLECTION_LIST,e.collection_id,n.id),{item_ids:[r]}).then(function(t){R(o.get(t,"data.list"))})}function R(t){if(t){var e=o.find(o.flatMap(n.options.groups,"collections"),{collection_id:t.collection_id}),i=o.find(e.lists,{id:t.id});i.item_ids=t.item_ids,i.items=t.items}}function P(t){o.each(t.groups,function(t){o.each(t.collections,function(t){t._selected=y(t.collection_id,null),Object.defineProperty(t,"selected",{get:function(){return n.api.isInLibrary?t._imported:t._selected},set:function(e){n.api.isInLibrary?(t.disabled=!0,I(n.api.article,t,e).then(function(){return t._imported=e,t.disabled=!1,o.each(t.lists,function(t){t._imported=!1}),n.$apply(),a.delay(1e3).then(function(){return r.updateStatusForArticle.bind(r,n.api.article)()})}).finally(function(){t.disabled=!1})):(t._selected=e,0==e&&o.each(t.lists,function(t){1==t.selected&&(t.selected=!1)}),A(null,t.collection_id))}}),o.each(t.lists,function(e){e._selected=y(t.collection_id,e.id),Object.defineProperty(e,"selected",{get:function(){return n.api.isInLibrary?e._imported:e._selected},set:function(i){n.api.isInLibrary?(e.disabled=!0,t.disabled=!0,L(n.api.article,t,e,i).then(function(){return e._imported=i,e.disabled=!1,t.disabled=!1,n.$apply(),a.delay(1e3).then(function(){return r.updateStatusForArticle.bind(r,n.api.article)()})}).finally(function(){t.disabled=!1,e.disabled=!1})):(e._selected=i,0==t.selected&&1==i&&(t.selected=!0),t.selected&&(A(e.id,t.collection_id),o.every(t.lists,{selected:!1})&&(t.selected=!1)))}})})})})}function S(t){var e=N();return o.chain(t).keys().every(o.partial(o.has,e)).value()}function x(){return f.get("selectedItems",{}).then(function(t){if(o.isEmpty(n.options))n.selectedItems=t;else if(o.isEmpty(t)||o.has(t,"0")||!S(t)){var e=o.chain(n.options).get("groups",[]).find(function(t){return null==t.group_id||"null"==t.group_id}).get("collections[0]",null).value();if(e){e.selected=!0;var i=e.collection_id;n.selectedItems={},n.selectedItems[i]=[],f.set({selectedItems:n.selectedItems})}}else n.selectedItems=t;return!0})}function O(t){var e=o.chain(t.groups).flatMap("collections").keyBy("collection_id").value(),i=[];o.each(n.selectedItems,function(t,r){var a=e[r];if(a){var s=o.filter(t,function(t){return o.some(a.lists,{id:t})});n.selectedItems[r]=s}else i.push(r)}),o.each(i,function(t){delete n.selectedItems[t]})}function U(){return t.queryStorage().then(function(t){return P(t),n.options=t,!0}).catch(function(t){return console.error(t),!0}).then(function(){return t.queryFlat()}).then(function(t){return o.isEqual(t,n.options)||(f.set({lists:t}),O(t),P(t),n.options=t),n.selectedListName=k(),x()}).catch(function(t){t.status==d.UNAUTHORIZED&&(f.set({lists:null}),n.options={groups:[{group_id:null,collections:[{name:c.DEFAULT_PERSONAL_LIBRARY_NAME,collection_id:"0",lists:[],selected:!0}]}]},n.selectedItems={0:[]})})}function D(){return n.options&&n.options.groups&&n.options.groups.length>1}function C(t){var e=t.offset(),i=t.width(),r=e.left,o=e.top,a=u("#readcube-injected-button-dropdown");if(a.length){var s=a.offsetParent().offset();r-=s.left,o-=s.top}var l=r+i/2-70+"px";if(n.isBelowButton)n.triangleStyle={left:l,top:o+23+"px"},n.boxStyle={left:l,top:o+20+"px"};else{var c=h[0].body.clientHeight;n.triangleStyle={left:l,bottom:c-o+10+"px"},n.boxStyle={left:l,bottom:c-o+15+"px"}}}function N(){return o.chain(n.options.groups).flatMap("collections").keyBy("collection_id").value()}function k(){var t=N();return o.chain(n.selectedItems).toPairs().reduce(function(e,n){var i=n[0],r=n[1],a=t[i];if(a){var s=o.reduce(a.lists,function(t,e){return o.includes(r,e.id)?t.concat(e.name):t},[]);return o.isEmpty(s)?e.concat(a.name):e.concat(s)}return e},[]).join(", ").value()}function j(t){o.some(H,function(e){return t.target.className.indexOf(e)>-1})||n.$apply(function(){n.api.hideDropdown()})}var B=null;n.options={},p.loadListOptions=U,n.shouldDisplayAddButton=m.shouldDisplayAddButton||!1,n.api=p,n.hasMultipleCollections=D,n.selectedItems={},x().then(U).then(x),n.addToLibrary=_,n.onClickOpenArrow=b,e.listenForMessages(function(t,e){switch(t.message){case c.MESSAGE_UPDATE_LISTS:var n=o.map(o.get(t,"data.lists",[]),"data.list",[]);o.each(n,R);break;default:e(null)}});var M=o.debounce(function(){n.show&&B&&(C(B),n.$apply())},200);h.on("click",j),u(g).on("resize",M),n.$on("$destroy",function(){h.off("click",j),u(g).off("resize",M)}),n.$watch("api.show",function(){var t=n.api.event;n.shouldDisplayAddButton=!n.api.isInLibrary,n.shouldDisplayAddButton||E(n.api.article),t&&n.api.show?(B=u("caret"==t.target.className?t.target.parentElement:t.target),C(B),n.show=!0):(n.show=!1,B=null)}),n.$watch("selectedItems",function(){o.isEmpty(n.options)||(n.selectedListName=k()),f.set({selectedItems:n.selectedItems})},!0);var H=["dropdown-menu","dropdown-group-name","dropdown-group-list","dropdown-collection-header"]}}}i.$inject=["List","Message","BrowserTab","Article","Storage","ListDropdownApi","$document","$window"];var r=n(2),o=n(1),a=n(8),s=n(5).sprintf,l=n(7),c=n(0),u=n(4),d=n(11);r.module("App").directive("listDropdown",i)},function(t,e,n){function i(t){return{restrict:"A",template:n(50),scope:{show:"=",whenSuccessfullyLoggedIn:"&"},link:function(e,n,i){function r(){e.show=!1}e.iframeUrl=a.URL_LOGIN_FORM,e.onCloseButtonClick=r,e.$watch("show",function(){var n=t.document;s(n.body).add(n.documentElement).toggleClass("readcube-iframe-displayed",e.show)}),t.addEventListener("message",function(t){if(!o.get(t,"origin","").match(a.URL_REGEXP_MAIN_URL))return!1;var n=t.data;"auth:success"!==n.type||"login"!==n.auth&&"register"!==n.auth||(e.whenSuccessfullyLoggedIn({userData:n.user}),e.$apply())})}}}i.$inject=["$window"];var r=n(2),o=n(1),a=n(0),s=n(4);n(5).sprintf,n(74);r.module("App").directive("loginIframe",i)},function(t,e,n){function i(){return{restrict:"A",template:n(51),scope:{buttonData:"="},controller:["$scope",function(t){function e(){var e=t.buttonData.collections;return!!e&&e.some(function(t){return t.shared})}function n(){var e=t.buttonData.collections;if(e){return e.map(function(t){return t.name||"Personal"}).join(", ")}return""}t.isInSharedLibrary=e,t.sharedLibrariesTooltip=n}]}}var r=n(2);n(1),n(0);r.module("App").directive("sharedLibraryIcon",i)},function(t,e,n){function i(){return function(t){return o.isString(t)?a.parse(t).hostname:""}}var r=n(2),o=n(1),a=n(9);r.module("App").filter("hostname",i)},function(t,e,n){function i(t,e){return{responseError:function(n){return-1!==s.get(n,"config.url","").indexOf(o.DOMAIN_READCUBE)&&n.status==a.UNAUTHORIZED&&t.set({loggedInUserDetails:null}),e.reject(n)}}}i.$inject=["Storage","$q"];var r=n(2),o=n(0),a=n(11),s=n(1);r.module("App").factory("ClearUserDataInterceptor",i).config(["$httpProvider",function(t){t.interceptors.push("ClearUserDataInterceptor")}])},function(t,e,n){function i(){return{show:!1,isInLibrary:!1,index:null,event:null,article:null,showDropdown:function(t,e,n,i){this.event=t,this.show=!0,this.index=e,this.isInLibrary=i,this.article=n},hideDropdown:function(){this.event=null,this.show=!1,this.index=null},toggleDropdown:function(t,e,n,i){this.show?this.hideDropdown():this.showDropdown(t,e,n,i)},loadListOptions:function(){}}}n(2).module("App").factory("ListDropdownApi",i)},function(t,e,n){function i(t,e,n,i,r){function d(){return a.get("loggedInUserDetails",null).then(function(t){return a.get("selectedItems",{}).then(function(e){return{userId:c.get(t,"id",null),selectedItems:e}})})}return u(n,{upload:function(e){var n=this;n.article.extend({progressPercent:0,progressType:o.PROGRESS_DOWNLOAD,usingPdfUrl:n.article.pdfUrl});var i;return t.when(function(){return n.article.pdfUrl?(i=n.article.pdfUrl,n.getProxiedDownloadPromise(n.article.pdfUrl)):t.reject("Pdf url not available")}()).catch(function(e){function o(){return n.article.doi?r.sendToBackground("request.GetPdfUrlsFromDxDoi",n.article.doi).then(function(e){var r=c.get(e,"[0]",null);return r?(n.article.extend({progressPercent:0,usingPdfUrl:r}),i=r,n.getProxiedDownloadPromise(r)):t.reject("Unable to find PDF url from dx.doi.org resolve")}):t.reject(e)}return n.article.parsedPdfUrl?(i=n.article.parsedPdfUrl,n.getProxiedDownloadPromise(n.article.parsedPdfUrl).catch(function(t){return o()})):o()}).then(function(r){var a=n.fixPdfFilename(r.fileName);return d().then(function(t){var u=c.keys(t.selectedItems),d="";return i&&i.length&&(d=encodeURIComponent(i.substring(0,500))),c.map(u,function(t){var i=s(o.URL_UPLOAD,t,"false",r.sha256Hash,n.article.doi?n.article.doi:"",n.article.pmid?n.article.pmid:"",r.fileSize,(e?e[t]:null)||n.article.id||"",encodeURIComponent(a),d);return l.get(i)})}).then(function(e){return t.all(e).then(function(e){return t.all(c.map(e,function(e,i){var a=c.get(e,"data.url",null);return a?(0==i&&(n.article.progressPercent=0,n.article.progressType=o.PROGRESS_UPLOAD),n.getUploadPromise(a,r.blob).then(null,null,function(t){n.article.progressPercent=t})):t.reject("Url not received from preparing to upload")}))})})}).catch(function(t){return n.evaluateUploadError(t)})},getProxiedDownloadPromise:function(t){var n=this;return n.getDownloadPromise({url:t,isProxied:!1}).catch(function(){return e.getInstitutionProxy().then(function(e){var i=e.replace(o.EZPROXY_URL_REPLACE_KEY,t);return n.article.progressPercent=0,n.getDownloadPromise({url:i,isProxied:!0})})})}})}i.$inject=["$q","User","Upload","$http","Message"];var r=n(2),o=n(0),a=n(26),s=n(5).sprintf,l=n(7),c=n(1),u=n(3);r.module("App").factory("ProxyUpload",i)},,function(t,e,n){var i=n(3);t.exports=i({insertAngularDirectives:function(){},bootstrapAngular:function(){},get:function(){},getPlain:function(){},getIdentifiers:function(t){},getMetadata:function(t){},getArticleHolders:function(){},isAbstractPage:function(){},getButtonHolder:function(t){},insertButtons:function(){},getAngularInjector:function(t,e){},getExecutePromise:function(){},getDoiFromElement:function(t){}})},,,function(t,e,n){"use strict";var i=["lastName","nondropped","dropped","firstName","middle","suffix"];Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e,n){"use strict";function i(t){var e={},n=o.default(t);if(0==n.length)return e;var i=new s.default(0,n.length);if(n.length>1){e.suffix=l.tryGetSuffix(n[n.length-1]),e.suffix&&i.length--;var r=i.length-1;if(r>0){r>2&&(r=2);var a=new s.default(0,r),c=a.sliceArray(n),u=l.particlesRangeInTokens(c,!0);if(0==u.location){i.location+=u.length,i.length-=u.length;var d=u.sliceArray(n);f=l.splitParticleParts(d),e.dropped=f[0],e.nondropped=f[1]}}}return null!=i.location&&(e.lastName=i.sliceArray(n).map(function(t){return"{"==t[0]?t.substring(1):t}).join(" ")),e;var f}function r(t){var e={},n=t.split(","),r=i(n[0]);e.lastName=r.lastName,e.dropped=r.dropped,e.nondropped=r.nondropped,e.suffix=r.suffix;var c=n.length;if(c>1){var u=1;!e.suffix&&c>2&&(e.suffix=l.tryGetSuffix(n[1].trim()),e.suffix&&(u=2));var d=new s.default(u,c-u),f=d.sliceArray(n),p=f.reduce(function(t,e){return t.concat(o.default(e))},[]);h=l.firstAndMiddleFromTokens(p),e.firstName=h[0],e.middle=h[1]}return e.nameString=a.default(e),e;var h}var o=n(28),a=n(27),s=n(17),l=n(18);Object.defineProperty(e,"__esModule",{value:!0}),e.default=r},function(t,e,n){"use strict";function i(t){var e={},n=r.default(t);if(n.length>1){var i=n[n.length-1];e.suffix=s.tryGetSuffix(i)}var l=n.length;e.suffix&&l--,n.length>0&&l--;var c=n.slice(0,l),u=s.particlesRangeInTokens(c),d=new o.default;u.notFound()?(n.length>0&&(d=new o.default(n.length-1,1),e.suffix&&d.location--),u=new o.default(d.location,0)):(d.location=u.maxRange(),d.length=n.length-d.location,e.suffix&&d.length--),n=n.map(function(t){return"{"==t[0]?t.substring(1):t});var f=new o.default(0,u.location),p=f.sliceArray(n);if(v=s.firstAndMiddleFromTokens(p),e.firstName=v[0],e.middle=v[1],u.length>0){var h=u.sliceArray(n);m=s.splitParticleParts(h),e.dropped=m[0],e.nondropped=m[1]}if(1==d.length&&void 0!==d.location)e.lastName=n[d.location];else if(d.length>1){var g=d.sliceArray(n);e.lastName=g.join(" ")}return e.nameString=a.default(e),e;var v,m}var r=n(28),o=n(17),a=n(27),s=n(18);Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e,n){"use strict";function i(t){if(!t)throw"Invalid value";return t.indexOf(",")>-1?o.default(t):r.default(t)}var r=n(77),o=n(76),a=n(18);e.fullnameForAuthor=a.fullnameForAuthor,Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e,n){"use strict";var i={al:["al",""],dos:["dos",""],el:["el",""],"de las":["de","Las"],lo:["lo",""],les:["les",""],il:["il",""],del:["","del"],dela:["dela",""],della:["della",""],dello:["dello",""],di:["","Di"],da:["","Da"],do:["","Do"],lou:["","Lou"],pietro:["","Pietro"],de:["","de"],"de la":["de","La"],du:["du",""],"d'":["d'",""],le:["","Le"],la:["","La"],"l'":["","L'"],saint:["","Saint"],sainte:["","Sainte"],"st.":["","Saint"],"ste.":["","Sainte"],van:["","van"],"van de":["","van de"],"van der":["","van der"],"van den":["","van den"],vander:["","vander"],"v.d.":["","vander"],vd:["","vander"],"van het":["","van het"],ver:["","ver"],ten:["ten",""],ter:["ter",""],te:["te",""],"op de":["op de",""],"in de":["in de",""],"in 't":["in 't",""],"in het":["in het",""],"uit de":["uit de",""],"uit den":["uit den",""],von:["von",""],"von der":["von der",""],"von dem":["von dem",""],"von zu":["von zu",""],"v.":["von",""],v:["von",""],vom:["vom",""],das:["das",""],zum:["zum",""],zur:["zur",""],den:["den",""],der:["der",""],des:["des",""],"auf den":["auf den",""],mac:["","Mac"],mc:["","Mc"],"o'":["","O'"],ben:["","Ben"],bin:["","Bin"],sen:["sen",""]};Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e,n){var i=n(2);n(142),n(73),i.module("App",["ngAnimate"]).constant("PublisherIds",n(132)),function(t){t.keys().forEach(t)}(n(160)),n(32),n(62),n(66),n(63),n(35),n(64),n(65),n(33),n(34),n(44),n(69),n(68),n(36),n(23),n(37),n(71),n(22),n(39),n(38),n(40),n(24),n(41),n(43),n(70),n(42),n(61),n(60),n(21),n(67),t.exports=i.module("App")},,function(t,e,n){var i=n(0),r=n(12),o=n(1),a=n(4),s=(n(8),n(3)),l=n(10),c=s(l,{getButtonHolder:function(t){return t},getArticleHolders:function(){return a("."+i.THIRD_PARTY_HOOK_CLASSNAME)},getIdentifiers:function(t){var e=o.get(t.get(0),"dataset",{});return{pmid:e.pmid,gsid:null,doi:e.doi,parsedPdfUrl:e.pdfUrl}},getMetadata:function(t){var e=o.get(t.get(0),"dataset",{});if(!e.title)return null;var n="";e.year&&(n=o.get(e.year.match(i.REGEXP_YEAR),"0",""));var a=[];return e.authors&&(a=r.splitAuthorString(e.authors)),{title:e.title,authors:a,journal:e.journal,year:n}},isAbstractPage:function(){return 1==this.getArticleHolders().length}});t.exports=new c},function(t,e,n){var i=n(4),r=n(1),o=n(10),a=n(12),s=n(0),l=n(3),c=l(o,{getButtonHolder:function(t){return t},getArticleHolders:function(){var t=i(".highwire-cite.highwire-cite-highwire-article.highwire-citation-genetics-article-title-complete");return t.length>0?(t.splice(1,t.length-1),t):i(".highwire-cite.highwire-cite-highwire-article")},getIdentifiers:function(t){var e=t.find(".highwire-cite-metadata-doi"),n=t.find(".highwire-cite-metadata-epubdate");return{pmid:null,gsid:null,doi:this.getDoiFromElement(e.length?e:n)}},getMetadata:function(t){return{title:t.find(".highwire-cite-title").text(),authors:a.splitAuthorString(t.find(".highwire-citation-authors").text()),journal:t.find(".highwire-cite-metadata-journal-title").text().trim(),year:r.get(t.find(".highwire-cite-metadata-epubdate").text().match(s.REGEXP_YEAR),"0","")}},isAbstractPage:function(){return 1===this.getArticleHolders().length}});t.exports=new c},function(t,e,n){var i=n(4),r=n(1),o=n(10),a=n(12),s=n(0),l=n(3),c=l(o,{getButtonHolder:function(t){return t.find(".artgal")},getArticleHolders:function(){return i(".article")},getIdentifiers:function(t){var e=t.find(".altmetric-embed").attr("data-doi"),n=t.find('.artgal span a[href$="pdf"]').get(0);return{pmid:null,gsid:null,doi:r.get(e.match(s.REGEXP_DOI),"[0]",null),parsedPdfUrl:n?n.href:null}},getMetadata:function(t){var e=t.find(".artautho").text();return e&&(e=e.replace(/\s\s/g," ")),{title:t.find(".artitle").text(),authors:a.splitAuthorString(e)}},isAbstractPage:function(){return!1}});t.exports=new c},function(t,e,n){var i=n(4),r=n(1),o=n(10),a=n(12),s=n(0),l=n(3),c=l(o,{getButtonHolder:function(t){return t.find(".tocGalleys")},getArticleHolders:function(){return i(".tocArticle")},getIdentifiers:function(t){var e=t.find('tr > td > p > strong > a[href*="dx.doi"]').text(),n=t.find('.tocGalleys a.file:contains("PDF")').get(0);return{pmid:null,gsid:null,doi:r.get(e.match(s.REGEXP_DOI),"[0]",null),parsedPdfUrl:n?n.href:null}},getMetadata:function(t){var e=t.find(".tocAuthors > span").toArray().map(function(t){return t.innerText}).join(" ").replace(/\s\s/g," ");return{title:t.find(".tocTitle").text(),authors:a.splitAuthorString(e)}},isAbstractPage:function(){return!1}});t.exports=new c},function(t,e,n){var i=n(4),r=n(1),o=n(10),a=n(12),s=n(0),l=n(3),c=l(o,{getButtonHolder:function(t){return i('<div class="readcube-iop"/>').appendTo(t.find(".art-list-item-tools.small"))},getArticleHolders:function(){return i(".art-list-item")},getIdentifiers:function(t){var e=t.find(".art-list-item-title").attr("href");return{pmid:null,gsid:null,doi:r.get(e.match(s.REGEXP_DOI),"[0]",null)}},getMetadata:function(t){return{title:t.find(".art-list-item-title").text().trim(),authors:a.splitAuthorString(t.find(".small.art-list-item-meta").text()),journal:"",year:""}},isAbstractPage:function(){return!1}});t.exports=new c},function(t,e,n){var i=n(4),r=n(1),o=n(9),a=n(10),s=n(3),l=s(a,{getButtonHolder:function(t){return t.find('div:has([href*="contentID"]):last')},getArticleHolders:function(){return i('section ol.clean-list > li:has([href*="contentID"])')},getMetadata:function(t){var e=this.getDataUrlPartial(t),n=r.map(t.find('.js-list-authors-3 li[itemprop="creator"]'),function(t){return i(t).contents().filter(function(){return this.nodeType==Node.TEXT_NODE}).text()});return{title:e("title",""),authors:n,journal:e("publication",""),year:r.chain(e("publicationDate","")).thru(function(t){return t.split("-")}).get("0","").value()}},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:this.getDataUrlPartial(t)("contentID",null)}},getDataUrlPartial:function(t){var e=t.find('a[href*="s100.copyright.com/AppDispatchServlet"]').attr("href"),n=null;return e&&(n=o.parse(e,!0).query),r.partial(r.get,n)},isAbstractPage:function(){return!1}});t.exports=new l},function(t,e,n){var i=n(4),r=n(10),o=n(1),a=n(12),s=n(0),o=n(1),l=n(3),c=l(r,{getButtonHolder:function(t){return t.find(".links")},getArticleHolders:function(){return i(".container > div")},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:this.getDoiFromElement(t.find(".journal"))}},getMetadata:function(t){return{title:t.find(".atl").clone().children().remove(".free").remove(".open-access").end().text(),authors:a.splitAuthorString(t.find(".aug").text()),journal:t.find(".journal").text().match(/(.*?)\d/)[1].trim(),year:o.get(t.find(".journal").text().match(s.REGEXP_YEAR),"0","")}},isAbstractPage:function(){return!1}});t.exports=new c},function(t,e,n){var i=n(4),r=n(10),o=n(12),a=n(1),s=n(0),l=n(3),c=l(r,{getButtonHolder:function(t){return t.find(".highwire-article-citation-variant-list")},getArticleHolders:function(){return i(".toc-citation")},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:this.getDoiFromElement(t.find(".highwire-cite-doi"))}},getMetadata:function(t){return{title:t.find(".highwire-cite-title").text(),authors:o.getAuthorsArray(t.find(".highwire-citation-authors").text()),journal:t.find(".highwire-cite-journal").text(),year:a.get(t.find(".highwire-cite-year").text().match(s.REGEXP_YEAR),"0","")}},isAbstractPage:function(){return!1}});t.exports=new c},function(t,e,n){var i=n(4),r=n(10),o=n(12),a=n(1),s=n(0),l=n(3),c=l(r,{getButtonHolder:function(t){return t.find(".cit-metadata cite")},getArticleHolders:function(){return i(".cit-list > li")},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:this.getDoiFromElement(t.find(".cit-doi"))}},getMetadata:function(t){return{title:t.find(".cit-title-group").text(),authors:o.getAuthorsArray(t.find(".cit-auth-list").text()),journal:t.find("cite abbr").attr("title"),year:a.get(t.find(".cit-print-date").text().match(s.REGEXP_YEAR),"0","")}},isAbstractPage:function(){return!1}});t.exports=new c},function(t,e,n){var i=n(4),r=n(10),o=n(1),a=n(0),s=n(3),l=s(r,{getButtonHolder:function(t){return t.find(".highwire-cite-detail-wrapper")},getArticleHolders:function(){return i(".highwire-search-results-list > li")},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:this.getDoiFromElement(t.find(".highwire-cite-doi"))}},getMetadata:function(t){var e=t.find(".highwire-citation-author").toArray(),n=e.map(function(t){return t.innerText});return{title:t.find(".highwire-cite-title").text(),authors:n,year:o.get(t.find(".highwire-cite-year").text().match(a.REGEXP_YEAR),"0","")}},isAbstractPage:function(){return!1}});t.exports=new l},function(t,e,n){var i=n(4),r=n(1),o=n(10),a=n(0),s=n(3),l=s(o,{getButtonHolder:function(t){return t.find('div:has(".subLink")')},getArticleHolders:function(){return i('.article table tbody tr td:has(".articleHeadline")')},getIdentifiers:function(t){var e=t.find('.browse_button[onclick*="PDF"]').attr("onclick"),n=null;if(e){var i=r.get(e.match(/\d+/),"[0]",null);if(i){var o="/lib/ajax_srv/article_elements_srv.php?action=download_pdf&item_id="+i;if(o){var a=document.createElement("a");a.href=o,n=a.href}}}return{pmid:null,gsid:null,doi:this.getDoiFromElement(t.find(".subLink")),parsedPdfUrl:n}},getMetadata:function(t){var e=t.find("a.authors_list_holder").toArray().map(function(t){return t.innerText}),n=t.find('img[alt="Calendar"]').parent().text();return{title:t.find(".articleHeadline a").text(),authors:e,year:r.get(n.match(a.REGEXP_YEAR),"0","")}},isAbstractPage:function(){return!1}});t.exports=new l},function(t,e,n){var i=n(4),r=n(1),o=n(10),a=n(12),s=n(3),l=s(o,{getButtonHolder:function(t){return t.find(".authors")},getArticleHolders:function(){return i(".item.cf")},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:this.getDoiFromElement(t.find(".article-info a"))}},getMetadata:function(t){var e=t.find(".article-info").text(),n=e.replace(/\n/," ").match(/published.*,\s(\d{4})\s\|/);return{title:t.find("h3").text(),authors:a.getAuthorsArray(t.find(".authors").text()),journal:r.trimEnd(t.find(".article-info b").text(),":"),year:r.get(n,"[1]","0")}},isAbstractPage:function(){return!1}});t.exports=new l},function(t,e,n){var i=n(4),r=n(10),o=n(12),a=n(1),s=n(3),l=s(r,{getButtonHolder:function(t){return t.find(".red_txt_s4")},getArticleHolders:function(){return i(".grey_box_wrapper")},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:this.getDoiFromElement(t.find(".grey_left_box_text_s4_new"))}},getPlain:function(){return[{doi:!0}]},getMetadata:function(t){var e=function(t){return t&&t.trim()||""};return{title:e(t.find("h2.title_text_s4_jrnls").text()),authors:o.splitAuthorString(t.find(".red_txt_s4").text()),journal:t.find(".grey_left_box_text_s4_new em").text(),year:e(t.find(".grey_left_box_text_s4_new").text().split(",")[1])}},getExecutePromise:function(){var t=this;return this.getAngularInjector(function(e){var n=e.defer(),i=t.getArticleHolders(),r=new MutationObserver(function(){i.length&&(r.disconnect(),n.resolve())});return r.observe(document.body,{childList:!0,subtree:!0}),a.delay(function(){r.disconnect(),0==t.getArticleHolders().length?n.reject("DOI param wasn't loaded after 6 seconds"):n.resolve("DOI found, but not from mutation observer")},6e3),n.promise},["$q"])},isAbstractPage:function(){return!1}});t.exports=new l},function(t,e,n){var i=n(4),r=(n(1),n(10)),o=n(12),a=(n(0),n(3)),s=a(r,{getButtonHolder:function(t){return i('<span class="readcube-ucpress"/>').appendTo(t)},getArticleHolders:function(){return i(".highwire-article-citation:not(.panels-ajax-tab-container .highwire-article-citation)")},getIdentifiers:function(t){var e=t.find(".highwire-cite-metadata-doi");return{pmid:null,gsid:null,doi:this.getDoiFromElement(e)}},getMetadata:function(t){return{title:t.find(".highwire-cite-title").text(),authors:o.splitAuthorString(t.find(".highwire-citation-authors").text()),journal:"",year:""}},isAbstractPage:function(){return!1}});t.exports=new s},function(t,e,n){var i=n(4),r=n(1),o=n(0),a=n(9),s=n(12),l=n(10),c=n(3),u=c(l,{getButtonHolder:function(t){var e=i("<li/>");return e.appendTo(t.find("ul.productMenu")),e},getArticleHolders:function(){return i(i("#issueTocGroups").length?"#issueTocGroups ol.articles>li":"#searchResultsList ol.articles>li")},getMetadata:function(t){var e=this.getDataUrlPartial(t);if(e){var n=t.find(".citation.tocArticle > a").text();return{title:r.get(n.match(/(.+?)(?:\s\(pages?.+\)$|$)/),"1",""),authors:s.getAuthorsArray(e("author","")),journal:e("publication",""),year:r.chain(e("publicationDate","")).thru(function(t){return t.split(" ")}).get("2","").value()}}return{title:t.find(".citation >a:first").text(),authors:[],journal:"",year:r.get(t.find(".citation p").text().match(o.REGEXP_YEAR),"0","")}},getIdentifiers:function(t){var e,n=this.getDataUrlPartial(t);return e=n?n("contentID",null):r.get(t.find(".citation p").text().match(o.REGEXP_DOI),"0",null),{pmid:null,gsid:null,doi:e}},getDataUrlPartial:function(t){var e=t.find(".rightsLink").attr("href");return e?r.partial(r.get,a.parse(e,!0).query):null},isAbstractPage:function(){return!1}});t.exports=new u},function(t,e,n){var i=n(4),r=n(9),o=n(1),a=n(0),s=n(10),l=n(12),c=n(3),u=c(s,{getButtonHolder:function(t){var e=i("<li/>");return e.appendTo(t.find("ul.productMenu")),e},getArticleHolders:function(){return i("ol > li > ol.articles > li")},getMetadata:function(t){var e=this.getDataUrlPartial(t);return e?{title:e("title",""),authors:l.getAuthorsArray(e("author","")),journal:e("publication",""),year:o.chain(e("publicationDate","")).thru(function(t){return t.split(" ")}).get("2","").value()}:{title:t.find(".citation >a:first").text(),authors:[],journal:"",year:o.get(t.find(".citation p").text().match(a.REGEXP_YEAR),"0","")}},getIdentifiers:function(t){var e,n=this.getDataUrlPartial(t);return e=n?n("contentID",null):o.get(t.find(".citation p").text().match(a.REGEXP_DOI),"0",null),{pmid:null,gsid:null,doi:e}},getDataUrlPartial:function(t){var e=t.find(".rightsLink").attr("href");return e?o.partial(o.get,r.parse(e,!0).query):null},isAbstractPage:function(){return!1}});t.exports=new u},function(t,e,n){var i=n(4),r=n(6),o=n(3),a=n(1),s=n(5).sprintf,l=o(r,{getButtonHolder:function(t){return t.find(".doi>a:first")},insertButtons:function(){var t=n(59);a.each(this.getArticleHolders(),function(e,n){var r=s(t,n),o=this.getButtonHolder(i(e));i(r).insertAfter(o)}.bind(this))},getArticleHolders:function(){return i("#article")},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:this.getDoiFromElement(t.find(".doi a:first"))}}});t.exports=new l},function(t,e,n){var i=n(4),r=n(6),o=n(3),a=o(r,{getButtonHolder:function(t){return t.find(".elife-doi-doi:first")},getArticleHolders:function(){return i("#zone-content")},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:this.getDoiFromElement(t.find(".elife-doi-doi a"))}}});t.exports=new a},function(t,e,n){var i=n(4),r=n(6),o=n(3),a=n(1),s=o(r,{getButtonHolder:function(t){return t.find(".content-node.cover .doi")},getArticleHolders:function(){return i("body>#container")},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:t.find(".content-node.cover .doi:first a").text()}},getExecutePromise:function(){var t=this;return this.getAngularInjector(function(e){var n=t.getArticleHolders(),i=e.defer(),r=new MutationObserver(function(){n.find(".content-node.cover .doi").length&&(r.disconnect(),i.resolve())});return r.observe(n.get(0),{childList:!0,subtree:!0}),a.delay(function(){r.disconnect(),0==n.find(".content-node.cover .doi").length?i.reject("DOI param wasn't loaded after 6 seconds"):i.resolve("DOI found, but not from mutation observer")},6e3),i.promise},["$q"])}});t.exports=new s},function(t,e,n){var i=n(4),r=n(6),o=n(3),a=o(r,{getButtonHolder:function(t){return t.find(".highwire-cite.cite-js")},getArticleHolders:function(){return i(".main-content-wrapper")},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:this.getDoiFromElement(t.find(".highwire-cite-metadata-doi"))}}});t.exports=new a},function(t,e,n){var i=n(4),r=n(6),o=n(3),a=n(0),s=n(1),l=o(r,{getButtonHolder:function(t){return t.find(".metaData")},getArticleHolders:function(){return i("html")},getIdentifiers:function(t){var e=t.find(".metaData > .abs_nonlink_metadata").toArray(),n=s.find(e,function(t){return t.innerText.match(a.REGEXP_DOI)}),i=s.get(n,"innerText",null);return{pmid:t.find("meta[name=citation_pmid]").attr("content"),gsid:null,doi:i?i.trim():null}}});t.exports=new l},function(t,e,n){var i=n(4),r=n(6),o=n(3),a=o(r,{getButtonHolder:function(t){return t.find(".article-header-container .header-bar-three")},getArticleHolders:function(){return i("#article")},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:this.getDoiFromElement(t.find(".article-header-container div > a"))}}});t.exports=new a},function(t,e,n){var i=n(4),r=n(6),o=n(3),a=o(r,{getButtonHolder:function(t){return t.find("#publication-header")},getArticleHolders:function(){return i("#spaContainer")},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:this.getDoiFromElement(t.find('[data-bind="text: doi"]'))}}});t.exports=new a},function(t,e,n){var i=n(4),r=n(6),o=n(3),a=o(r,{getButtonHolder:function(t){return t.find(".authors")},getArticleHolders:function(){return i("#mainContent")},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:this.getDoiFromElement(t.find(".AbstractSummary"))}}});t.exports=new a},function(t,e,n){var i=n(4),r=n(6),o=n(3),a=o(r,{getButtonHolder:function(t){return i('<div class="readcube-iop"/>').appendTo(t.find(".da1.ta1.article-head p.small"))},getArticleHolders:function(){return i(".page-body")},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:this.getDoiFromElement(t.find(".col-no-break.wd-jnl-art-doi"))}}});t.exports=new a},function(t,e,n){var i=n(4),r=n(6),o=n(3),a=o(r,{getButtonHolder:function(t){return t.find(".fbox")},getArticleHolders:function(){return i(".inhalt:has(.fbox)")},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:this.getDoiFromElement(t.find(".fbox"))}}});t.exports=new a},function(t,e,n){var i=n(4),r=n(3),o=n(6),a=n(1),s=n(152),l=r(o,{getButtonHolder:function(t){return t.find(".identifiers-list")},getArticleHolders:function(){return i("#main-content article:first")},getIdentifiers:function(t){var e=t.attr("data-doc"),n=s(e);return{pmid:a.get(n,"identifiers.pmid",null),gsid:null,doi:a.get(n,"identifiers.doi",null)}}});t.exports=new l},function(t,e,n){var i=n(4),r=n(1),o=n(9),a=n(3),s=n(6),l=a(s,{getButtonHolder:function(t){return t.find('.flex-box-item li:has(abbr[title="Digital Object Identifier"])')},getArticleHolders:function(){return i(".main-column[role=main]")},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:this.getDataUrlPartial(t)("contentID",null)}},getDataUrlPartial:function(t){var e=t.find('a[href*="s100.copyright.com/AppDispatchServlet"]').attr("href"),n=null;return e&&(n=o.parse(e,!0).query),r.partial(r.get,n)}});t.exports=new l},function(t,e,n){var i=n(4),r=n(3),o=n(6),a=r(o,{getButtonHolder:function(t){return i(t.find("p").children()[3])},getArticleHolders:function(){return[i(i("table:first tr")[16]).children()[1]]},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:this.getDoiFromElement(t.find("table:first"))}}});t.exports=new a},function(t,e,n){var i=n(4),r=n(3),o=n(6),a=r(o,{getButtonHolder:function(t){return t.find("dl.citation:has(.doi)")},getArticleHolders:function(){return i("#content")},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:this.getDoiFromElement(t.find("dd.doi:first"))}}});t.exports=new a},function(t,e,n){var i=n(4),r=n(1),o=n(0),a=n(3),s=n(6),l=a(s,{getButtonHolder:function(t){return t.find("#cite")},getArticleHolders:function(){return i("#content-journalnav #content")},getIdentifiers:function(t){var e=t.find("#cite").html()?t.find("#cite").html():"";return{pmid:null,gsid:null,doi:r.get(e.match(o.REGEXP_DOI),"[0]",null)}}});t.exports=new l},function(t,e,n){var i=n(4),r=n(1),o=n(9),a=n(3),s=n(6),l=a(s,{getButtonHolder:function(t){return t.find(".citation:first").length?i("<dd/>").appendTo(t.find(".citation:first")):t.find('li:has(abbr[title="Digital Object Identifier"])')},getArticleHolders:function(){return i("#content[role=article] ,#content[role=main]")},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:this.getDataUrlPartial(t)("contentID",null)}},getDataUrlPartial:function(t){var e=t.find('a[href*="s100.copyright.com/AppDispatchServlet"]').attr("href"),n=null;return e&&(n=o.parse(e,!0).query),r.partial(r.get,n)}});t.exports=new l},function(t,e,n){var i=n(4),r=n(6),o=n(3),a=o(r,{getButtonHolder:function(t){return t.find(".citationLine")},getArticleHolders:function(){return i("#main")},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:this.getDoiFromElement(t.find(".citationLine .doi"))}}});t.exports=new a},function(t,e,n){var i=n(4),r=n(6),o=n(3),a=o(r,{getButtonHolder:function(t){return t.find(".highwire-citation-authors")},getArticleHolders:function(){return i(".highwire-article-citation:visible")},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:this.getDoiFromElement(t.find(".highwire-cite-doi a"))}}});t.exports=new a},function(t,e,n){var i=n(4),r=n(6),o=n(3),a=o(r,{getButtonHolder:function(t){return t.find(".corresp")},getArticleHolders:function(){return i(".hw-gen-page.pagetype-content.hw-pub-id-article")},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:this.getDoiFromElement(t.find(".slug-doi:visible"))}}});t.exports=new a},function(t,e,n){var i=n(4),r=n(6),o=n(3),a=o(r,{getButtonHolder:function(t){return t.find(".AuthorListParagraph")},getArticleHolders:function(){return i(".Latest")},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:this.getDoiFromElement(t.find(".doi"))}}});t.exports=new a},function(t,e,n){var i=n(4),r=n(1),o=n(6),a=n(3),s=a(o,{getButtonHolder:function(t){return t.find(".article-id-doi")},getArticleHolders:function(){return i(".Main-Content")},getIdentifiers:function(t){var e=t.find('.P-Aritlce-Downloads-Holder a[title="PDF"]').attr("onclick"),n=null;if(e){var i=r.get(e.match(/\d+/),"[0]",null);if(i){var o="/lib/ajax_srv/article_elements_srv.php?action=download_pdf&item_id="+i;if(o){var a=document.createElement("a");a.href=o,n=a.href}}}return{pmid:null,gsid:null,doi:this.getDoiFromElement(t.find(".article-id-doi")),parsedPdfUrl:n}}});t.exports=new s},function(t,e,n){var i=n(4),r=n(6),o=n(3),a=o(r,{getButtonHolder:function(t){return i('<li class="readcube-list-style-type"/>').appendTo(t.find(".date-doi"))},getArticleHolders:function(){return i("main")},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:this.getDoiFromElement(t.find("#artDoi"))}}});t.exports=new a},function(t,e,n){var i=n(4),r=n(6),o=n(3),a=o(r,{getButtonHolder:function(t){return t.find(".meta")},getArticleHolders:function(){return i("#main-body")},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:this.getDoiFromElement(t.find(".print-citation-container"))}}});t.exports=new a},function(t,e,n){var i=n(4),r=n(6),o=n(3),a=n(0),s=n(1),l=o(r,{getButtonHolder:function(t){var e=i("<li/>");return t.find(".contributor-list").append(e),e},getArticleHolders:function(){return i("#main")},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:s.get(t.find(".slug-doi").text().match(a.REGEXP_DOI),"[0]",null)}}});t.exports=new l},function(t,e,n){var i=n(4),r=n(6),o=n(3),a=(n(1),n(5).sprintf,o(r,{getButtonHolder:function(t){return i('<li class="readcube-list-style-type"/>').appendTo(t.find(".peptide_middle"))},getArticleHolders:function(){return i(".article_main")},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:this.getDoiFromElement(t.find(".DOILink"))}}}));t.exports=new a},function(t,e,n){var i=n(4),r=n(6),o=n(3),a=n(0),s=n(1),l=o(r,{getButtonHolder:function(t){var e=t.find("h1.svTitle");return e.length?e:(e=t.find(".article-title"),e.length?e:t.find("h1.article-title"))},getArticleHolders:function(){var t=i("#centerContent");return t.length?t:(t=i(".article-content"),t.length?t:(t=i('div[role="main"]'),t.length?t:i('article[role="main"]')))},getIdentifiers:function(t){var e=t.find("#ddDoi");return 0==e.length&&(e=t.find(".doi")),0==e.length&&(e=t.find(".DoiLink .doi")),{pmid:null,gsid:null,doi:s.get(e.text().match(a.REGEXP_DOI),"[0]",null)}},getExecutePromise:function(){var t=this;return this.getAngularInjector(function(e){var n=function(){var e=t.getArticleHolders(),n=e.find(".doiLink");return n.length?n:(n=e.find("#doi-value"),n.length?n.find(".doi"):e.find(".DoiLink .doi"))},i=e.defer(),r=new MutationObserver(s.debounce(function(){n().length&&(r.disconnect(),i.resolve())},500));return r.observe(document.body,{childList:!0,subtree:!0}),s.delay(function(){r.disconnect(),0==n().length?i.reject("DOI param wasn't loaded after 6 seconds"):i.resolve("DOI found, but not from mutation observer")},3e3),i.promise},["$q"])},getPlain:function(){return[{doi:!0}]}});t.exports=new l},function(t,e,n){var i=n(4),r=n(1),o=n(6),a=n(3),s=n(0),l=a(o,{getButtonHolder:function(t){return"content-block"==this.getArticleHolders().attr("id")?t.find("#slugline cite"):t.find(".meta-line")},getArticleHolders:function(){return i("#content-block, #sci-article-author-list")},getIdentifiers:function(t){var e=r.trim(t.find(".slug-doi, .meta-line").text());return{pmid:null,gsid:null,doi:r.get(e.match(s.REGEXP_DOI),"[0]",null)}}});t.exports=new l},function(t,e,n){var i=n(4),r=n(6),o=n(3),a=o(r,{getButtonHolder:function(t){return t.find("#enumeration")},getArticleHolders:function(){return i("#book, #chapter, #article")},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:t.find("#abstract-about-book-chapter-doi, #abstract-about-doi").text()}}});t.exports=new a},function(t,e,n){var i=n(4),r=n(6),o=n(3),a=o(r,{getButtonHolder:function(t){return t.find(".cf .float-display:last")},getArticleHolders:function(){return i(".main")},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:this.getDoiFromElement(t.find('.row .pull-down dl div:contains("DOI") dd'))}}});t.exports=new a},function(t,e,n){var i=n(4),r=n(6),o=n(3),a=o(r,{getButtonHolder:function(t){return t.find("p.article-doi")},getArticleHolders:function(){return i("article:has(.article-body)")},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:this.getDoiFromElement(t.find("p.article-doi"))}},insertAngularDirectives:function(){if(0==this.getArticleHolders().length)return!1;var t=i("article .ArticleHeader");return t.attr({"ng-controller":"List as list"}),t.append(n(30)),this.insertButtons(),!0},bootstrapAngular:function(){angular.bootstrap(i("article .ArticleHeader").get(0),["App"],{strictDi:!0})}});t.exports=new a},function(t,e,n){var i=n(4),r=n(6),o=n(3),a=o(r,{getButtonHolder:function(t){return t.find(".ContextInformation")},getArticleHolders:function(){return i("#main")},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:this.getDoiFromElement(t.find(".ArticleDOI"))}},insertAngularDirectives:function(){if(0==this.getArticleHolders().length)return!1;var t=i(".FulltextWrapper:has(h1)");t.attr({"ng-controller":"List as list"});var e=n(30);return t.append(e),this.insertButtons(),!0},bootstrapAngular:function(){angular.bootstrap(i(".FulltextWrapper:has(h1)").get(0),["App"],{strictDi:!0})}});t.exports=new a},function(t,e,n){var i=n(4),r=n(1),o=n(6),a=n(3),s=a(o,{getButtonHolder:function(t){return t.find(".itemPageRangeHistory")},getArticleHolders:function(){return i(".pagefulltext")},getIdentifiers:function(t){var e=t.find(".downloadCitations a"),n=r.get(e,"[0].href",null),i=r.get(n.match(/doi=(.*)/),"[1]",null);return{pmid:null,gsid:null,doi:decodeURIComponent(i)}}});t.exports=new s},function(t,e,n){var i=n(4),r=n(6),o=n(3),a=o(r,{getButtonHolder:function(t){return i('<span class="readcube-ucpress-abstract"/>').appendTo(t)},getArticleHolders:function(){return i(".highwire-article-citation.highwire-citation-type-highwire-article:visible")},getIdentifiers:function(t){return{pmid:null,gsid:null,doi:this.getDoiFromElement(t.find(".highwire-cite-metadata-doi.highwire-cite-metadata"))}}});t.exports=new a},function(t,e,n){var i=n(4),r=n(6),o=n(3),a=o(r,{isOlderDesign:function(){return this.getArticleHolders().find("#articleMeta #doi").length>0},getButtonHolder:function(t){return this.isOlderDesign()?t.find("#articleMeta #doi"):t.find("#header-section-doi").parent(":first")},getArticleHolders:function(){return i("#content, #main-content")},getIdentifiers:function(t){var e;if(this.isOlderDesign())e=this.getDoiFromElement(t.find("#articleMeta #doi"));else{e=t.find("#header-section-doi").parent(":first").find(".article-header__meta-info-data").text()}return{pmid:null,gsid:null,doi:e}}});t.exports=new a},function(t,e,n){function i(t){return o.get(t,"length",0)>0&&o.some(t,function(t){return null!=t.doi})}for(var r=n(0),o=n(1),a=null,s=[{regexes:[r.URL_REGEXP_PUBLISHER_NATURE_SEARCH],parsers:[{path:"multiple/nature"}]},{regexes:[r.URL_REGEXP_PUBLISHER_WILEY_SEARCH,r.URL_REGEXP_PUBLISHER_WILEY_ISSUE],parsers:[{path:"multiple/wiley"}]},{regexes:[r.URL_REGEXP_PUBLISHER_WILEY_JOURNAL],parsers:[{path:"multiple/wiley_journal"}]},{regexes:[r.URL_REGEXP_PUBLISHER_WILEY],parsers:[{path:"single/wiley"}]},{regexes:[r.URL_REGEXP_PUBLISHER_KARGER_ARTICLE],parsers:[{path:"single/karger_article"}]},{regexes:[r.URL_REGEXP_PUBLISHER_EMBO_ARTICLE],parsers:[{path:"single/embo_article"}]},{regexes:[r.URL_REGEXP_PUBLISHER_SPRINGER],parsers:[{test:i,path:"single/springer_new"},{path:"single/springer"}]},{regexes:[r.URL_REGEXP_PUBLISHER_SPRINGEROPEN,r.URL_REGEXP_PUBLISHER_SPRINGEROPEN_BIOMEDCENTRAL],parsers:[{path:"single/springeropen_journal"}]},{regexes:[r.URL_REGEXP_PUBLISHER_SCIENCEMAG],parsers:[{path:"single/sciencemag"}]},{regexes:[r.URL_REGEXP_PUBLISHER_PNAS],parsers:[{path:"single/pnas"}]},{regexes:[r.URL_REGEXP_PUBLISHER_SCIENCEDIRECT],parsers:[{path:"single/sciencedirect"}]},{regexes:[r.URL_REGEXP_PUBLISHER_CELL,r.URL_REGEXP_PUBLISHER_THELANCET,r.URL_REGEXP_PUBLISHER_THELANCET_EBIOMEDICINE],parsers:[{path:"single/cell_thelancet"}]},{regexes:[r.URL_REGEXP_PUBLISHER_PAMJ],parsers:[{path:"single/pamj"}]},{regexes:[r.URL_REGEXP_PUBLISHER_PLOS],parsers:[{path:"single/plos"}]},{regexes:[r.URL_REGEXP_PUBLISHER_PLOS_CURRENTS],parsers:[{path:"single/plos_currrents"}]},{regexes:[r.URL_REGEXP_PUBLISHER_ELIFESCIENCES],parsers:[{path:"single/elifesciences"}]},{regexes:[r.URL_REGEXP_PUBLISHER_ELIFESCIENCES_LENS],parsers:[{path:"single/elifesciences_lens"}]},{regexes:[r.URL_REGEXP_PUBLISHER_NEJM],parsers:[{path:"single/nejm"}]},{regexes:[r.URL_REGEXP_PUBLISHER_TAILOR_FRANCIS],parsers:[{path:"single/tailor_francis"}]},{regexes:[r.URL_REGEXP_PUBLISHER_FRONTIERS],parsers:[{path:"single/frontiers"}]},{regexes:[r.URL_REGEXP_PUBLISHER_GENETICS],parsers:[{path:"multiple/genetics"}]},{regexes:[r.URL_REGEXP_PUBLISHER_PLOS_TOC],parsers:[{path:"multiple/plos_toc"}]},{regexes:[r.URL_REGEXP_PUBLISHER_RSC],parsers:[{path:"multiple/rsc"}]},{regexes:[r.URL_REGEXP_PUBLISHER_RSC_ABSTRACT],parsers:[{path:"single/rsc"}]},{regexes:[r.URL_REGEXP_PUBLISHER_FRONTIERS_LOOP_PUBLICATION],parsers:[{path:"single/frontiers_loop_publication"}]},{regexes:[r.URL_REGEXP_PUBLISHER_FRONTIERS_PUBLICATION],parsers:[{test:i,path:"single/frontiers_publication"}]},{regexes:[r.URL_REGEXP_PUBLISHER_OXFORD_JOURNALS],parsers:[{test:i,path:"multiple/oxford_journals_new"},{test:i,path:"multiple/oxford_journals_old"},{test:i,path:"single/oxford_journals_new"},{test:i,path:"single/oxford_journals_old"}]},{regexes:[r.URL_REGEXP_PUBLISHER_NATURE],parsers:[{test:i,path:"single/nature_with_tools"},{test:i,path:"single/nature_with_access"},{test:i,path:"single/nature_new_design"},{test:i,path:"single/nature_protocol_exchange"},{test:i,path:"multiple/nature_table_of_contents"},{test:i,path:"single/nature_old_design"}]},{regexes:[r.URL_REGEXP_PUBLISHER_EUROPE_PMC],parsers:[{path:"single/europe_pmc"}]},{regexes:[r.URL_REGEXP_PUBLISHER_OXFORD_JOURNALS_SEARCH],parsers:[{path:"multiple/oxford_journals_search"}]},{regexes:[r.URL_REGEXP_PUBLISHER_IMPACT_JOURNALS],parsers:[{path:"multiple/impact_journals"}]},{regexes:[r.URL_REGEXP_PUBLISHER_IMPACT_JOURNALS_ONCOTARGET],parsers:[{path:"multiple/impact_journals_oncotarget"}]},{regexes:[r.URL_REGEXP_PUBLISHER_PENSOFT],parsers:[{path:"single/pensoft"}]},{regexes:[r.URL_REGEXP_PUBLISHER_PENSOFT_MULTIPLE],parsers:[{path:"multiple/pensoft"}]},{regexes:[r.URL_REGEXP_PUBLISHER_SPRINGER_MEDIZIN],parsers:[{path:"single/springer_medizin"}]},{regexes:[r.URL_REGEXP_PUBLISHER_UCPRESS_ABSTRACT],parsers:[{path:"single/ucpress"}]},{regexes:[r.URL_REGEXP_PUBLISHER_UCPRESS],parsers:[{path:"multiple/ucpress"}]},{regexes:[r.URL_REGEXP_PUBLISHER_IOP],parsers:[{path:"multiple/iop"}]},{regexes:[r.URL_REGEXP_PUBLISHER_IOP_ARTICLE],parsers:[{path:"single/iop"}]},{regexes:[r.URL_REGEXP_PUBLISHER_MENDELEY_ARTICLE],parsers:[{path:"single/mendeley"}]}],l=n(46).location.href,c=0;c<s.length;c++){var u=s[c];if(u.regexes.some(function(t){return l.match(t)})){for(var d=0;d<u.parsers.length;d++){var f=u.parsers[d],p=n(162)("./"+f.path);if(!f.test||f.test(p.getPlain())){a=p;break}}break}}a&&!function(t){return o.some(t,function(t){return o.some(o.values(t),o.identity)})}(a.getPlain())&&(a=null),t.exports=a},function(t,e,n){function i(){return l("."+s.THIRD_PARTY_HOOK_CLASSNAME).length}n(141);var r=n(154),o=n(156),a=n(155),s=n(0),l=n(4),c=n(45),u=n(46).location.href,d=n(13);d.isProtocol(u,["file:","ftp:"])?d.getPdfFilenameFromUrl(u)&&a.render(u):c.sendToBackground("tabs.CurrentFramePdfUrl",null).then(function(t){t?a.render(t):i()?o.render():r.render()})},,,,,,,,function(t,e){},function(t,e){},function(t,e,n){(function(e){var i,r=void 0!==e?e:"undefined"!=typeof window?window:{},o=n(163);"undefined"!=typeof document?i=document:(i=r["__GLOBAL_DOCUMENT_CACHE@4"])||(i=r["__GLOBAL_DOCUMENT_CACHE@4"]=o),t.exports=i}).call(e,n(16))},,,,,,function(t,e){t.exports='<iframe src="%s" frameborder="0" class="readcube-pdf-import"></iframe>'},,,function(t,e){function n(t){try{var e=JSON.parse(t);if(e&&"object"==typeof e)return e}catch(t){}return!1}t.exports=n},,function(t,e,n){var i=n(0),r=n(159),o=n(1),a=[],s=n(157),l=n(15),c=r.getIdentifiers(),u=n(46),d=n(45),f={render:function(){o.get(c,"[0].doi",null)&&(this.fetchArticle(),this.listen())},fetchArticle:function(){s.list(c).then(function(t){return t}).catch(function(t){return console.error(t),[{status:i.STATUS_NOT_FOUND,id:null}]}).then(function(t){return r.getMetadata(o.get(c,"[0]",null)).then(function(e){e.metadata&&e.metadata.title&&(e.metadata.title=e.metadata.title.replace(/&nbsp;/gi," "));var n=t[0],r=o.extend({isReadyForShowing:!0,note:n.notes,id:n.id,hasPdf:n.has_file},e,c[0]),s=new l(r);return chrome.storage.local.get(i.SETTING_PDF_DOWNLOAD,function(t){var e=o.get(t,i.SETTING_PDF_DOWNLOAD,i.VALUE_PDF_DOWNLOAD_AUTOMATIC_ENABLED)==i.VALUE_PDF_DOWNLOAD_AUTOMATIC_ENABLED;s.setInLibraryStatus(n.status,e)}),a.push(s),!0})}).then(function(){d.sendToBackground("browser_action.SetBadgeAndIcon",a.length)}).done()},listen:function(){chrome.runtime.onMessage.addListener(function(t,e,n){switch(t.message){case i.MESSAGE_GET_ARTICLES:n(a);break;case i.MESSAGE_UPDATE_ARTICLE:var s=o.get(t,"data.updateDetails",{}),l=o.get(t,"data.index",null);o.isNull(l)||o.isEmpty(s)||o.extend(a[l],s);break;case i.MESSAGE_IS_ABSTRACT_PAGE:n(r.isAbstractPage());break;case i.MESSAGE_SELECT_ALL_SHOW:n(!0);break;case i.MESSAGE_SHOW_LOGIN:u.open(chrome.extension.getURL("options.html")+"#/actions/"+i.ACTION_SHOW_LOGIN_FORM);break;default:n(null)}return!0})}};t.exports=f},function(t,e,n){var i=n(0),r=n(1),o=(n(8),n(4)),a=n(143),s=n(45),l=n(5).sprintf,c=(n(9),{iframe:null,render:function(t){var e=this;o(function(){e.disablePopup(),e.insertImportButton(t),e.listenForMouseMove()})},disablePopup:function(){s.sendToBackground("browser_action.DisablePopup",null)},insertImportButton:function(t){var e=r.chain(a).get("referrer","").thru(function(t){return t.match(i.REGEXP_READCUBE_UUID_IN_URL)}).get("[1]","").value(),c=this,u=chrome.extension.getURL(l("pdf_import.html?pdfUrl=%s&readcubeId=%s",encodeURIComponent(t),e)),d=l(n(149),u);c.iframe=o(d),r.defer(function(){o("body").append(c.iframe)}),s.sendToBackground("extensions.IsEvernoteExtensionEnabled",null).then(function(t){c.iframe.toggleClass("readcube-evernote-installed",t)})},listenForMouseMove:function(){var t=this,e=r.delay(function(){t.iframe.addClass("readcube-hidden")},6500);o("body").mousemove(r.throttle(function(n){var i=a.body.clientHeight;a.body.clientWidth-n.pageX<=650&&i-n.pageY<=270?(e&&(clearTimeout(e),e=null),t.iframe.removeClass("readcube-hidden")):e||(e=r.delay(function(){t.iframe.addClass("readcube-hidden"),e=null},3e3))},300))}});t.exports=c},function(t,e,n){var i=n(82),r={render:function(){i.getExecutePromise().then(function(){i.insertAngularDirectives()&&(n(80),i.bootstrapAngular())}.bind(this))}};t.exports=r},function(t,e,n){var i=n(7),r=n(8),o=n(0),a=n(1);t.exports={list:function(t){return i.post(o.URL_ARTICLES_STATUS,{ext_ids:t}).then(function(t){var e=a.get(t,"data.items",[]);return 0==e.length?r.reject("The list from Readcube server is empty"):e})}}},function(t,e,n){function i(){for(var t,e=[["link[rel='canonical']","href",/\/doi\/(.+)/],["div[class='permalinkLinks'] a[href^='http://link.aip.org/link/doi/']","href",/link\/doi\/(.+)/],["span[class='doi'] span[class='value']",null,/(.+)/],["ul[class='articleDoi'] a[target='doilink']","href",/^http:\/\/[^\/]+\/(.+)/],["dt:contains('DOI:') ~ dd[id='dd']",null,/(.+)/],["a[href^='http://dx.doi.org']","href",/^http:\/\/[^\/]+\/(.+)/],["*:contains('DOI:') ~ a[href^='http://dx.doi.org']","href",/^http:\/\/[^\/]+\/(.+)/],["span[class='slug-doi']",null,/(.+)/],["*:contains('DOI:') + value",null,/(.+)/],["*:contains('doi: ') ~ div[class='field-items']",null,/(.+)/],["*:contains('DOI:')",null,/DOI:\s+(.+)/],["*:contains('Accession:')",null,/Accession:\s+(.+)/]],n=0;n<e.length;n++){var i=e[n],r=o(i[0]),a=[];if(r.length>0){for(var s=0;s<r.length;s++)try{t=i[1]?i[2].exec(o(r[s]).attr(i[1]))[1]:i[2].exec(o(r[s]).text())[1],t&&(i[0].match(/accession/i)?a.push("10.1097/"+t):a.push(t))}catch(t){}return a}}var l=o("script[type='text/javascript']").text();if(l&&-1!=l.indexOf("doi = ")){var c=l.match(/doi\s=\s['"]([^'"]+?)['"]/);c&&(t=c[1])}return t&&(t=t.replace(/^doi:\s*/,""),-1!=t.indexOf("%2F")&&(t=decodeURIComponent(t))),t}function r(){for(var t,e,n,r=["doi","title","firstpage","lastpage","journal_title","journal_abbrev","issue","volume","date","issn","publisher","pdf_url","author",'[name="DC.creator"]','[name="dc.Creator"]','[name="prism.issn"]','[name="prism.eIssn"]','[name="dc.Identifier"][scheme="doi"]','[property="dc:identifier"]','[name="dc.Title"]','[name="dc.Publisher"]','[name="dc.Date"]','[name="evt-doiPage"]','[name="wkhealth_doi"]','[name="wkhealth_title"]','[name="wkhealth_pdf_url"]'],s={author:"authors",'[name="dc.creator"]':"authors",'[name="prism.issn"]':"issn",'[name="prism.eissn"]':"eissn",'[name="dc.identifier"][scheme="doi"]':"doi",'[property="dc:identifier"]':"doi",'[name="dc.title"]':"title",'[name="dc.publisher"]':"publisher",'[name="dc.date"]':"date",'[name="evt-doipage"]':"doi",'[name="wkhealth_doi"]':"doi",'[name="wkhealth_title"]':"title",'[name="wkhealth_pdf_url"]':"pdf_url"},l={},c=0;c<r.length;c++)if(t=r[c],e=o(t.indexOf("=")>-1?"meta"+t:"meta[name='citation_"+t+"']"),s[t.toLowerCase()]&&(t=s[t.toLowerCase()]),!l[t])if(e.length>1){l[t]=[];for(var u=0;u<e.length;u++)(n=o(e[u]).attr("content"))&&l[t].push(n)}else 1==e.length&&(n=e.attr("content"))&&(l[t]=n);if(l.doi||(l.doi=i()),l.doi&&0===l.doi.indexOf("doi:")&&(l.doi=l.doi.substr(4)),l.doi&&0===l.doi.indexOf("doi:")&&(l.doi=l.doi.substr(4)),Array.isArray(l.doi)&&l.doi.length>0&&(l.doi.length>1?l.doi[0]===l.doi[l.doi.length-1]?l.doi=l.doi[0]:l.doi=null:l.doi=l.doi[0]),"string"==typeof l.doi){var d=l.doi.match(a);l.doi=d&&d.length>1?d[1]:null}else l.doi=null;return l}var o=n(4),a=/\b(10[.][0-9]{4,}(?:[.][0-9]+)*\/(?:(?!["&\'<>])\S)+)\b/;t.exports=r},function(t,e,n){var i=n(0),r=n(7),o=n(1),a=n(158),s=n(8),l=n(3),c=n(72),u=l(c,{identifiers:null,getIdentifiers:function(){var t=a(),e=null;return t.doi&&(e=t.doi),null==this.identifiers&&(this.identifiers=[{doi:e,pmid:null,gsid:null}]),this.identifiers},getMetadata:function(t){var e=o.get(t,"doi",null);return e?r.post(i.URL_ARTICLES_METADATA,{ext_ids:[{doi:e}]}).then(function(t){var e=o.get(t,"data[0]",null);return e?{metadata:o.pick(e,"title","year","journal","authors"),pdfUrl:o.get(e,"pdf_urls[0]",null)}:s.reject(null)}).fail(function(t){return console.error(t),s.reject(null)}):s.reject("No DOI was parsed from page")},isAbstractPage:function(){return!0}});t.exports=new u},function(t,e,n){function i(t){return n(r(t))}function r(t){var e=o[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}var o={"./app.js":80,"./controllers/list.js":161};i.keys=function(){return Object.keys(o)},i.resolve=r,t.exports=i,i.id=160},function(t,e,n){function i(t,e,n,i,u,d,f,p,h,g,v,m,_,b,y){function E(t,e){return!(!t||!e)&&t.toLowerCase()==e.toLowerCase()}function A(t){var e=this,n=[],i=t.get();return i.forEach(function(t,e){null==t.metadata&&(o.get(t,"doi",null)||o.get(t,"pmid",null))&&n.push(o.pick(t,["doi","pmid"]))}),s.post(a.URL_ARTICLES_METADATA,{ext_ids:n}).then(function(t){var n=o.get(t,"data",[]);o.each(i,function(t,i){var r=new l;if(r.extend(t),!t.metadata){var o=n.find(function(e){return E(e.doi,t.doi)||E(e.pmid,t.pmid)});o&&r.extend({metadata:o})}e.articlesList.push(r)})})}function w(t){var e=this,n=[],i=t.get();return r.forEach(i,function(t){n.push(v.when(t.metadata)),delete t.metadata}),v.all(n).then(function(t){o.each(t,function(t,n){if(t){var r=new l;r.extend({metadata:t}).extend(i[n]),e.articlesList.push(r)}})})}var I=this;r.extend(I,i("GeneralList",{ProxyUpload:u,RawUpload:d,BrowserTab:f,Article:p,Message:h,ListDropdownApi:g,$q:v,Storage:m,List:_,User:b,Mixpanel:y,SiteType:a.VALUE_BUTTON_AVAILABLE_ON_PUBLISHER_WEBSITES,$scope:e,TooltipApi:n})),I.initArticles=w,I.initThirdPartyArticles=A,t?I.initArticles(t).then(function(){return I.loadArticles()}).catch(function(t){console.error(t)}):I.initThirdPartyArticles(c).then(function(){return I.loadArticles()}).catch(function(t){console.error(t)}),I.listenForMessages(t||c),I.listenForTooltip()}i.$inject=["PublisherIds","$scope","TooltipApi","$controller","ProxyUpload","RawUpload","BrowserTab","Article","Message","ListDropdownApi","$q","Storage","List","User","Mixpanel"];var r=n(2),o=n(1),a=n(0),s=n(7),l=n(15),c=n(82);r.module("App").controller("List",i)},function(t,e,n){function i(t){return n(r(t))}function r(t){var e=o[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}var o={"./multiple/genetics":83,"./multiple/genetics.js":83,"./multiple/impact_journals":84,"./multiple/impact_journals.js":84,"./multiple/impact_journals_oncotarget":85,"./multiple/impact_journals_oncotarget.js":85,"./multiple/iop":86,"./multiple/iop.js":86,"./multiple/nature":87,"./multiple/nature.js":87,"./multiple/nature_table_of_contents":88,"./multiple/nature_table_of_contents.js":88,"./multiple/oxford_journals_new":89,"./multiple/oxford_journals_new.js":89,"./multiple/oxford_journals_old":90,"./multiple/oxford_journals_old.js":90,"./multiple/oxford_journals_search":91,"./multiple/oxford_journals_search.js":91,"./multiple/pensoft":92,"./multiple/pensoft.js":92,"./multiple/plos_toc":93,"./multiple/plos_toc.js":93,"./multiple/rsc":94,"./multiple/rsc.js":94,"./multiple/ucpress":95,"./multiple/ucpress.js":95,"./multiple/wiley":96,"./multiple/wiley.js":96,"./multiple/wiley_journal":97,"./multiple/wiley_journal.js":97,"./single/cell_thelancet":98,"./single/cell_thelancet.js":98,"./single/elifesciences":99,"./single/elifesciences.js":99,"./single/elifesciences_lens":100,"./single/elifesciences_lens.js":100,"./single/embo_article":101,"./single/embo_article.js":101,"./single/europe_pmc":102,"./single/europe_pmc.js":102,"./single/frontiers":103,"./single/frontiers.js":103,"./single/frontiers_loop_publication":104,"./single/frontiers_loop_publication.js":104,"./single/frontiers_publication":105,"./single/frontiers_publication.js":105,"./single/iop":106,"./single/iop.js":106,"./single/karger_article":107,"./single/karger_article.js":107,"./single/mendeley":108,"./single/mendeley.js":108,"./single/nature_new_design":109,"./single/nature_new_design.js":109,"./single/nature_old_design":110,"./single/nature_old_design.js":110,"./single/nature_protocol_exchange":111,"./single/nature_protocol_exchange.js":111,"./single/nature_with_access":112,"./single/nature_with_access.js":112,"./single/nature_with_tools":113,"./single/nature_with_tools.js":113,"./single/nejm":114,"./single/nejm.js":114,"./single/oxford_journals_new":115,"./single/oxford_journals_new.js":115,"./single/oxford_journals_old":116,"./single/oxford_journals_old.js":116,"./single/pamj":117,"./single/pamj.js":117,"./single/pensoft":118,"./single/pensoft.js":118,"./single/plos":119,"./single/plos.js":119,"./single/plos_currrents":120,"./single/plos_currrents.js":120,"./single/pnas":121,"./single/pnas.js":121,"./single/rsc":122,"./single/rsc.js":122,"./single/sciencedirect":123,"./single/sciencedirect.js":123,"./single/sciencemag":124,"./single/sciencemag.js":124,"./single/springer":125,"./single/springer.js":125,"./single/springer_medizin":126,"./single/springer_medizin.js":126,"./single/springer_new":127,"./single/springer_new.js":127,"./single/springeropen_journal":128,"./single/springeropen_journal.js":128,"./single/tailor_francis":129,"./single/tailor_francis.js":129,"./single/ucpress":130,"./single/ucpress.js":130,"./single/wiley":131,"./single/wiley.js":131};i.keys=function(){return Object.keys(o)},i.resolve=r,t.exports=i,i.id=162},function(t,e){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){var i=n(132);i?i.getExecutePromise().then(function(){i.insertAngularDirectives()&&(n(80),i.bootstrapAngular())}.bind(this)):n(133)}],[253]);