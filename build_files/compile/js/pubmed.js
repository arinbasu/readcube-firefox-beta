webpackJsonp([2],[,,,,,,,function(t,e,n){function i(t,e,n,i,a){var s=o.defer(),l=new XMLHttpRequest;return l.open(e,t,!0),l.onload=function(){l.status>=200&&l.status<400?s.resolve({data:i?l.responseText:JSON.parse(l.responseText),status:l.status,url:l.responseURL}):s.reject({status:l.status})},l.onerror=function(){s.reject("Error in xhr."+e)},r.isReadcubeUrl(t)&&c.forEach(function(t){l.setRequestHeader(t[0],t[1])}),a&&l.setRequestHeader("Accept",a),n?(l.setRequestHeader("Content-Type","application/json; charset=UTF-8"),l.send(JSON.stringify(n))):l.send(),s.promise}var o=n(8),r=n(13),a=n(5).sprintf,s=n(0),l=chrome.runtime.getManifest().version,c=[["Sync-Version",s.HEADER_SYNC_VERSION],["X-Readcube-Sync-Token",a(s.HEADER_VALUE_SYNC_TOKEN,l)],["X-Readcube-Sync-Client",a(s.HEADER_VALUE_SYNC_CLIENT,"chrome",l)]];!function(){var t}();t.exports={get:function(t,e,n){return i(t,"GET",null,e,n)},patch:function(t,e){return i(t,"PATCH",e)},delete:function(t){return i(t,"DELETE")},post:function(t,e){return i(t,"POST",e)}}},function(t,e,n){(function(e,n){/*!
 *
 * Copyright 2009-2012 Kris Kowal under the terms of the MIT
 * license found at http://github.com/kriskowal/q/raw/master/LICENSE
 *
 * With parts by Tyler Close
 * Copyright 2007-2009 Tyler Close under the terms of the MIT X license found
 * at http://www.opensource.org/licenses/mit-license.html
 * Forked at ref_send.js version: 2009-05-11
 *
 * With parts by Mark Miller
 * Copyright (C) 2011 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */
!function(e){"use strict";if("function"==typeof bootstrap)bootstrap("promise",e);else{t.exports=e()}}(function(){"use strict";function t(t){return function(){return q.apply(t,arguments)}}function i(t){return t===Object(t)}function o(t){return"[object StopIteration]"===nt(t)||t instanceof H}function r(t,e){if(G&&e.stack&&"object"==typeof t&&null!==t&&t.stack&&-1===t.stack.indexOf(it)){for(var n=[],i=e;i;i=i.source)i.stack&&n.unshift(i.stack);n.unshift(t.stack);var o=n.join("\n"+it+"\n");t.stack=a(o)}}function a(t){for(var e=t.split("\n"),n=[],i=0;i<e.length;++i){var o=e[i];c(o)||s(o)||!o||n.push(o)}return n.join("\n")}function s(t){return-1!==t.indexOf("(module.js:")||-1!==t.indexOf("(node.js:")}function l(t){var e=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(t);if(e)return[e[1],Number(e[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(t);if(n)return[n[1],Number(n[2])];var i=/.*@(.+):(\d+)$/.exec(t);return i?[i[1],Number(i[2])]:void 0}function c(t){var e=l(t);if(!e)return!1;var n=e[0],i=e[1];return n===W&&i>=Y&&i<=lt}function u(){if(G)try{throw new Error}catch(i){var t=i.stack.split("\n"),e=t[0].indexOf("@")>0?t[1]:t[2],n=l(e);if(!n)return;return W=n[0],n[1]}}function d(t){return t instanceof g?t:y(t)?O(t):S(t)}function f(){function t(t){e=t,r.source=t,Q(n,function(e,n){d.nextTick(function(){t.promiseDispatch.apply(t,n)})},void 0),n=void 0,i=void 0}var e,n=[],i=[],o=Z(f.prototype),r=Z(g.prototype);if(r.promiseDispatch=function(t,o,r){var a=z(arguments);n?(n.push(a),"when"===o&&r[1]&&i.push(r[1])):d.nextTick(function(){e.promiseDispatch.apply(e,a)})},r.valueOf=function(){if(n)return r;var t=b(e);return m(t)&&(e=t),t},r.inspect=function(){return e?e.inspect():{state:"pending"}},d.longStackSupport&&G)try{throw new Error}catch(t){r.stack=t.stack.substring(t.stack.indexOf("\n")+1)}return o.promise=r,o.resolve=function(n){e||t(d(n))},o.fulfill=function(n){e||t(S(n))},o.reject=function(n){e||t(L(n))},o.notify=function(t){e||Q(i,function(e,n){d.nextTick(function(){n(t)})},void 0)},o}function p(t){if("function"!=typeof t)throw new TypeError("resolver must be a function.");var e=f();try{t(e.resolve,e.reject,e.notify)}catch(t){e.reject(t)}return e.promise}function h(t){return p(function(e,n){for(var i=0,o=t.length;i<o;i++)d(t[i]).then(e,n)})}function g(t,e,n){void 0===e&&(e=function(t){return L(new Error("Promise does not support operation: "+t))}),void 0===n&&(n=function(){return{state:"unknown"}});var i=Z(g.prototype);if(i.promiseDispatch=function(n,o,r){var a;try{a=t[o]?t[o].apply(i,r):e.call(i,o,r)}catch(t){a=L(t)}n&&n(a)},i.inspect=n,n){var o=n();"rejected"===o.state&&(i.exception=o.reason),i.valueOf=function(){var t=n();return"pending"===t.state||"rejected"===t.state?i:t.value}}return i}function v(t,e,n,i){return d(t).then(e,n,i)}function b(t){if(m(t)){var e=t.inspect();if("fulfilled"===e.state)return e.value}return t}function m(t){return t instanceof g}function y(t){return i(t)&&"function"==typeof t.then}function _(t){return m(t)&&"pending"===t.inspect().state}function T(t){return!m(t)||"fulfilled"===t.inspect().state}function w(t){return m(t)&&"rejected"===t.inspect().state}function E(){ot.length=0,rt.length=0,st||(st=!0)}function A(t,n){st&&("object"==typeof e&&"function"==typeof e.emit&&d.nextTick.runAfter(function(){-1!==K(rt,t)&&(e.emit("unhandledRejection",n,t),at.push(t))}),rt.push(t),n&&void 0!==n.stack?ot.push(n.stack):ot.push("(no stack) "+n))}function I(t){if(st){var n=K(rt,t);-1!==n&&("object"==typeof e&&"function"==typeof e.emit&&d.nextTick.runAfter(function(){var i=K(at,t);-1!==i&&(e.emit("rejectionHandled",ot[n],t),at.splice(i,1))}),rt.splice(n,1),ot.splice(n,1))}}function L(t){var e=g({when:function(e){return e&&I(this),e?e(t):this}},function(){return this},function(){return{state:"rejected",reason:t}});return A(e,t),e}function S(t){return g({when:function(){return t},get:function(e){return t[e]},set:function(e,n){t[e]=n},delete:function(e){delete t[e]},post:function(e,n){return null===e||void 0===e?t.apply(void 0,n):t[e].apply(t,n)},apply:function(e,n){return t.apply(e,n)},keys:function(){return et(t)}},void 0,function(){return{state:"fulfilled",value:t}})}function O(t){var e=f();return d.nextTick(function(){try{t.then(e.resolve,e.reject,e.notify)}catch(t){e.reject(t)}}),e.promise}function P(t){return g({isDef:function(){}},function(e,n){return N(t,e,n)},function(){return d(t).inspect()})}function R(t,e,n){return d(t).spread(e,n)}function U(t){return function(){function e(t,e){var a;if("undefined"==typeof StopIteration){try{a=n[t](e)}catch(t){return L(t)}return a.done?d(a.value):v(a.value,i,r)}try{a=n[t](e)}catch(t){return o(t)?d(t.value):L(t)}return v(a,i,r)}var n=t.apply(this,arguments),i=e.bind(e,"next"),r=e.bind(e,"throw");return i()}}function x(t){d.done(d.async(t)())}function C(t){throw new H(t)}function D(t){return function(){return R([this,k(arguments)],function(e,n){return t.apply(e,n)})}}function N(t,e,n){return d(t).dispatch(e,n)}function k(t){return v(t,function(t){var e=0,n=f();return Q(t,function(i,o,r){var a;m(o)&&"fulfilled"===(a=o.inspect()).state?t[r]=a.value:(++e,v(o,function(i){t[r]=i,0==--e&&n.resolve(t)},n.reject,function(t){n.notify({index:r,value:t})}))},void 0),0===e&&n.resolve(t),n.promise})}function M(t){if(0===t.length)return d.resolve();var e=d.defer(),n=0;return Q(t,function(i,o,r){function a(t){e.resolve(t)}function s(){0===--n&&e.reject(new Error("Can't get fulfillment value from any promise, all promises were rejected."))}function l(t){e.notify({index:r,value:t})}var c=t[r];n++,v(c,a,s,l)},void 0),e.promise}function F(t){return v(t,function(t){return t=J(t,d),v(k(J(t,function(t){return v(t,V,V)})),function(){return t})})}function B(t){return d(t).allSettled()}function j(t,e){return d(t).then(void 0,void 0,e)}function $(t,e){return d(t).nodeify(e)}var G=!1;try{throw new Error}catch(t){G=!!t.stack}var W,H,Y=u(),V=function(){},X=function(){function t(){for(var t,e;o.next;)o=o.next,t=o.task,o.task=void 0,e=o.domain,e&&(o.domain=void 0,e.enter()),i(t,e);for(;c.length;)t=c.pop(),i(t);a=!1}function i(e,n){try{e()}catch(e){if(l)throw n&&n.exit(),setTimeout(t,0),n&&n.enter(),e;setTimeout(function(){throw e},0)}n&&n.exit()}var o={task:void 0,next:null},r=o,a=!1,s=void 0,l=!1,c=[];if(X=function(t){r=r.next={task:t,domain:l&&e.domain,next:null},a||(a=!0,s())},"object"==typeof e&&"[object process]"===e.toString()&&e.nextTick)l=!0,s=function(){e.nextTick(t)};else if("function"==typeof n)s="undefined"!=typeof window?n.bind(window,t):function(){n(t)};else if("undefined"!=typeof MessageChannel){var u=new MessageChannel;u.port1.onmessage=function(){s=d,u.port1.onmessage=t,t()};var d=function(){u.port2.postMessage(0)};s=function(){setTimeout(t,0),d()}}else s=function(){setTimeout(t,0)};return X.runAfter=function(t){c.push(t),a||(a=!0,s())},X}(),q=Function.call,z=t(Array.prototype.slice),Q=t(Array.prototype.reduce||function(t,e){var n=0,i=this.length;if(1===arguments.length)for(;;){if(n in this){e=this[n++];break}if(++n>=i)throw new TypeError}for(;n<i;n++)n in this&&(e=t(e,this[n],n));return e}),K=t(Array.prototype.indexOf||function(t){for(var e=0;e<this.length;e++)if(this[e]===t)return e;return-1}),J=t(Array.prototype.map||function(t,e){var n=this,i=[];return Q(n,function(o,r,a){i.push(t.call(e,r,a,n))},void 0),i}),Z=Object.create||function(t){function e(){}return e.prototype=t,new e},tt=t(Object.prototype.hasOwnProperty),et=Object.keys||function(t){var e=[];for(var n in t)tt(t,n)&&e.push(n);return e},nt=t(Object.prototype.toString);H="undefined"!=typeof ReturnValue?ReturnValue:function(t){this.value=t};var it="From previous event:";d.resolve=d,d.nextTick=X,d.longStackSupport=!1,"object"==typeof e&&e&&e.env&&e.env.Q_DEBUG&&(d.longStackSupport=!0),d.defer=f,f.prototype.makeNodeResolver=function(){var t=this;return function(e,n){e?t.reject(e):arguments.length>2?t.resolve(z(arguments,1)):t.resolve(n)}},d.Promise=p,d.promise=p,p.race=h,p.all=k,p.reject=L,p.resolve=d,d.passByCopy=function(t){return t},g.prototype.passByCopy=function(){return this},d.join=function(t,e){return d(t).join(e)},g.prototype.join=function(t){return d([this,t]).spread(function(t,e){if(t===e)return t;throw new Error("Can't join: not the same: "+t+" "+e)})},d.race=h,g.prototype.race=function(){return this.then(d.race)},d.makePromise=g,g.prototype.toString=function(){return"[object Promise]"},g.prototype.then=function(t,e,n){function i(e){try{return"function"==typeof t?t(e):e}catch(t){return L(t)}}function o(t){if("function"==typeof e){r(t,s);try{return e(t)}catch(t){return L(t)}}return L(t)}function a(t){return"function"==typeof n?n(t):t}var s=this,l=f(),c=!1;return d.nextTick(function(){s.promiseDispatch(function(t){c||(c=!0,l.resolve(i(t)))},"when",[function(t){c||(c=!0,l.resolve(o(t)))}])}),s.promiseDispatch(void 0,"when",[void 0,function(t){var e,n=!1;try{e=a(t)}catch(t){if(n=!0,!d.onerror)throw t;d.onerror(t)}n||l.notify(e)}]),l.promise},d.tap=function(t,e){return d(t).tap(e)},g.prototype.tap=function(t){return t=d(t),this.then(function(e){return t.fcall(e).thenResolve(e)})},d.when=v,g.prototype.thenResolve=function(t){return this.then(function(){return t})},d.thenResolve=function(t,e){return d(t).thenResolve(e)},g.prototype.thenReject=function(t){return this.then(function(){throw t})},d.thenReject=function(t,e){return d(t).thenReject(e)},d.nearer=b,d.isPromise=m,d.isPromiseAlike=y,d.isPending=_,g.prototype.isPending=function(){return"pending"===this.inspect().state},d.isFulfilled=T,g.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},d.isRejected=w,g.prototype.isRejected=function(){return"rejected"===this.inspect().state};var ot=[],rt=[],at=[],st=!0;d.resetUnhandledRejections=E,d.getUnhandledReasons=function(){return ot.slice()},d.stopUnhandledRejectionTracking=function(){E(),st=!1},E(),d.reject=L,d.fulfill=S,d.master=P,d.spread=R,g.prototype.spread=function(t,e){return this.all().then(function(e){return t.apply(void 0,e)},e)},d.async=U,d.spawn=x,d.return=C,d.promised=D,d.dispatch=N,g.prototype.dispatch=function(t,e){var n=this,i=f();return d.nextTick(function(){n.promiseDispatch(i.resolve,t,e)}),i.promise},d.get=function(t,e){return d(t).dispatch("get",[e])},g.prototype.get=function(t){return this.dispatch("get",[t])},d.set=function(t,e,n){return d(t).dispatch("set",[e,n])},g.prototype.set=function(t,e){return this.dispatch("set",[t,e])},d.del=d.delete=function(t,e){return d(t).dispatch("delete",[e])},g.prototype.del=g.prototype.delete=function(t){return this.dispatch("delete",[t])},d.mapply=d.post=function(t,e,n){return d(t).dispatch("post",[e,n])},g.prototype.mapply=g.prototype.post=function(t,e){return this.dispatch("post",[t,e])},d.send=d.mcall=d.invoke=function(t,e){return d(t).dispatch("post",[e,z(arguments,2)])},g.prototype.send=g.prototype.mcall=g.prototype.invoke=function(t){return this.dispatch("post",[t,z(arguments,1)])},d.fapply=function(t,e){return d(t).dispatch("apply",[void 0,e])},g.prototype.fapply=function(t){return this.dispatch("apply",[void 0,t])},d.try=d.fcall=function(t){return d(t).dispatch("apply",[void 0,z(arguments,1)])},g.prototype.fcall=function(){return this.dispatch("apply",[void 0,z(arguments)])},d.fbind=function(t){var e=d(t),n=z(arguments,1);return function(){return e.dispatch("apply",[this,n.concat(z(arguments))])}},g.prototype.fbind=function(){var t=this,e=z(arguments);return function(){return t.dispatch("apply",[this,e.concat(z(arguments))])}},d.keys=function(t){return d(t).dispatch("keys",[])},g.prototype.keys=function(){return this.dispatch("keys",[])},d.all=k,g.prototype.all=function(){return k(this)},d.any=M,g.prototype.any=function(){return M(this)},d.allResolved=function(t,e,n){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(e+" is deprecated, use "+n+" instead.",new Error("").stack),t.apply(t,arguments)}}(F,"allResolved","allSettled"),g.prototype.allResolved=function(){return F(this)},d.allSettled=B,g.prototype.allSettled=function(){return this.then(function(t){return k(J(t,function(t){function e(){return t.inspect()}return t=d(t),t.then(e,e)}))})},d.fail=d.catch=function(t,e){return d(t).then(void 0,e)},g.prototype.fail=g.prototype.catch=function(t){return this.then(void 0,t)},d.progress=j,g.prototype.progress=function(t){return this.then(void 0,void 0,t)},d.fin=d.finally=function(t,e){return d(t).finally(e)},g.prototype.fin=g.prototype.finally=function(t){return t=d(t),this.then(function(e){return t.fcall().then(function(){return e})},function(e){return t.fcall().then(function(){throw e})})},d.done=function(t,e,n,i){return d(t).done(e,n,i)},g.prototype.done=function(t,n,i){var o=function(t){d.nextTick(function(){if(r(t,a),!d.onerror)throw t;d.onerror(t)})},a=t||n||i?this.then(t,n,i):this;"object"==typeof e&&e&&e.domain&&(o=e.domain.bind(o)),a.then(void 0,o)},d.timeout=function(t,e,n){return d(t).timeout(e,n)},g.prototype.timeout=function(t,e){var n=f(),i=setTimeout(function(){e&&"string"!=typeof e||(e=new Error(e||"Timed out after "+t+" ms"),e.code="ETIMEDOUT"),n.reject(e)},t);return this.then(function(t){clearTimeout(i),n.resolve(t)},function(t){clearTimeout(i),n.reject(t)},n.notify),n.promise},d.delay=function(t,e){return void 0===e&&(e=t,t=void 0),d(t).delay(e)},g.prototype.delay=function(t){return this.then(function(e){var n=f();return setTimeout(function(){n.resolve(e)},t),n.promise})},d.nfapply=function(t,e){return d(t).nfapply(e)},g.prototype.nfapply=function(t){var e=f(),n=z(t);return n.push(e.makeNodeResolver()),this.fapply(n).fail(e.reject),e.promise},d.nfcall=function(t){var e=z(arguments,1);return d(t).nfapply(e)},g.prototype.nfcall=function(){var t=z(arguments),e=f();return t.push(e.makeNodeResolver()),this.fapply(t).fail(e.reject),e.promise},d.nfbind=d.denodeify=function(t){var e=z(arguments,1);return function(){var n=e.concat(z(arguments)),i=f();return n.push(i.makeNodeResolver()),d(t).fapply(n).fail(i.reject),i.promise}},g.prototype.nfbind=g.prototype.denodeify=function(){var t=z(arguments);return t.unshift(this),d.denodeify.apply(void 0,t)},d.nbind=function(t,e){var n=z(arguments,2);return function(){function i(){return t.apply(e,arguments)}var o=n.concat(z(arguments)),r=f();return o.push(r.makeNodeResolver()),d(i).fapply(o).fail(r.reject),r.promise}},g.prototype.nbind=function(){var t=z(arguments,0);return t.unshift(this),d.nbind.apply(void 0,t)},d.nmapply=d.npost=function(t,e,n){return d(t).npost(e,n)},g.prototype.nmapply=g.prototype.npost=function(t,e){var n=z(e||[]),i=f();return n.push(i.makeNodeResolver()),this.dispatch("post",[t,n]).fail(i.reject),i.promise},d.nsend=d.nmcall=d.ninvoke=function(t,e){var n=z(arguments,2),i=f();return n.push(i.makeNodeResolver()),d(t).dispatch("post",[e,n]).fail(i.reject),i.promise},g.prototype.nsend=g.prototype.nmcall=g.prototype.ninvoke=function(t){var e=z(arguments,1),n=f();return e.push(n.makeNodeResolver()),this.dispatch("post",[t,e]).fail(n.reject),n.promise},d.nodeify=$,g.prototype.nodeify=function(t){if(!t)return this;this.then(function(e){d.nextTick(function(){t(null,e)})},function(e){d.nextTick(function(){t(e)})})},d.noConflict=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var lt=u();return d})}).call(e,n(14),n(20).setImmediate)},,function(t,e,n){var i=n(3),o=n(1),r=n(4),a=n(5).sprintf,s=n(2),l=n(0),c=n(72);t.exports=i(c,{insertAngularDirectives:function(){if(0==this.getArticleHolders().length)return!1;var t=r("body");return t.attr({"ng-controller":"List as list"}),t.append(n(30)),this.insertButtons(),!0},bootstrapAngular:function(){s.bootstrap(r("body").get(0),["App"],{strictDi:!0})},get:function(){return o.map(this.getArticleHolders(),function(t){var e=r(t);return o.extend(this.getIdentifiers(e),{metadata:this.getMetadata(e)})}.bind(this))},getPlain:function(){return o.map(this.getArticleHolders(),function(t){return this.getIdentifiers(r(t))}.bind(this))},getIdentifiers:function(t){return{doi:null,pmid:null,gsid:null}},getMetadata:function(t){return{title:null,journal:null,year:null,authors:[]}},getArticleHolders:function(){return[]},isAbstractPage:function(){return!0},getButtonHolder:function(t){return t},insertButtons:function(){var t=n(59);o.each(this.getArticleHolders(),function(e,n){var i=a(t,n);this.getButtonHolder(r(e)).append(i)}.bind(this))},getAngularInjector:function(t,e){return e||(e=["$q","$http"]),e.push(t),s.injector(["ng"]).invoke(e)},getExecutePromise:function(){return this.getAngularInjector(function(t){return t.resolve("The angular app can be inserted")},["$q"])},getDoiFromElement:function(t){return t&&0!=t.length?o.get(t.text().match(l.REGEXP_DOI),"[0]",null):null}})},function(t,e){t.exports={100:"Continue",101:"Switching Protocols",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Time-out",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Large",415:"Unsupported Media Type",416:"Requested Range not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",429:"Too Many Requests",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Time-out",505:"HTTP Version not Supported",507:"Insufficient Storage",CONTINUE:100,SWITCHING_PROTOCOLS:101,OK:200,CREATED:201,ACCEPTED:202,NON_AUTHORITATIVE_INFORMATION:203,NO_CONTENT:204,RESET_CONTENT:205,PARTIAL_CONTENT:206,MULTIPLE_CHOICES:300,MOVED_PERMANENTLY:301,FOUND:302,SEE_OTHER:303,NOT_MODIFIED:304,USE_PROXY:305,TEMPORARY_REDIRECT:307,BAD_REQUEST:400,UNAUTHORIZED:401,PAYMENT_REQUIRED:402,FORBIDDEN:403,NOT_FOUND:404,METHOD_NOT_ALLOWED:405,NOT_ACCEPTABLE:406,PROXY_AUTHENTICATION_REQUIRED:407,REQUEST_TIMEOUT:408,CONFLICT:409,GONE:410,LENGTH_REQUIRED:411,PRECONDITION_FAILED:412,REQUEST_ENTITY_TOO_LARGE:413,REQUEST_URI_TOO_LONG:414,UNSUPPORTED_MEDIA_TYPE:415,REQUESTED_RANGE_NOT_SATISFIABLE:416,EXPECTATION_FAILED:417,UNPROCESSABLE_ENTITY:422,LOCKED:423,FAILED_DEPENDENCY:424,TOO_MANY_REQUESTS:429,UNAVAILABLE_FOR_LEGAL_REASONS:451,INTERNAL_SERVER_ERROR:500,NOT_IMPLEMENTED:501,BAD_GATEWAY:502,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,HTTP_VERSION_NOT_SUPPORTED:505,INSUFFICIENT_STORAGE:507}},function(t,e,n){var i=n(1),o=n(0),r=n(78);t.exports={splitAuthorString:function(t){return i.chain(t.split(/,\s|\sand\s/)).map(function(t){return i.trim(t)}).filter(function(t){return t}).value()},getAuthorsArray:function(t){return i.chain(t).thru(function(t){return t&&0!=t.length?t.split(","):[]}).map(function(t){return i.trim(t)}).value()},refmanToMetadata:function(t){function e(t){var e=i.find(n,function(e){return e[0]==t});return e?e[1]:""}var n=t.split("\r\n").filter(function(t){return t}).reduce(function(t,e){var n=e.split("  - ");return t.push(n),t},[]),a=i.flow([r.default,r.fullnameForAuthor]),s=n.reduce(function(t,e){return"A1"==e[0]&&t.push(a(e[1])),t},[]),l=i.get(e("Y1").match(o.REGEXP_YEAR),"0","");return{title:e("T1"),journal:e("JO"),year:l,authors:s,volume:e("VL")}}}},function(t,e,n){var i=n(1),o=n(9),r=n(0),a={getPdfFilenameFromUrl:function(t){return"string"!=typeof t||0===t.length?"":i.chain(o.parse(t)).get("pathname","").thru(function(t){return t.split("/")}).last().thru(function(t){var e=decodeURIComponent(t).toLowerCase();return i.endsWith(e,".pdf")?e:""}).value()},isReadcubeUrl:function(t){return-1!==t.indexOf(r.DOMAIN_READCUBE)},isUrlAbsolute:function(t){return t.indexOf("://")>0||0===t.indexOf("//")},isProtocol:function(t,e){return"string"==typeof t&&0!=t.length&&i.chain(o.parse(t)).get("protocol","").thru(function(t){return-1!==e.indexOf(t)}).value()},getHostnameFromUrl:function(t){return"string"!=typeof t||0===t.length?"":o.parse(t).hostname},getUrlWithoutQuery:function(t){return"string"!=typeof t||0===t.length?"":o.format(i.extend(o.parse(t),{hash:null,query:null,search:null}))},publisherWebsiteRegExps:i.reduce(r,function(t,e,n){return n.indexOf("URL_REGEXP_PUBLISHER")>-1?t.concat(e):t},[]),isPublisherWebsite:function(t){if("string"!=typeof t||0===t.length)return!1;var e=a.getUrlWithoutQuery(t);return a.publisherWebsiteRegExps.some(function(t){return"string"==typeof t?-1!==t.indexOf(e):t.test(e)})},isRsc:function(t){if("string"!=typeof t||0===t.length)return!1;var e=a.getUrlWithoutQuery(t);return r.URL_REGEXP_PUBLISHER_RSC.test(e)},isGoogleScholar:function(t){if("string"!=typeof t||0===t.length)return!1;var e=a.getUrlWithoutQuery(t);return r.URL_REGEXP_SOURCE_GOOGLE_SCHOLAR.test(e)},isPubmed:function(t){if("string"!=typeof t||0===t.length)return!1;var e=a.getUrlWithoutQuery(t);return r.URL_REGEXP_SOURCE_PUBMED.test(e)},isReadcubeWebLibrary:function(t){if("string"!=typeof t||0===t.length)return!1;var e=a.getUrlWithoutQuery(t);return r.URL_REGEXP_WEB_LIBRARY_URL.test(e)}};t.exports=a},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(t){if(u===setTimeout)return setTimeout(t,0);if((u===n||!u)&&setTimeout)return u=setTimeout,setTimeout(t,0);try{return u(t,0)}catch(e){try{return u.call(null,t,0)}catch(e){return u.call(this,t,0)}}}function r(t){if(d===clearTimeout)return clearTimeout(t);if((d===i||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(t);try{return d(t)}catch(e){try{return d.call(null,t)}catch(e){return d.call(this,t)}}}function a(){g&&p&&(g=!1,p.length?h=p.concat(h):v=-1,h.length&&s())}function s(){if(!g){var t=o(a);g=!0;for(var e=h.length;e;){for(p=h,h=[];++v<e;)p&&p[v].run();v=-1,e=h.length}p=null,g=!1,r(t)}}function l(t,e){this.fun=t,this.array=e}function c(){}var u,d,f=t.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:n}catch(t){u=n}try{d="function"==typeof clearTimeout?clearTimeout:i}catch(t){d=i}}();var p,h=[],g=!1,v=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];h.push(new l(t,e)),1!==h.length||g||o(s)},l.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=c,f.addListener=c,f.once=c,f.off=c,f.removeListener=c,f.removeAllListeners=c,f.emit=c,f.prependListener=c,f.prependOnceListener=c,f.listeners=function(t){return[]},f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(t,e,n){var i=n(3),o=n(1),r=n(0);n(9);t.exports=i({__constructor:function(t){this.id=null,this.pmid=null,this.doi=null,this.gsid=null,this.inLibraryStatus=r.STATUS_NOT_FOUND,this.isReadyForShowing=!1,this.metadata={},this.pdfUrl=null,this.usingPdfUrl=null,this.url=null,this.pdfHash=null,this.hasPdf=!1,this.note="",this.progressPercent=0,this.progressType=r.PROGRESS_DOWNLOAD,o.isObject(t)&&this.extend(t)},extend:function(t){return o.extend(this,t),this},getIdentifiers:function(){return o.pick(this,["doi","pmid","gsid"])},setInLibraryStatus:function(t,e){return t==r.STATUS_IN_LIBRARY?e?this.hasPdf?this.inLibraryStatus=r.STATUS_IN_LIBRARY_WITH_PDF:this.inLibraryStatus=r.STATUS_IN_LIBRARY_WITHOUT_PDF:this.inLibraryStatus=this.hasPdf?r.STATUS_IN_LIBRARY_WITH_PDF:r.STATUS_IN_LIBRARY:this.inLibraryStatus=r.STATUS_NOT_FOUND,this},isProcessingStatus:function(){return this.inLibraryStatus==r.STATUS_METADATA_ADDING||this.inLibraryStatus==r.STATUS_PDF_DOWNLOADING},finishProcessingStatus:function(t){this.hasPdf?this.inLibraryStatus=r.STATUS_IN_LIBRARY_WITH_PDF:this.inLibraryStatus==r.STATUS_METADATA_ADDING?this.inLibraryStatus=r.STATUS_NOT_FOUND:this.inLibraryStatus==r.STATUS_PDF_DOWNLOADING&&(this.inLibraryStatus=t?r.STATUS_IN_LIBRARY_WITHOUT_PDF_WARNING_PROXY:r.STATUS_IN_LIBRARY_WITHOUT_PDF_WARNING)},isInLibrary:function(){var t=!1;switch(this.inLibraryStatus){case r.STATUS_IN_LIBRARY:case r.STATUS_IN_LIBRARY_WITH_PDF:case r.STATUS_IN_LIBRARY_WITHOUT_PDF:case r.STATUS_IN_LIBRARY_WITHOUT_PDF_WARNING:case r.STATUS_IN_LIBRARY_WITHOUT_PDF_WARNING_PROXY:t=!0}return t},isPdfDownloadFailed:function(){var t=!1;switch(this.inLibraryStatus){case r.STATUS_IN_LIBRARY_WITHOUT_PDF_WARNING:case r.STATUS_IN_LIBRARY_WITHOUT_PDF_WARNING_PROXY:t=!0}return t},toJsonForAPI:function(t){var e={ext_ids:this.getIdentifiers(),note:null,return_item:!0};return e.ext_ids.gsid&&e.ext_ids.gsid.indexOf("null")>-1&&(e.ext_ids.gsid=null),o.get(t,"includeMetadata",!1)&&(e.article=this.metadata),o.get(t,"includeNote",!1)&&(e.note=this.note,e.user_data={notes:this.note}),e},toJson:function(){var t={};for(var e in this)"function"!=typeof this[e]&&(t[e]=this[e]);return t},getPdfUrl:function(){return this.pdfUrl?this.pdfUrl:null}})},,function(t,e,n){"use strict";var i=function(){function t(t,e){this.location=t,this.length=e}return t.prototype.notFound=function(){return void 0==this.location||null==this.location},t.prototype.maxRange=function(){return this.location+this.length},t.prototype.sliceArray=function(t){return t.slice(this.location,this.location+this.length)},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e,n){"use strict";function i(t){var e=t.toLowerCase(),n="."==e[e.length-1]?e.substring(0,e.length-1):e;return d[n]}function o(t){return t.trim().toLowerCase()}function r(t){return["firstName","middle","dropped","nondropped","lastName","suffix"].reduce(function(e,n){var i=t[n];return i?e?e+" "+i:i:e},"")}function a(t){for(var e,n,i=0,o=t;i<o.length;i++){var r=o[i];e?n=n?n+" "+r:r:e=r}return[e,n]}function s(t,e){void 0===e&&(e=!1);var n=t.length;if(0==n)return new c.default;for(var i=new c.default,o=0,r=0,a=t;r<a.length;r++){var s=a[r];if((s.length>2||s.toUpperCase()!=s)&&(s=s.toLowerCase()),u.default[s]){i=new c.default(o,1);break}if(e)break;o++}if(n<2)return i;if(i.notFound())return i;if(void 0==i.location)return i;var l=n-1;for(e&&(l=1),o=i.location;o<l;o++){var d=t[o].toLowerCase(),f=t[o+1].toLowerCase(),p=[d,f],h=p.join(" ");if(u.default[h])return new c.default(o,2)}return i}function l(t){var e=t.join(" "),n=u.default[e.toLowerCase()],i=n[0],r=n[1],a=o(e).length<2,s=a||e.toUpperCase()!=e,l=o(i+" "+r),d=o(e)==l;if(s&&d){for(var f=0,p=0,h=t.length,g=function(t,e,n){var i=t-e+1;return new c.default(e,i).sliceArray(n).join(" ")},v="",b=i.toLowerCase();p<h&&v.toLowerCase()!=b;)v=g(p,f,t),p++;f=p;for(var m="",y=r.toLowerCase();p<h&&m.toLowerCase()!=y;)m=g(p,f,t),p++;i=v,r=m}return[i,r]}var c=n(17),u=n(79),d={jr:"Jr",sr:"Sr",ii:"II",iii:"III",iv:"IV",v:"V"};e.tryGetSuffix=i,e.canonicalString=o,e.fullnameForAuthor=r,e.firstAndMiddleFromTokens=a,e.particlesRangeInTokens=s,e.splitParticleParts=l},function(t,e,n){(function(t,e){!function(t,n){"use strict";function i(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:t,args:e};return c[l]=i,s(l),l++}function o(t){delete c[t]}function r(t){var e=t.callback,i=t.args;switch(i.length){case 0:e();break;case 1:e(i[0]);break;case 2:e(i[0],i[1]);break;case 3:e(i[0],i[1],i[2]);break;default:e.apply(n,i)}}function a(t){if(u)setTimeout(a,0,t);else{var e=c[t];if(e){u=!0;try{r(e)}finally{o(t),u=!1}}}}if(!t.setImmediate){var s,l=1,c={},u=!1,d=t.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(t);f=f&&f.setTimeout?f:t,"[object process]"==={}.toString.call(t.process)?function(){s=function(t){e.nextTick(function(){a(t)})}}():function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?function(){var e="setImmediate$"+Math.random()+"$",n=function(n){n.source===t&&"string"==typeof n.data&&0===n.data.indexOf(e)&&a(+n.data.slice(e.length))};t.addEventListener?t.addEventListener("message",n,!1):t.attachEvent("onmessage",n),s=function(n){t.postMessage(e+n,"*")}}():t.MessageChannel?function(){var t=new MessageChannel;t.port1.onmessage=function(t){a(t.data)},s=function(e){t.port2.postMessage(e)}}():d&&"onreadystatechange"in d.createElement("script")?function(){var t=d.documentElement;s=function(e){var n=d.createElement("script");n.onreadystatechange=function(){a(e),n.onreadystatechange=null,t.removeChild(n),n=null},t.appendChild(n)}}():function(){s=function(t){setTimeout(a,0,t)}}(),f.setImmediate=i,f.clearImmediate=o}}("undefined"==typeof self?void 0===t?this:t:self)}).call(e,n(16),n(14))},function(t,e,n){function i(t,e){this._id=t,this._clearFn=e}var o=Function.prototype.apply;e.setTimeout=function(){return new i(o.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new i(o.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(19),e.setImmediate=setImmediate,e.clearImmediate=clearImmediate},function(t,e,n){var i=n(2),o=n(0);i.module("App").run(["Mixpanel",function(t){var e=chrome.runtime.getManifest().version;t.setProperty(o.MIXPANEL_PROPERTY_BROWSER_EXTENSION_VERSION,e);var n={};n[o.MIXPANEL_SUPER_PROPERTY_CLIENT]="Browser Ext",n[o.MIXPANEL_SUPER_PROPERTY_BROWSER_EXTENSION_VERSION]=e,t.setSuperProperty(n),t.union(o.MIXPANEL_PROPERTY_CLIENTS_USED,"browser_ext")}])},function(t,e,n){function i(t,e){var n=!1;r.init(a.MIXPANEL_TOKEN,{api_host:a.MIXPANEL_API_URL});var i={get:function(){return n?t.resolve(r):(n=!0,e.evaluateLoggedInUserDetail().then(function(e){return e.id?(r.identify(e.id),r):t.reject("Unable to get user id")}).catch(function(e){return console.error(e),t.reject(e)}))},getObjectFromParams:function(t,e){var n={};return"string"==typeof t?n[t]=e:n=t,n},setProperty:function(t,e){return i.get().then(function(n){return n.people.set(i.getObjectFromParams(t,e)),!0})},setSuperProperty:function(t,e){return i.get().then(function(n){return n.register(i.getObjectFromParams(t,e)),!0})},incrementProperty:function(t,e){return i.get().then(function(n){return n.people.increment(i.getObjectFromParams(t,e)),!0})},trackEvent:function(t,e){return i.get().then(function(n){return n.track(t,e),!0})},union:function(t,e){return i.get().then(function(n){return n.people.union(t,e),!0})}};return i}i.$inject=["$q","User"];var o=n(2),r=n(47),a=n(0);o.module("App").factory("Mixpanel",i)},function(t,e,n){function i(t){return{sendToBackground:function(e,n){var i=t.defer();return chrome.runtime.sendMessage({method:e,data:n},function(t){i.resolve(t)}),i.promise},listenForMessages:function(t){function e(e,n,i){return t(e,i),!0}chrome.runtime.onMessage.addListener(e),window.onbeforeunload=function(){chrome.runtime.onMessage.hasListener(e)&&chrome.runtime.onMessage.removeListener(e)}},sendToActiveTab:function(e){var n=t.defer();return chrome.tabs.query({active:!0,currentWindow:!0},function(t){if(0==t.length)return void n.reject("No active tabs were found");chrome.tabs.sendMessage(t[0].id,e,n.resolve)}),n.promise}}}i.$inject=["$q"],n(2).module("App").factory("Message",i)},function(t,e,n){function i(t,e,n){var i={INITIAL:0,PROCESSING:1,DONE:2},o=i.INITIAL,c=[],u={getLoggedInUserDetails:function(){return e.get(r.STORAGE_KEY_LOGGED_IN_USER_DETAILS,null).then(function(t){return a.get(t,"id")?t:n.reject("User data not available in the storage")})},evaluateLoggedInUserDetail:function(){var t=this,e=n.defer();if(o===i.INITIAL)o=i.PROCESSING,c.push(e),t.queryUserDetails().then(function(t){u.setLoggedInUserDetails(t),o=i.DONE,c.forEach(function(e){e.resolve(t)})}).catch(function(e){t.clearLoggedInUserDetails(),o=i.INITIAL,c.forEach(function(t){t.reject(e)})}).finally(function(){c=[]});else{if(o!==i.PROCESSING)return u.getLoggedInUserDetails();c.push(e)}return e.promise},clearProcessingStatus:function(){o=i.INITIAL},getInstitutionProxy:function(){return this.evaluateLoggedInUserDetail().then(function(t){switch(a.get(t,"proxy_url_selection",null)){case r.VALUE_PROXY_URL_SELECTION_NONE:case r.VALUE_PROXY_URL_SELECTION_NULL:return n.reject('Proxy url selection is "none" or "null"');case r.VALUE_PROXY_URL_SELECTION_MANUAL:var e=a.get(t,"proxy_url",null);return e||n.reject("Proxy url is not available");case r.VALUE_PROXY_URL_SELECTION_INSTITUTION:var i=a.get(t,"institution_proxy_url",null);return i||n.reject("Institution proxy url is not available");default:return n.reject("Unknown proxy selection option")}})},getSfxUrlByDoiAndPmid:function(t,e){return this.evaluateLoggedInUserDetail().then(function(i){var o=a.get(i,"sfx_url",null);if(!o)return n.reject("Sfx url is not available");var r=l.parse(o,!0);return t&&(r.query.__DOI__="doi:"+t),e&&(r.query.__PMID__="pmid:"+e),l.format(r).replace("__DOI__","id").replace("__PMID__","id")})},getSubscriptionStatus:function(){return this.querySubscriptionStatus().then(function(t){return"free"===t.account?"expired"===t.status?"trial"===t.previous_type?r.SUBSCRIPTION_TRIAL_EXPIRED:r.SUBSCRIPTION_PRO_EXPIRED:r.SUBSCRIPTION_FREE:r.SUBSCRIPTION_PRO}).catch(function(){return r.SUBSCRIPTION_FREE})},setLoggedInUserDetails:function(t){e.set(r.STORAGE_KEY_LOGGED_IN_USER_DETAILS,t)},clearLoggedInUserDetails:function(){e.set(r.STORAGE_KEY_LOGGED_IN_USER_DETAILS,null),e.set(r.STORAGE_KEY_DISPLAYED_GO_PRO_TOOLTIP,!1)},queryUserDetails:function(){return s.get(r.URL_USER_DETAILS).then(function(t){var e=a.get(t,"data",null);return e?{email:e.email,name:e.full_name,id:e.id,institution:e.institution,institution_proxy_url:e.institution_proxy_url,proxy_url:e.proxy_url,proxy_url_selection:e.proxy_url_selection,sfx_url:e.sfx_url}:n.reject("Unable to get user details")})},querySubscriptionStatus:function(){return s.get(r.URL_SUBSCRIPTION_STATUS).then(function(t){var e=a.get(t,"data",null);return e||n.reject("Unable to load subscription details")})},logout:function(){return s.get(r.URL_LOGOUT,!0)}};return u}i.$inject=["$http","Storage","$q"];var o=n(2),r=n(0),a=n(1),s=n(7),l=n(9);o.module("App").factory("User",i)},function(t,e){function n(t){for(var e=atob(t.split(",")[1]),n=new ArrayBuffer(e.length),i=new Uint8Array(n),o=0;o<e.length;o++)i[o]=e.charCodeAt(o);return n}e.toArrayBuffer=n,e.toBlob=function(t){return new Blob([n(t)])}},function(t,e,n){var i=chrome.storage.local,o=n(8);t.exports={get:function(t,e){void 0===e&&(e=null);var n=o.defer();return i.get(t,function(i){"string"==typeof t&&null==i[t]?n.resolve(e):"object"==typeof t&&null==i?n.resolve(e):"string"==typeof t?n.resolve(i[t]):n.resolve(i)}),n.promise},set:function(t,e){var n={},r=o.defer();if("string"==typeof t)n[t]=e;else{if("object"!=typeof t)return!1;n=t}return i.set(n,r.resolve),r.promise}}},function(t,e,n){"use strict";function i(t){for(var e="",n=0;n<o.default.length;n++){var i=o.default[n],r=t[i];r&&(e=e+"["+(n+1)+"] "+r+" ")}return e}var o=n(75);Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e,n){"use strict";function i(t){return t.split(/{(.+)}|\s/).filter(function(t){return t})}Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e){t.exports='<div class="tether-content">\n  <div class="readcube-tooltip {{ viewClass }}">\n    <div class="readcube-tooltip-icons">\n      <span ng-if="viewRetry == \'yes\'" title="Retry" class="readcube-icon-close"\n            ng-click="onRetryClick($event)">&#8634;</span>\n      <span ng-if="viewClose == \'yes\'" title="Close tooltip" class="readcube-icon-close"\n            ng-click="onCloseTooltipClick($event)">×</span>\n    </div>\n\n    <div ng-include="viewUrl" ng-if="viewUrl" ng-controller="PdfWarning"></div>\n    <div class="readcube-tooltip-title" ng-if="viewText">{{ viewText }}</div>\n  </div>\n</div>'},function(t,e){t.exports='<div list-dropdown id="readcube-injected-button-dropdown" on-add-to-library-click="list.onAddToLibraryClick(index)" is-below-button="true" should-display-add-button="true"></div>\n<div login-iframe when-successfully-logged-in="list.onSuccessfullyLoggedIn(userData)" show="list.loginIframe.show"></div>\n'},function(t,e,n){var i,o;/*! tether 1.4.0 */
!function(r,a){i=a,void 0!==(o="function"==typeof i?i.call(e,n,e,t):i)&&(t.exports=o)}(0,function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t){var e=t.getBoundingClientRect(),n={};for(var i in e)n[i]=e[i];if(t.ownerDocument!==document){var r=t.ownerDocument.defaultView.frameElement;if(r){var a=o(r);n.top+=a.top,n.bottom+=a.top,n.left+=a.left,n.right+=a.left}}return n}function r(t){var e=getComputedStyle(t)||{},n=e.position,i=[];if("fixed"===n)return[t];for(var o=t;(o=o.parentNode)&&o&&1===o.nodeType;){var r=void 0;try{r=getComputedStyle(o)}catch(t){}if(void 0===r||null===r)return i.push(o),i;var a=r,s=a.overflow,l=a.overflowX;/(auto|scroll)/.test(s+a.overflowY+l)&&("absolute"!==n||["relative","absolute","fixed"].indexOf(r.position)>=0)&&i.push(o)}return i.push(t.ownerDocument.body),t.ownerDocument!==document&&i.push(t.ownerDocument.defaultView),i}function a(){I&&document.body.removeChild(I),I=null}function s(t){var e=void 0;t===document?(e=document,t=document.documentElement):e=t.ownerDocument;var n=e.documentElement,i=o(t),r=O();return i.top-=r.top,i.left-=r.left,void 0===i.width&&(i.width=document.body.scrollWidth-i.left-i.right),void 0===i.height&&(i.height=document.body.scrollHeight-i.top-i.bottom),i.top=i.top-n.clientTop,i.left=i.left-n.clientLeft,i.right=e.body.clientWidth-i.width-i.left,i.bottom=e.body.clientHeight-i.height-i.top,i}function l(t){return t.offsetParent||document.documentElement}function c(){if(P)return P;var t=document.createElement("div");t.style.width="100%",t.style.height="200px";var e=document.createElement("div");u(e.style,{position:"absolute",top:0,left:0,pointerEvents:"none",visibility:"hidden",width:"200px",height:"150px",overflow:"hidden"}),e.appendChild(t),document.body.appendChild(e);var n=t.offsetWidth;e.style.overflow="scroll";var i=t.offsetWidth;n===i&&(i=e.clientWidth),document.body.removeChild(e);var o=n-i;return P={width:o,height:o}}function u(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=[];return Array.prototype.push.apply(e,arguments),e.slice(1).forEach(function(e){if(e)for(var n in e)({}).hasOwnProperty.call(e,n)&&(t[n]=e[n])}),t}function d(t,e){if(void 0!==t.classList)e.split(" ").forEach(function(e){e.trim()&&t.classList.remove(e)});else{var n=new RegExp("(^| )"+e.split(" ").join("|")+"( |$)","gi"),i=h(t).replace(n," ");g(t,i)}}function f(t,e){if(void 0!==t.classList)e.split(" ").forEach(function(e){e.trim()&&t.classList.add(e)});else{d(t,e);var n=h(t)+" "+e;g(t,n)}}function p(t,e){if(void 0!==t.classList)return t.classList.contains(e);var n=h(t);return new RegExp("(^| )"+e+"( |$)","gi").test(n)}function h(t){return t.className instanceof t.ownerDocument.defaultView.SVGAnimatedString?t.className.baseVal:t.className}function g(t,e){t.setAttribute("class",e)}function v(t,e,n){n.forEach(function(n){-1===e.indexOf(n)&&p(t,n)&&d(t,n)}),e.forEach(function(e){p(t,e)||f(t,e)})}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function m(t,e){var n=arguments.length<=2||void 0===arguments[2]?1:arguments[2];return t+n>=e&&e>=t-n}function y(){return"undefined"!=typeof performance&&void 0!==performance.now?performance.now():+new Date}function _(){for(var t={top:0,left:0},e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];return n.forEach(function(e){var n=e.top,i=e.left;"string"==typeof n&&(n=parseFloat(n,10)),"string"==typeof i&&(i=parseFloat(i,10)),t.top+=n,t.left+=i}),t}function T(t,e){return"string"==typeof t.left&&-1!==t.left.indexOf("%")&&(t.left=parseFloat(t.left,10)/100*e.width),"string"==typeof t.top&&-1!==t.top.indexOf("%")&&(t.top=parseFloat(t.top,10)/100*e.height),t}function w(t,e){return"scrollParent"===e?e=t.scrollParents[0]:"window"===e&&(e=[pageXOffset,pageYOffset,innerWidth+pageXOffset,innerHeight+pageYOffset]),e===document&&(e=e.documentElement),void 0!==e.nodeType&&function(){var t=e,n=s(e),i=n,o=getComputedStyle(e);if(e=[i.left,i.top,n.width+i.left,n.height+i.top],t.ownerDocument!==document){var r=t.ownerDocument.defaultView;e[0]+=r.pageXOffset,e[1]+=r.pageYOffset,e[2]+=r.pageXOffset,e[3]+=r.pageYOffset}z.forEach(function(t,n){t=t[0].toUpperCase()+t.substr(1),"Top"===t||"Left"===t?e[n]+=parseFloat(o["border"+t+"Width"]):e[n]-=parseFloat(o["border"+t+"Width"])})}(),e}var E=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),A=void 0;void 0===A&&(A={modules:[]});var I=null,L=function(){var t=0;return function(){return++t}}(),S={},O=function(){var t=I;t&&document.body.contains(t)||(t=document.createElement("div"),t.setAttribute("data-tether-id",L()),u(t.style,{top:0,left:0,position:"absolute"}),document.body.appendChild(t),I=t);var e=t.getAttribute("data-tether-id");return void 0===S[e]&&(S[e]=o(t),U(function(){delete S[e]})),S[e]},P=null,R=[],U=function(t){R.push(t)},x=function(){for(var t=void 0;t=R.pop();)t()},C=function(){function t(){i(this,t)}return E(t,[{key:"on",value:function(t,e,n){var i=!(arguments.length<=3||void 0===arguments[3])&&arguments[3];void 0===this.bindings&&(this.bindings={}),void 0===this.bindings[t]&&(this.bindings[t]=[]),this.bindings[t].push({handler:e,ctx:n,once:i})}},{key:"once",value:function(t,e,n){this.on(t,e,n,!0)}},{key:"off",value:function(t,e){if(void 0!==this.bindings&&void 0!==this.bindings[t])if(void 0===e)delete this.bindings[t];else for(var n=0;n<this.bindings[t].length;)this.bindings[t][n].handler===e?this.bindings[t].splice(n,1):++n}},{key:"trigger",value:function(t){if(void 0!==this.bindings&&this.bindings[t]){for(var e=0,n=arguments.length,i=Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];for(;e<this.bindings[t].length;){var r=this.bindings[t][e],a=r.handler,s=r.ctx,l=r.once,c=s;void 0===c&&(c=this),a.apply(c,i),l?this.bindings[t].splice(e,1):++e}}}}]),t}();A.Utils={getActualBoundingClientRect:o,getScrollParents:r,getBounds:s,getOffsetParent:l,extend:u,addClass:f,removeClass:d,hasClass:p,updateClasses:v,defer:U,flush:x,uniqueId:L,Evented:C,getScrollBarSize:c,removeUtilElements:a};var D=function(){function t(t,e){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){o=!0,r=t}finally{try{!i&&s.return&&s.return()}finally{if(o)throw r}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),E=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),N=function(t,e,n){for(var i=!0;i;){var o=t,r=e,a=n;i=!1,null===o&&(o=Function.prototype);var s=Object.getOwnPropertyDescriptor(o,r);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var c=Object.getPrototypeOf(o);if(null===c)return;t=c,e=r,n=a,i=!0,s=c=void 0}};if(void 0===A)throw new Error("You must include the utils.js file before tether.js");var k=A.Utils,r=k.getScrollParents,s=k.getBounds,l=k.getOffsetParent,u=k.extend,f=k.addClass,d=k.removeClass,v=k.updateClasses,U=k.defer,x=k.flush,c=k.getScrollBarSize,a=k.removeUtilElements,M=function(){if("undefined"==typeof document)return"";for(var t=document.createElement("div"),e=["transform","WebkitTransform","OTransform","MozTransform","msTransform"],n=0;n<e.length;++n){var i=e[n];if(void 0!==t.style[i])return i}}(),F=[],B=function(){F.forEach(function(t){t.position(!1)}),x()};!function(){var t=null,e=null,n=null,i=function i(){if(void 0!==e&&e>16)return e=Math.min(e-16,250),void(n=setTimeout(i,250));void 0!==t&&y()-t<10||(null!=n&&(clearTimeout(n),n=null),t=y(),B(),e=y()-t)};"undefined"!=typeof window&&void 0!==window.addEventListener&&["resize","scroll","touchmove"].forEach(function(t){window.addEventListener(t,i)})}();var j={center:"center",left:"right",right:"left"},$={middle:"middle",top:"bottom",bottom:"top"},G={top:0,left:0,middle:"50%",center:"50%",bottom:"100%",right:"100%"},W=function(t,e){var n=t.left,i=t.top;return"auto"===n&&(n=j[e.left]),"auto"===i&&(i=$[e.top]),{left:n,top:i}},H=function(t){var e=t.left,n=t.top;return void 0!==G[t.left]&&(e=G[t.left]),void 0!==G[t.top]&&(n=G[t.top]),{left:e,top:n}},Y=function(t){var e=t.split(" "),n=D(e,2);return{top:n[0],left:n[1]}},V=Y,X=function(t){function e(t){var n=this;i(this,e),N(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.position=this.position.bind(this),F.push(this),this.history=[],this.setOptions(t,!1),A.modules.forEach(function(t){void 0!==t.initialize&&t.initialize.call(n)}),this.position()}return b(e,t),E(e,[{key:"getClass",value:function(){var t=arguments.length<=0||void 0===arguments[0]?"":arguments[0],e=this.options.classes;return void 0!==e&&e[t]?this.options.classes[t]:this.options.classPrefix?this.options.classPrefix+"-"+t:t}},{key:"setOptions",value:function(t){var e=this,n=arguments.length<=1||void 0===arguments[1]||arguments[1],i={offset:"0 0",targetOffset:"0 0",targetAttachment:"auto auto",classPrefix:"tether"};this.options=u(i,t);var o=this.options,a=o.element,s=o.target,l=o.targetModifier;if(this.element=a,this.target=s,this.targetModifier=l,"viewport"===this.target?(this.target=document.body,this.targetModifier="visible"):"scroll-handle"===this.target&&(this.target=document.body,this.targetModifier="scroll-handle"),["element","target"].forEach(function(t){if(void 0===e[t])throw new Error("Tether Error: Both element and target must be defined");void 0!==e[t].jquery?e[t]=e[t][0]:"string"==typeof e[t]&&(e[t]=document.querySelector(e[t]))}),f(this.element,this.getClass("element")),!1!==this.options.addTargetClasses&&f(this.target,this.getClass("target")),!this.options.attachment)throw new Error("Tether Error: You must provide an attachment");this.targetAttachment=V(this.options.targetAttachment),this.attachment=V(this.options.attachment),this.offset=Y(this.options.offset),this.targetOffset=Y(this.options.targetOffset),void 0!==this.scrollParents&&this.disable(),"scroll-handle"===this.targetModifier?this.scrollParents=[this.target]:this.scrollParents=r(this.target),!1!==this.options.enabled&&this.enable(n)}},{key:"getTargetBounds",value:function(){if(void 0===this.targetModifier)return s(this.target);if("visible"===this.targetModifier){if(this.target===document.body)return{top:pageYOffset,left:pageXOffset,height:innerHeight,width:innerWidth};var t=s(this.target),e={height:t.height,width:t.width,top:t.top,left:t.left};return e.height=Math.min(e.height,t.height-(pageYOffset-t.top)),e.height=Math.min(e.height,t.height-(t.top+t.height-(pageYOffset+innerHeight))),e.height=Math.min(innerHeight,e.height),e.height-=2,e.width=Math.min(e.width,t.width-(pageXOffset-t.left)),e.width=Math.min(e.width,t.width-(t.left+t.width-(pageXOffset+innerWidth))),e.width=Math.min(innerWidth,e.width),e.width-=2,e.top<pageYOffset&&(e.top=pageYOffset),e.left<pageXOffset&&(e.left=pageXOffset),e}if("scroll-handle"===this.targetModifier){var t=void 0,n=this.target;n===document.body?(n=document.documentElement,t={left:pageXOffset,top:pageYOffset,height:innerHeight,width:innerWidth}):t=s(n);var i=getComputedStyle(n),o=n.scrollWidth>n.clientWidth||[i.overflow,i.overflowX].indexOf("scroll")>=0||this.target!==document.body,r=0;o&&(r=15);var a=t.height-parseFloat(i.borderTopWidth)-parseFloat(i.borderBottomWidth)-r,e={width:15,height:.975*a*(a/n.scrollHeight),left:t.left+t.width-parseFloat(i.borderLeftWidth)-15},l=0;a<408&&this.target===document.body&&(l=-11e-5*Math.pow(a,2)-.00727*a+22.58),this.target!==document.body&&(e.height=Math.max(e.height,24));var c=this.target.scrollTop/(n.scrollHeight-a);return e.top=c*(a-e.height-l)+t.top+parseFloat(i.borderTopWidth),this.target===document.body&&(e.height=Math.max(e.height,24)),e}}},{key:"clearCache",value:function(){this._cache={}}},{key:"cache",value:function(t,e){return void 0===this._cache&&(this._cache={}),void 0===this._cache[t]&&(this._cache[t]=e.call(this)),this._cache[t]}},{key:"enable",value:function(){var t=this,e=arguments.length<=0||void 0===arguments[0]||arguments[0];!1!==this.options.addTargetClasses&&f(this.target,this.getClass("enabled")),f(this.element,this.getClass("enabled")),this.enabled=!0,this.scrollParents.forEach(function(e){e!==t.target.ownerDocument&&e.addEventListener("scroll",t.position)}),e&&this.position()}},{key:"disable",value:function(){var t=this;d(this.target,this.getClass("enabled")),d(this.element,this.getClass("enabled")),this.enabled=!1,void 0!==this.scrollParents&&this.scrollParents.forEach(function(e){e.removeEventListener("scroll",t.position)})}},{key:"destroy",value:function(){var t=this;this.disable(),F.forEach(function(e,n){e===t&&F.splice(n,1)}),0===F.length&&a()}},{key:"updateAttachClasses",value:function(t,e){var n=this;t=t||this.attachment,e=e||this.targetAttachment;var i=["left","top","bottom","right","middle","center"];void 0!==this._addAttachClasses&&this._addAttachClasses.length&&this._addAttachClasses.splice(0,this._addAttachClasses.length),void 0===this._addAttachClasses&&(this._addAttachClasses=[]);var o=this._addAttachClasses;t.top&&o.push(this.getClass("element-attached")+"-"+t.top),t.left&&o.push(this.getClass("element-attached")+"-"+t.left),e.top&&o.push(this.getClass("target-attached")+"-"+e.top),e.left&&o.push(this.getClass("target-attached")+"-"+e.left);var r=[];i.forEach(function(t){r.push(n.getClass("element-attached")+"-"+t),r.push(n.getClass("target-attached")+"-"+t)}),U(function(){void 0!==n._addAttachClasses&&(v(n.element,n._addAttachClasses,r),!1!==n.options.addTargetClasses&&v(n.target,n._addAttachClasses,r),delete n._addAttachClasses)})}},{key:"position",value:function(){var t=this,e=arguments.length<=0||void 0===arguments[0]||arguments[0];if(this.enabled){this.clearCache();var n=W(this.targetAttachment,this.attachment);this.updateAttachClasses(this.attachment,n);var i=this.cache("element-bounds",function(){return s(t.element)}),o=i.width,r=i.height;if(0===o&&0===r&&void 0!==this.lastSize){var a=this.lastSize;o=a.width,r=a.height}else this.lastSize={width:o,height:r};var u=this.cache("target-bounds",function(){return t.getTargetBounds()}),d=u,f=T(H(this.attachment),{width:o,height:r}),p=T(H(n),d),h=T(this.offset,{width:o,height:r}),g=T(this.targetOffset,d);f=_(f,h),p=_(p,g);for(var v=u.left+p.left-f.left,b=u.top+p.top-f.top,m=0;m<A.modules.length;++m){var y=A.modules[m],w=y.position.call(this,{left:v,top:b,targetAttachment:n,targetPos:u,elementPos:i,offset:f,targetOffset:p,manualOffset:h,manualTargetOffset:g,scrollbarSize:S,attachment:this.attachment});if(!1===w)return!1;void 0!==w&&"object"==typeof w&&(b=w.top,v=w.left)}var E={page:{top:b,left:v},viewport:{top:b-pageYOffset,bottom:pageYOffset-b-r+innerHeight,left:v-pageXOffset,right:pageXOffset-v-o+innerWidth}},I=this.target.ownerDocument,L=I.defaultView,S=void 0;return L.innerHeight>I.documentElement.clientHeight&&(S=this.cache("scrollbar-size",c),E.viewport.bottom-=S.height),L.innerWidth>I.documentElement.clientWidth&&(S=this.cache("scrollbar-size",c),E.viewport.right-=S.width),-1!==["","static"].indexOf(I.body.style.position)&&-1!==["","static"].indexOf(I.body.parentElement.style.position)||(E.page.bottom=I.body.scrollHeight-b-r,E.page.right=I.body.scrollWidth-v-o),void 0!==this.options.optimizations&&!1!==this.options.optimizations.moveElement&&void 0===this.targetModifier&&function(){var e=t.cache("target-offsetparent",function(){return l(t.target)}),n=t.cache("target-offsetparent-bounds",function(){return s(e)}),i=getComputedStyle(e),o=n,r={};if(["Top","Left","Bottom","Right"].forEach(function(t){r[t.toLowerCase()]=parseFloat(i["border"+t+"Width"])}),n.right=I.body.scrollWidth-n.left-o.width+r.right,n.bottom=I.body.scrollHeight-n.top-o.height+r.bottom,E.page.top>=n.top+r.top&&E.page.bottom>=n.bottom&&E.page.left>=n.left+r.left&&E.page.right>=n.right){var a=e.scrollTop,c=e.scrollLeft;E.offset={top:E.page.top-n.top+a-r.top,left:E.page.left-n.left+c-r.left}}}(),this.move(E),this.history.unshift(E),this.history.length>3&&this.history.pop(),e&&x(),!0}}},{key:"move",value:function(t){var e=this;if(void 0!==this.element.parentNode){var n={};for(var i in t){n[i]={};for(var o in t[i]){for(var r=!1,a=0;a<this.history.length;++a){var s=this.history[a];if(void 0!==s[i]&&!m(s[i][o],t[i][o])){r=!0;break}}r||(n[i][o]=!0)}}var c={top:"",left:"",right:"",bottom:""},d=function(t,n){if(!1!==(void 0!==e.options.optimizations?e.options.optimizations.gpu:null)){var i=void 0,o=void 0;t.top?(c.top=0,i=n.top):(c.bottom=0,i=-n.bottom),t.left?(c.left=0,o=n.left):(c.right=0,o=-n.right),window.matchMedia&&(window.matchMedia("only screen and (min-resolution: 1.3dppx)").matches||window.matchMedia("only screen and (-webkit-min-device-pixel-ratio: 1.3)").matches||(o=Math.round(o),i=Math.round(i))),c[M]="translateX("+o+"px) translateY("+i+"px)","msTransform"!==M&&(c[M]+=" translateZ(0)")}else t.top?c.top=n.top+"px":c.bottom=n.bottom+"px",t.left?c.left=n.left+"px":c.right=n.right+"px"},f=!1;if((n.page.top||n.page.bottom)&&(n.page.left||n.page.right)?(c.position="absolute",d(n.page,t.page)):(n.viewport.top||n.viewport.bottom)&&(n.viewport.left||n.viewport.right)?(c.position="fixed",d(n.viewport,t.viewport)):void 0!==n.offset&&n.offset.top&&n.offset.left?function(){c.position="absolute";var i=e.cache("target-offsetparent",function(){return l(e.target)});l(e.element)!==i&&U(function(){e.element.parentNode.removeChild(e.element),i.appendChild(e.element)}),d(n.offset,t.offset),f=!0}():(c.position="absolute",d({top:!0,left:!0},t.page)),!f)if(this.options.bodyElement)this.options.bodyElement.appendChild(this.element);else{for(var p=!0,h=this.element.parentNode;h&&1===h.nodeType&&"BODY"!==h.tagName;){if("static"!==getComputedStyle(h).position){p=!1;break}h=h.parentNode}p||(this.element.parentNode.removeChild(this.element),this.element.ownerDocument.body.appendChild(this.element))}var g={},v=!1;for(var o in c){var b=c[o];this.element.style[o]!==b&&(v=!0,g[o]=b)}v&&U(function(){u(e.element.style,g),e.trigger("repositioned")})}}}]),e}(C);X.modules=[],A.position=B;var q=u(X,A),D=function(){function t(t,e){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){o=!0,r=t}finally{try{!i&&s.return&&s.return()}finally{if(o)throw r}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),k=A.Utils,s=k.getBounds,u=k.extend,v=k.updateClasses,U=k.defer,z=["left","top","right","bottom"];A.modules.push({position:function(t){var e=this,n=t.top,i=t.left,o=t.targetAttachment;if(!this.options.constraints)return!0;var r=this.cache("element-bounds",function(){return s(e.element)}),a=r.height,l=r.width;if(0===l&&0===a&&void 0!==this.lastSize){var c=this.lastSize;l=c.width,a=c.height}var d=this.cache("target-bounds",function(){return e.getTargetBounds()}),f=d.height,p=d.width,h=[this.getClass("pinned"),this.getClass("out-of-bounds")];this.options.constraints.forEach(function(t){var e=t.outOfBoundsClass,n=t.pinnedClass;e&&h.push(e),n&&h.push(n)}),h.forEach(function(t){["left","top","right","bottom"].forEach(function(e){h.push(t+"-"+e)})});var g=[],b=u({},o),m=u({},this.attachment);return this.options.constraints.forEach(function(t){var r=t.to,s=t.attachment,c=t.pin;void 0===s&&(s="");var u=void 0,d=void 0;if(s.indexOf(" ")>=0){var h=s.split(" "),v=D(h,2);d=v[0],u=v[1]}else u=d=s;var y=w(e,r);"target"!==d&&"both"!==d||(n<y[1]&&"top"===b.top&&(n+=f,b.top="bottom"),n+a>y[3]&&"bottom"===b.top&&(n-=f,b.top="top")),"together"===d&&("top"===b.top&&("bottom"===m.top&&n<y[1]?(n+=f,b.top="bottom",n+=a,m.top="top"):"top"===m.top&&n+a>y[3]&&n-(a-f)>=y[1]&&(n-=a-f,b.top="bottom",m.top="bottom")),"bottom"===b.top&&("top"===m.top&&n+a>y[3]?(n-=f,b.top="top",n-=a,m.top="bottom"):"bottom"===m.top&&n<y[1]&&n+(2*a-f)<=y[3]&&(n+=a-f,b.top="top",m.top="top")),"middle"===b.top&&(n+a>y[3]&&"top"===m.top?(n-=a,m.top="bottom"):n<y[1]&&"bottom"===m.top&&(n+=a,m.top="top"))),"target"!==u&&"both"!==u||(i<y[0]&&"left"===b.left&&(i+=p,b.left="right"),i+l>y[2]&&"right"===b.left&&(i-=p,b.left="left")),"together"===u&&(i<y[0]&&"left"===b.left?"right"===m.left?(i+=p,b.left="right",i+=l,m.left="left"):"left"===m.left&&(i+=p,b.left="right",i-=l,m.left="right"):i+l>y[2]&&"right"===b.left?"left"===m.left?(i-=p,b.left="left",i-=l,m.left="right"):"right"===m.left&&(i-=p,b.left="left",i+=l,m.left="left"):"center"===b.left&&(i+l>y[2]&&"left"===m.left?(i-=l,m.left="right"):i<y[0]&&"right"===m.left&&(i+=l,m.left="left"))),"element"!==d&&"both"!==d||(n<y[1]&&"bottom"===m.top&&(n+=a,m.top="top"),n+a>y[3]&&"top"===m.top&&(n-=a,m.top="bottom")),"element"!==u&&"both"!==u||(i<y[0]&&("right"===m.left?(i+=l,m.left="left"):"center"===m.left&&(i+=l/2,m.left="left")),i+l>y[2]&&("left"===m.left?(i-=l,m.left="right"):"center"===m.left&&(i-=l/2,m.left="right"))),"string"==typeof c?c=c.split(",").map(function(t){return t.trim()}):!0===c&&(c=["top","left","right","bottom"]),c=c||[];var _=[],T=[];n<y[1]&&(c.indexOf("top")>=0?(n=y[1],_.push("top")):T.push("top")),n+a>y[3]&&(c.indexOf("bottom")>=0?(n=y[3]-a,_.push("bottom")):T.push("bottom")),i<y[0]&&(c.indexOf("left")>=0?(i=y[0],_.push("left")):T.push("left")),i+l>y[2]&&(c.indexOf("right")>=0?(i=y[2]-l,_.push("right")):T.push("right")),_.length&&function(){var t=void 0;t=void 0!==e.options.pinnedClass?e.options.pinnedClass:e.getClass("pinned"),g.push(t),_.forEach(function(e){g.push(t+"-"+e)})}(),T.length&&function(){var t=void 0;t=void 0!==e.options.outOfBoundsClass?e.options.outOfBoundsClass:e.getClass("out-of-bounds"),g.push(t),T.forEach(function(e){g.push(t+"-"+e)})}(),(_.indexOf("left")>=0||_.indexOf("right")>=0)&&(m.left=b.left=!1),(_.indexOf("top")>=0||_.indexOf("bottom")>=0)&&(m.top=b.top=!1),b.top===o.top&&b.left===o.left&&m.top===e.attachment.top&&m.left===e.attachment.left||(e.updateAttachClasses(m,b),e.trigger("update",{attachment:m,targetAttachment:b}))}),U(function(){!1!==e.options.addTargetClasses&&v(e.target,g,h),v(e.element,g,h)}),{top:n,left:i}}});var k=A.Utils,s=k.getBounds,v=k.updateClasses,U=k.defer;A.modules.push({position:function(t){var e=this,n=t.top,i=t.left,o=this.cache("element-bounds",function(){return s(e.element)}),r=o.height,a=o.width,l=this.getTargetBounds(),c=n+r,u=i+a,d=[];n<=l.bottom&&c>=l.top&&["left","right"].forEach(function(t){var e=l[t];e!==i&&e!==u||d.push(t)}),i<=l.right&&u>=l.left&&["top","bottom"].forEach(function(t){var e=l[t];e!==n&&e!==c||d.push(t)});var f=[],p=[],h=["left","top","right","bottom"];return f.push(this.getClass("abutted")),h.forEach(function(t){f.push(e.getClass("abutted")+"-"+t)}),d.length&&p.push(this.getClass("abutted")),d.forEach(function(t){p.push(e.getClass("abutted")+"-"+t)}),U(function(){!1!==e.options.addTargetClasses&&v(e.target,p,f),v(e.element,p,f)}),!0}});var D=function(){function t(t,e){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){o=!0,r=t}finally{try{!i&&s.return&&s.return()}finally{if(o)throw r}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();return A.modules.push({position:function(t){var e=t.top,n=t.left;if(this.options.shift){var i=this.options.shift;"function"==typeof this.options.shift&&(i=this.options.shift.call(this,{top:e,left:n}));var o=void 0,r=void 0;if("string"==typeof i){i=i.split(" "),i[1]=i[1]||i[0];var a=i,s=D(a,2);o=s[0],r=s[1],o=parseFloat(o,10),r=parseFloat(r,10)}else o=i.top,r=i.left;return e+=o,n+=r,{top:e,left:n}}}}),q})},function(t,e,n){function i(t,e,n,i,o){function c(n){var o=s.parse(n,!0),a=r.parseInt(t.viewIndex);i.sendToBackground("tabs.CurrentTabId").then(function(n){return r.extend(o.query,{readcubeId:t.viewModel.id,tabId:n,articleIndex:a||0}),e.openTab(s.format(o)),!0}).catch(function(){return e.openTab(s.format(o)),!1})}function u(t){e.openTab(l(a.URL_DOI_RESOLVER,t))}function d(t,i){n.getInstitutionProxy().then(function(n){var o=s.parse(t,!0);r.extend(o.query,{readcubeId:i.id}),e.openTab(n.replace(a.EZPROXY_URL_REPLACE_KEY,s.format(o)))})}function f(e){t.viewModel&&o.downloadPdf(t.viewModel,e)}function p(){e.openTab(a.URL_ACCOUNT)}function h(){e.openTab(a.URL_GET_TRIAL)}function g(){return a.URL_ACCOUNT}t.onOpenLinkClick=c,t.onLoginWithProxyClick=d,t.onDownloadPdfClick=f,t.onOpenDoiClick=u,t.onOpenAccountClick=p,t.onGetTrialClick=h,t.getAccountLink=g,t.proxyIsNotAvailable=!1,t.pdfUrlsAvailable=!1,t.searchingPdfUrls=!1,t.institutionName=null,t.sfxUrl=null,t.pdfUrls=[],n.getInstitutionProxy().catch(function(){t.proxyIsNotAvailable=!0});var v=t.viewModel;v&&(v.doi||v.pmid)&&n.getSfxUrlByDoiAndPmid(v.doi,v.pmid).then(function(e){t.sfxUrl=e}),n.evaluateLoggedInUserDetail().then(function(e){t.institutionName=r.get(e,"institution",null)});var b=t.$watch("viewVisibility.visible",function(e){if(e&&t.viewModel&&t.viewModel.isPdfDownloadFailed()){t.searchingPdfUrls=!0;var n=r.get(t.viewModel,"metadata.title");n&&(t.pdfUrlsAvailable=!0,i.sendToBackground("request.GetPdfUrlsFromGoogleScholar",n).then(function(e){Array.isArray(e)&&e.length>0?t.pdfUrls=e:t.pdfUrlsAvailable=!1,t.searchingPdfUrls=!1})),b()}})}i.$inject=["$scope","BrowserTab","User","Message","TooltipApi"];var o=n(2),r=n(1),a=n(0),s=n(9),l=n(5).sprintf;o.module("App").controller("PdfWarning",i)},function(t,e,n){function i(t){return{restrict:"E",transclude:"element",replace:!0,scope:{viewVisibility:"="},link:function(e,n,i,o,l){e.viewVisibility||(e.viewVisibility={visible:!1});var c=s.extend(t.getOptions(),s.pick(i,["parentSelector","attachment","targetAttachment","targetOffset"])),u=null,d=null,f=null;l(function(t,e){d=a(t[0]).addClass("readcube-tooltip-container").appendTo(a("body")),f=e,u=new r({element:d.get(0),target:a(n).parents(c.parentSelector).get(0),attachment:c.attachment,targetAttachment:c.targetAttachment,targetOffset:c.targetOffset,constraints:c.constraints})}),e.$watch("viewVisibility.visible",function(t){d&&d.toggleClass("readcube-tooltip-hidden",!t)}),e.$on("$destroy",function(){u&&u.destroy(),d&&d.remove(),f&&f.$destroy()});var p=!1;e.$watch(function(){p||(p=!0,e.$$postDigest(function(){p=!1,u.position()}))})}}}i.$inject=["tetherTooltipConfig"];var o=n(2),r=n(31),a=n(4),s=n(1);o.module("App").directive("tetherTooltip",i)},function(t,e,n){function i(){this.config={parentSelector:".readcube-button-holder:first",attachment:"bottom center",targetAttachment:"top center",targetOffset:"-6px 0",constraints:[{to:"scrollParent"}]},this.setOptions=function(t){r.extend(this.config,t)},this.getOptions=function(){return this.config},this.$get=function(){return this}}var o=n(2),r=n(1);o.module("App").provider("tetherTooltipConfig",i)},function(t,e,n){function i(){return{restrict:"E",templateUrl:"tooltip/index",replace:!0,scope:{side:"@",viewModel:"=",viewVisibility:"=",viewText:"@",viewUrl:"@",viewIndex:"@",viewClass:"@",viewClose:"@",viewRetry:"@",viewRetryMethod:"&"},link:function(t,e,n){function i(e){e.stopPropagation(),t.viewVisibility.visible=!1}function o(e){"function"==typeof t.viewRetryMethod&&t.viewRetryMethod()}t.onCloseTooltipClick=i,t.onRetryClick=o,t.viewVisibility||(t.viewVisibility={visible:!1})}}}n(2).module("App").directive("tooltip",i)},function(t,e,n){function i(t,e){return{openLibrary:function(){return e.sendToBackground("tabs.OpenLibrary",null)},openItemInLibrary:function(t,n){return e.sendToBackground("tabs.OpenItemInLibrary",{itemId:t,collectionId:n})},openDocumentInLibrary:function(e,n){return t.open(a(r.URL_LIBRARY_DOCUMENT,e,n))},openTab:function(e){return t.open(e)},openOptions:function(){chrome.tabs.create({url:"options.html"})}}}i.$inject=["$window","Message"];var o=n(2),r=n(0),a=n(5).sprintf;o.module("App").factory("BrowserTab",i)},function(t,e,n){function i(t){return{connectWithBackground:function(e,n){var i=t.defer(),o=chrome.runtime.connect({name:"readcube-extension-connection"}),a=!1;return o.postMessage({message:r.MESSAGE_START,data:n,method:e}),o.onMessage.addListener(function(t){t.message==r.MESSAGE_FINISH?(i.resolve(t.data),a=!0):t.message==r.MESSAGE_PROGRESS&&i.notify(t.data)}),o.onDisconnect.addListener(function(){a||i.resolve(null)}),i.promise}}}i.$inject=["$q"];var o=n(2),r=n(0);o.module("App").factory("Connection",i)},function(t,e,n){function i(t){return{getUploadPromise:function(e,n){var i=new XMLHttpRequest,o=t.defer();return i.upload.addEventListener("progress",function(t){t.lengthComputable?o.notify(parseInt(t.loaded/t.total*100)):o.notify(50)}),i.onreadystatechange=function(t){4==t.target.readyState&&(200==t.target.status?o.resolve(t.target):o.reject(t.target))},i.open("PUT",e,!0),i.setRequestHeader("Content-Type","application/pdf"),i.send(n),o.promise}}}i.$inject=["$q"],n(2).module("App").factory("FileRequest",i)},function(t,e,n){function i(t){var e=t.navigator.onLine;return t.addEventListener("offline",function(){e=!1}),t.addEventListener("online",function(){e=!0}),{isOnline:function(){return e},isOffline:function(){return!e}}}i.$inject=["$window"],n(2).module("App").factory("OnlineStatus",i)},function(t,e,n){function i(t,e){return{status:function(t){if(t.ext_ids.length>100){idsCopy=[].concat(t.ext_ids);var n=idsCopy.splice(0,100);return e.all({statuses:s.post(r.URL_ARTICLES_STATUS,{ext_ids:n}),others:s.post(r.URL_ARTICLES_STATUS,{ext_ids:idsCopy})}).then(function(t){var e=l.get(t,"statuses.data.items",[]),n=l.get(t,"others.data.items",[]);return t.statuses.data.items=e.concat(n),t.statuses})}return s.post(r.URL_ARTICLES_STATUS,t)},updateStatusForArticle:function(t){return this.status({ext_ids:[t.getIdentifiers()]}).then(function(e){var n=l.get(e,"data.items[0]",null);n&&(t.collections=n.collections,t.collection_id=n.collection_id,t.hasPdf=n.has_file,t.id=n.id)})},metadata:function(t){return s.post(r.URL_ARTICLES_METADATA,t)},getStatusWithMetadata:function(t){var n={ext_ids:t};return e.all({articlesStatus:this.status(n),articlesMetadata:this.metadata(n)}).then(function(n){var i=l.get(n,"articlesStatus.data.items",[]),o=l.get(n,"articlesMetadata.data",[]);return 0==i.length?e.reject("No items in the response"):0==o.length?i:(t.forEach(function(t,e){var n=l.find(o,function(e){if(t.doi&&e.doi){if(t.doi.toLowerCase()==e.doi.toLowerCase())return!0}return!(!t.pmid||e.pmid!=t.pmid)||!(!t.gsid||e.gsid!=t.gsid)});n&&l.extend(i[e],{pdfUrl:l.get(n,"pdf_urls[0]",null),pdfHash:l.get(n,"hash",null),url:l.get(n,"url",null)})}),i)})},add:function(t){return s.post(r.URL_ADD_ARTICLE,t)},addWithMetadata:function(t){return s.post(r.URL_ADD_ARTICLE_METADATA,t)},update:function(t,e,n){return s.patch(a(r.URL_COLLECTION_ARTICLE,e,t),n)},get:function(t){return s.get(a(r.URL_ARTICLE_GET,t))}}}i.$inject=["$http","$q"];var o=n(2),r=n(0),a=n(5).sprintf,s=n(7),l=n(1);o.module("App").factory("Article",i)},function(t,e,n){function i(t,e,n){function i(t){return!t.group_id&&!t.name}function o(){return l.get(r.URL_COLLECTIONS).then(function(t){var e=s.get(t,"data.collections",[]),n=[];return e.forEach(function(t){i(t)&&(t.name=r.DEFAULT_PERSONAL_LIBRARY_NAME),n.push(l.get(c(r.URL_COLLECTION_LISTS,t.collection_id)).then(function(e){var n=s.get(e,"data.lists",[]);return t.lists=d(n),!0}))}),a.all(n).then(function(){return u().then(function(t){return{groups:s.reduce(t,function(t,n,i){return t.push({group_id:i,collections:s.filter(e,{group_id:parseInt(i)||null})}),t},[]).sort(function(t){return null!==t}),groupNames:t}})})})}function u(){return l.get(r.URL_GROUPS).then(function(t){var e=s.get(t,"data.groups",[]);return s.reduce(e,function(t,e){return t[e.id]=e.name,t},{null:"Personal"})})}function d(t){function e(t,n,i,o){return s.sortBy(t,"name").forEach(function(t){t.level=i,o.push(t);var r=s.partition(n,{parent_id:t.id});e(r[0],r[1],i+1,o)}),o}var n=s.partition(t,function(t){return!t.parent_id});return e(n[0],n[1],0,[])}return{queryFlat:function(){return o()},queryStorage:function(){return e.get("lists",null).then(function(t){return s.isNull(t)?n.reject("The lists array is empty"):t})},addItems:function(t,e){return l.post(c(r.URL_LISTS_ADD_ITEMS,t),{item_ids:e})},clear:function(){e.set("lists",null)}}}i.$inject=["$http","Storage","$q"];var o=n(2),r=n(0),a=n(8),s=n(1),l=n(7),c=n(5).sprintf;o.module("App").factory("List",i)},function(t,e,n){function i(t,e,n,i){return u(t,{getArticlePdfResolvePromise:function(t){function i(){s--,o.getArticleIdFromFileHash(t).then(function(t){n.cancel(l),a.resolve(t),o.article.extend({id:t,inLibraryStatus:r.STATUS_IN_LIBRARY_WITH_PDF})}),0==s&&(n.cancel(l),a.reject("The PDF was not resolved during 1 minute"),o.article.inLibraryStatus=r.STATUS_PDF_RESOLVE_WARNING)}var o=this,a=e.defer(),s=10;o.article.inLibraryStatus=r.STATUS_PDF_RESOLVING,i();var l=n(i,6e3);return a.promise},getArticleIdFromFileHash:function(t){return c.get(a(r.URL_FILES,t)).then(function(t){var n=s.chain(t).get("data.items",[]).compact().get("[0]",null).value();return n||e.reject("Article id not found")})},upload:function(){var t=this;return t.article.extend({progressPercent:0,progressType:r.PROGRESS_DOWNLOAD,inLibraryStatus:r.STATUS_PDF_DOWNLOADING,usingPdfUrl:t.article.pdfUrl}),e.when(function(){return t.article.pdfUrl?t.getDownloadPromise({url:t.article.pdfUrl,isProxied:!1}):e.reject("Pdf url not available")}()).catch(function(n){return t.article.inLibraryStatus=r.STATUS_IN_LIBRARY_WITHOUT_PDF_WARNING,e.reject(n)}).then(function(n){return t.getArticleIdFromFileHash(n.sha256Hash).then(function(e){return t.article.id=e,t.article.inLibraryStatus=r.STATUS_IN_LIBRARY_WITH_PDF,e}).catch(function(i){if(i.status==l.UNAUTHORIZED)return t.article.inLibraryStatus=r.STATUS_NOT_LOGGED_IN,e.reject(i);var o="";t.article.pdfUrl&&t.article.pdfUrl.length&&(o=encodeURIComponent(t.article.pdfUrl.substring(0,500))),t.article.progressPercent=0,t.article.progressType=r.PROGRESS_UPLOAD;var u,d=t.fixPdfFilename(n.fileName);return u=t.article.collection_id&&t.article.id?a(r.URL_UPLOAD,t.article.collection_id,"false",n.sha256Hash,"","",n.fileSize,t.article.id,encodeURIComponent(d),o):a(r.URL_UPLOAD_DEFAULT,t.article.id?"false":"true",n.sha256Hash,"","",n.fileSize,t.article.id?t.article.id:"",encodeURIComponent(d),o),c.get(u).then(function(i){var o=s.get(i,"data.url");return o?t.getUploadPromise(o,n.blob):e.reject("Unable to receive the upload url")}).then(null,null,function(e){t.article.progressPercent=e}).catch(function(e){return t.evaluateUploadError(e,r.STATUS_IN_LIBRARY_WITHOUT_PDF_WARNING)}).then(function(){return t.article.id?(t.article.inLibraryStatus=r.STATUS_IN_LIBRARY_WITH_PDF,!0):t.getArticlePdfResolvePromise(n.sha256Hash)})})})}})}i.$inject=["Upload","$q","$interval","$http"];var o=n(2),r=n(0),a=n(5).sprintf,s=n(1),l=n(11),c=n(7),u=n(3);o.module("App").factory("RawUpload",i)},function(t,e,n){function i(t,e,n){return a({__constructor:function(t){this.article=t},getUploadPromise:function(e,n){var i=new XMLHttpRequest,o=t.defer();return i.upload.addEventListener("progress",function(t){t.lengthComputable?o.notify(parseInt(t.loaded/t.total*100)):o.notify(50)}),i.onreadystatechange=function(t){4==t.target.readyState&&(200==t.target.status?o.resolve(t.target):o.reject(t.target))},i.open("PUT",e,!0),i.setRequestHeader("Content-Type","application/pdf"),i.send(n),o.promise},getDownloadPromise:function(n){var i=this;return n.url?e.connectWithBackground("request.GetPdfBase64",n).then(function(e){return e&&e.base64&&e.sha256Hash?{blob:r.toBlob(e.base64),sha256Hash:e.sha256Hash,fileSize:e.fileSize,fileName:e.fileName}:t.reject("No PDF file was found")},null,function(t){i.article.progressPercent=t.percent}):t.reject("No PDF url provided")},upload:function(){throw new Error("Method not implemented")},evaluateUploadError:function(e,i){var o=this;return e.status===s.UNPROCESSABLE_ENTITY?e:e.status===s.FORBIDDEN?n.getSubscriptionStatus().then(function(e){switch(e){case l.SUBSCRIPTION_TRIAL_EXPIRED:return o.article.inLibraryStatus=l.STATUS_IN_LIBRARY_WITHOUT_PDF_EXPIRED_TRIAL,t.reject("Unable to add pdf because the trial period is expired");case l.SUBSCRIPTION_PRO_EXPIRED:return o.article.inLibraryStatus=l.STATUS_IN_LIBRARY_WITHOUT_PDF_EXPIRED_SUBSCRIPTION,t.reject("Unable to add pdf because the subscription is expired");default:return o.article.inLibraryStatus=l.STATUS_IN_LIBRARY_WITHOUT_PDF_NO_SUBSCRIPTION,t.reject("Unable to add pdf because the account is without subscription")}}):(i&&(o.article.inLibraryStatus=i),t.reject(e))},fixPdfFilename:function(t){if(t)return t;var e=c.get(this.article,"metadata.title",""),n=(new Date).toLocaleString();return e?e+".pdf":this.article.usingPdfUrl?u.getHostnameFromUrl(this.article.usingPdfUrl)+" "+n+".pdf":n+".pdf"}})}i.$inject=["$q","Connection","User"];var o=n(2),r=n(25),a=n(3),s=n(11),l=n(0),c=n(1),u=n(13);o.module("App").factory("Upload",i)},function(t,e,n){function i(){return{downloadPdf:function(t,e){this.article=t,this.pdfUrl=e,++this.messageCount},article:null,pdfUrl:null,messageCount:0}}n(2).module("App").factory("TooltipApi",i)},,,,function(t,e){t.exports='<div ng-switch="buttonData.inLibraryStatus" class="readcube-relative">\n  <a ng-switch-when="in_library"  class="readcube-button right-space" href ng-click="onInLibraryClick($event)">\n    <span class="readcube-icon-extended readcube-icon-check"></span> In Library\n    <span class="readcube-triangle-holder" ng-click="onTriangleClick($event)" ng-hide="isPopup">\n      <span class="readcube-icon readcube-icon-triangle readcube-icon-triangle-imported"></span>\n    </span>\n  </a>\n\n  <a ng-switch-when="in_library_with_pdf" class="readcube-button right-space-icon" href ng-click="onInLibraryClick($event)">\n    <span class="readcube-icon-extended readcube-icon-check"></span> In Library\n    <span class="readcube-triangle-holder" ng-click="onTriangleClick($event)" ng-hide="isPopup">\n      <span class="readcube-icon readcube-icon-triangle readcube-icon-triangle-imported"></span>\n    </span>\n    <span class="readcube-right-box" ng-click="onInLibraryDocumentClick($event)">\n      <span class="readcube-icon-extended readcube-icon-document"></span>\n    </span>\n  </a>\n\n  <a ng-switch-when="in_library_without_pdf" class="readcube-button right-space-icon" href ng-click="onInLibraryClick($event)">\n    <span class="readcube-icon-extended readcube-icon-check"></span> In Library\n    <span class="readcube-triangle-holder" ng-click="onTriangleClick($event)" ng-hide="isPopup">\n      <span class="readcube-icon readcube-icon-triangle readcube-icon-triangle-imported"></span>\n    </span>\n    <span class="readcube-right-box-gray" ng-click="onDownloadPdfClick($event)">\n      <span class="readcube-icon-extended readcube-icon-arrow-down"></span>\n    </span>\n  </a>\n\n  <a ng-switch-when="in_library_without_pdf_warning_proxy" class="readcube-button right-space-icon" href\n     ng-click="onInLibraryClick($event)">\n    <span class="readcube-icon-extended readcube-icon-check"></span> In Library\n    <span class="readcube-triangle-holder" ng-click="onTriangleClick($event)" ng-hide="isPopup">\n      <span class="readcube-icon readcube-icon-triangle readcube-icon-triangle-imported"></span>\n    </span>\n    <span class="readcube-right-box-orange" ng-click="onShowTooltipClick($event)">\n      <span class="readcube-exclamation">!</span>\n    </span>\n  </a>\n\n  <div ng-switch-when="in_library_without_pdf_warning_proxy">\n    <tether-tooltip view-visibility="tooltipVisibility">\n      <tooltip view-visibility="tooltipVisibility" view-url="tooltip/pdf_warning_proxy" view-class="readcube-tooltip-warning"\n        view-model="buttonData" view-index="{{buttonIndex}}" view-close="yes"></tooltip>\n    </tether-tooltip>\n  </div>\n\n  <a ng-switch-when="in_library_without_pdf_warning" class="readcube-button right-space-icon" href ng-click="onInLibraryClick($event)">\n    <span class="readcube-icon-extended readcube-icon-check"></span> In Library\n    <span class="readcube-triangle-holder" ng-click="onTriangleClick($event)" ng-hide="isPopup">\n      <span class="readcube-icon readcube-icon-triangle readcube-icon-triangle-imported"></span>\n    </span>\n    <span class="readcube-right-box-orange" ng-click="onShowTooltipClick($event)">\n      <span class="readcube-exclamation">!</span>\n    </span>\n  </a>\n  <div ng-switch-when="in_library_without_pdf_warning">\n    <tether-tooltip view-visibility="tooltipVisibility">\n      <tooltip view-url="tooltip/pdf_warning" view-class="readcube-tooltip-warning" view-visibility="tooltipVisibility"\n        view-model="buttonData" view-index="{{buttonIndex}}" view-close="yes"></tooltip>\n    </tether-tooltip>\n  </div>\n\n  <a ng-switch-when="not_found" class="readcube-button readcube-decolored" href ng-click="onAddToLibraryClick($event)"\n     ng-mouseenter="onMouseEnter()" ng-mouseleave="onMouseLeave()">\n    <span class="readcube-icon readcube-icon-add"></span>\n    ReadCube\n    <span class="readcube-triangle-holder" ng-click="onTriangleClick($event)">\n      <span class="readcube-icon readcube-icon-triangle"></span>\n    </span>\n  </a>\n\n  <a ng-switch-when="metadata_adding" class="readcube-button right-space-icon left-space" href="#"\n     ng-click="preventPropagation($event)">\n    Importing...\n    <span class="readcube-right-box" ng-click="onShowTooltipClick($event)">\n      <span class="readcube-icon-extended readcube-icon-circle"></span>\n    </span>\n  </a>\n  <div ng-switch-when="metadata_adding">\n    <tether-tooltip view-visibility="tooltipVisibility">\n      <tooltip view-visibility="tooltipVisibility" view-text="Adding metadata to your library..." view-close="yes"></tooltip>\n    </tether-tooltip>\n  </div>\n\n  <a ng-switch-when="pdf_downloading" class="readcube-button right-space-icon" href="#">\n    <span class="readcube-icon-extended readcube-icon-check"></span> In Library\n    <span class="readcube-triangle-holder" ng-click="onTriangleClick($event)" ng-hide="isPopup">\n      <span class="readcube-icon readcube-icon-triangle readcube-icon-triangle-imported"></span>\n    </span>\n    <span class="readcube-right-box" ng-click="onShowTooltipClick($event)">\n      <span class="readcube-icon-extended readcube-icon-circle"></span>\n    </span>\n  </a>\n  <div ng-switch-when="pdf_downloading">\n    <tether-tooltip view-visibility="tooltipVisibility">\n      <tooltip view-url="tooltip/pdf_downloading" view-model="buttonData" view-visibility="tooltipVisibility"\n               view-class="readcube-tooltip-progress" view-close="yes"></tooltip>\n    </tether-tooltip>\n  </div>\n\n  <a href="#" ng-switch-when="status_in_library_without_pdf_no_subscription" class="readcube-button right-space-icon"\n     ng-click="onInLibraryClick($event)">\n    <span class="readcube-icon-extended readcube-icon-check"></span> In Library\n    <span class="readcube-triangle-holder" ng-click="onTriangleClick($event)" ng-hide="isPopup">\n      <span class="readcube-icon readcube-icon-triangle readcube-icon-triangle-imported"></span>\n    </span>\n    <span class="readcube-right-box" ng-click="onShowTooltipClick($event)">\n      <span class="readcube-icon-extended readcube-icon-arrow-down"></span>\n    </span>\n  </a>\n  <div ng-switch-when="status_in_library_without_pdf_no_subscription">\n    <tether-tooltip view-visibility="tooltipVisibility">\n      <tooltip view-close="yes" view-class="readcube-tooltip-warning" view-url="tooltip/pdf_no_subscription"\n               view-visibility="tooltipVisibility"></tooltip>\n    </tether-tooltip>\n  </div>\n\n  <a href="#" ng-switch-when="status_in_library_without_pdf_expired_subscription" class="readcube-button right-space-icon"\n     ng-click="onInLibraryClick($event)">\n    <span class="readcube-icon-extended readcube-icon-check"></span> In Library\n    <span class="readcube-triangle-holder" ng-click="onTriangleClick($event)" ng-hide="isPopup">\n      <span class="readcube-icon readcube-icon-triangle readcube-icon-triangle-imported"></span>\n    </span>\n    <span class="readcube-right-box" ng-click="onShowTooltipClick($event)">\n      <span class="readcube-icon-extended readcube-icon-arrow-down"></span>\n    </span>\n  </a>\n  <div ng-switch-when="status_in_library_without_pdf_expired_subscription">\n    <tether-tooltip view-visibility="tooltipVisibility">\n      <tooltip view-close="yes" view-class="readcube-tooltip-warning" view-url="tooltip/pdf_expired_subscription"\n               view-visibility="tooltipVisibility"></tooltip>\n    </tether-tooltip>\n  </div>\n\n  <a href="#" ng-switch-when="status_in_library_without_pdf_expired_trial" class="readcube-button right-space-icon"\n     ng-click="onInLibraryClick($event)">\n    <span class="readcube-icon-extended readcube-icon-check"></span> In Library\n    <span class="readcube-triangle-holder" ng-click="onTriangleClick($event)" ng-hide="isPopup">\n      <span class="readcube-icon readcube-icon-triangle readcube-icon-triangle-imported"></span>\n    </span>\n    <span class="readcube-right-box" ng-click="onShowTooltipClick($event)">\n      <span class="readcube-icon-extended readcube-icon-arrow-down"></span>\n    </span>\n  </a>\n  <div ng-switch-when="status_in_library_without_pdf_expired_trial">\n    <tether-tooltip view-visibility="tooltipVisibility">\n      <tooltip view-close="yes" view-class="readcube-tooltip-warning" view-url="tooltip/pdf_expired_trial"\n               view-visibility="tooltipVisibility"></tooltip>\n    </tether-tooltip>\n  </div>\n\n  <div ng-if="offlineTooltipVisibility.visible">\n    <tether-tooltip view-visibility="offlineTooltipVisibility">\n      <tooltip view-close="yes" view-text="Import error - please check your network connection and try again"\n               view-visibility="offlineTooltipVisibility"></tooltip>\n    </tether-tooltip>\n  </div>\n</div>\n'},function(t,e){t.exports='<div class="readcube-dropdown-container" ng-show="show">\n  <div class="dropdown-menu-triangle" ng-class="{down :!isBelowButton, up: isBelowButton}" ng-style="triangleStyle"></div>\n  <ul class="dropdown-menu" ng-style="boxStyle">\n    <button ng-if="shouldDisplayAddButton" ng-click="addToLibrary()" type="button"\n            class="add-to-library-button"\n            style="margin:0 auto; display:block;">\n      Add to Library\n    </button>\n    <li ng-repeat="data in options.groups"\n      class="dropdown-group-name">\n      <span class="dropdown-collection-header" ng-if="hasMultipleCollections()">\n        {{ options.groupNames[data.group_id] }}\n      </span>\n      <ul class="dropdown-group-list" ng-repeat="collection in data.collections">\n        <li class="dropdown-collection-name">\n          <label\n            ng-click="$event.stopPropagation()"\n            style="padding-left: 20px"\n            class="dropdown-truncate">\n            <input\n              class="dropdown-checkbox"\n              type="checkbox"\n              ng-disabled="collection.disabled"\n              ng-model="collection.selected">\n              {{ collection.name }}<span\n                ng-show="!shouldDisplayAddButton && collection._imported"\n                style="cursor: pointer"\n                ng-click="onClickOpenArrow($event, collection.collection_id)"> ➜</span>\n          </label>\n        </li>\n        <ul class="dropdown-group-list" ng-repeat="list in collection.lists">\n          <li class="dropdown-list-name">\n            <label\n              ng-click="$event.stopPropagation()"\n              ng-style="{\'padding-left\': ((list.level + 2) * 20) + \'px\' }"\n              class="dropdown-truncate">\n              <input\n                class="dropdown-checkbox"\n                type="checkbox"\n                ng-disabled="list.disabled"\n                ng-model="list.selected">\n                {{ list.name }}<span\n                  ng-show="!shouldDisplayAddButton && list._imported"\n                  style="cursor: pointer"\n                  ng-click="onClickOpenArrow($event, collection.collection_id)"> ➜</span>\n            </label>\n          </li>\n        </ul>\n      </ul>\n    </li>\n  </ul>\n</div>\n'},function(t,e){t.exports='<div class="readcube-login-container" ng-if="show" ng-click="onCloseButtonClick()">\n  <div class="readcube-login-close">\n    <div class="readcube-login-close-button">×</div>\n  </div>\n  <iframe class="readcube-login-iframe" src="{{iframeUrl}}"></iframe>\n</div>'},function(t,e){t.exports='<span\n  ng-if="isInSharedLibrary()"\n  class="readcube-icon-shared-library"\n  ng-attr-title="{{sharedLibrariesTooltip()}}"\n></span>\n'},function(t,e){t.exports='<div class="readcube-progress-bar"\n     ng-class="{\'readcube-progress-bar-upload\': viewModel.progressType == \'progress_upload\',\n      \'readcube-cancel-transition\': viewModel.progressPercent == 100 }"\n     style="width: {{ viewModel.progressPercent }}%"></div>\n<div class="reacube-tooltip-content">\n  <div class="readcube-tooltip-title">\n    Downloading PDF from {{ viewModel.usingPdfUrl | hostname }}...\n  </div>\n</div>'},function(t,e){t.exports='<div class="readcube-tooltip-title">\n  Article metadata imported. <br/> Your <a href="{{ getAccountLink() }}" target="_blank">ReadCube Pro</a> has expired -\n  re-subscribe to also automatically find and import PDFs\n</div>\n<div>\n  <button ng-click="onOpenAccountClick()" class="readcube-blue-button">\n    Go Pro\n  </button>\n  <button ng-click="viewVisibility.visible = false" class="readcube-blue-button readcube-blue-button-disabled">\n    Later\n  </button>\n</div>'},function(t,e){t.exports='<div class="readcube-tooltip-title">\n  Article metadata imported. Your ReadCube Pro has expired - <a href="{{ getAccountLink() }}" target="_blank">re-subscribe</a>\n  or get another 30 day free trial to automatically find and import PDFs\n</div>\n<div>\n  <button ng-click="onOpenAccountClick()" class="readcube-blue-button readcube-small-button">\n    Go Pro\n  </button>\n  <button ng-click="onGetTrialClick()" class="readcube-blue-button readcube-small-button">\n    Get Trial\n  </button>\n  <button ng-click="viewVisibility.visible = false" class="readcube-blue-button readcube-blue-button-disabled readcube-small-button">\n    Later\n  </button>\n</div>'},function(t,e){t.exports='<div ng-if="searchingPdfUrls" class="readcube-tooltip-searching-locations">\n  <span class="readcube-icon-extended readcube-icon-circle"></span> Searching for more download locations...\n</div>\n<div ng-if="!searchingPdfUrls" class="readcube-tooltip-pdf-text">\n  This full text PDF of this article may be available from one or more of the following sites:\n</div>\n<div ng-if="!searchingPdfUrls" class="readcube-tooltip-pdfs-list">\n  <div class="readcube-tooltip-pdf" ng-repeat="pdfUrl in pdfUrls">\n    <span ng-click="onDownloadPdfClick(pdfUrl)" title="Import pdf" class="readcube-tooltip-pdf-download">\n      <span class="readcube-icon-extended readcube-icon-download"></span>\n    </span>\n    <span class="readcube-tooltip-pdf-hostname" title="Open pdf file {{ pdfUrl }}" ng-click="onOpenLinkClick(pdfUrl)">{{pdfUrl | hostname}}</span>\n  </div>\n</div>\n'},function(t,e){t.exports='<div class="readcube-tooltip-title">\n  Article metadata imported. <br/> Try <a href="{{ getAccountLink() }}" target="_blank">ReadCube Pro</a> to also automatically\n  find and import PDFs. Start your risk-free 30 day trial?\n</div>\n<div>\n  <button ng-click="onOpenAccountClick()" class="readcube-blue-button">\n    Start trial\n  </button>\n  <button ng-click="viewVisibility.visible = false" class="readcube-blue-button readcube-blue-button-disabled">\n    Later\n  </button>\n</div>'},function(t,e){t.exports='<div class="readcube-tooltip-title">\n  Automatic PDF Download Unsuccessful\n</div>\n<div>\n  <button ng-if="viewModel.url" ng-click="onOpenLinkClick(viewModel.url)" class="readcube-blue-button">\n    Go to Article Page\n  </button>\n  <button ng-if="!viewModel.url && viewModel.doi" ng-click="onOpenDoiClick(viewModel.doi)" class="readcube-blue-button">\n    Go to Article Page\n  </button>\n  <span class="readcube-icon-holder">\n    <button ng-if="viewModel.pdfUrl" ng-click="onOpenLinkClick(viewModel.pdfUrl)" class="readcube-blue-button">\n      Go to PDF\n    </button>\n    <span ng-if="viewModel.pdfUrl" class="readcube-icon-extended readcube-icon-lock"></span>\n  </span>\n  <div ng-if="institutionName && sfxUrl" class="readcube-institution-sfx">\n    <a href="{{ sfxUrl }}" target="_blank"><span class="readcube-icon-extended readcube-icon-arrow-orange"></span></a>\n    <a href="{{ sfxUrl }}" target="_blank">Find at {{ institutionName }} (SFX)</a>\n  </div>\n  <div ng-if="pdfUrlsAvailable" ng-include="\'tooltip/pdf_list\'" class="readcube-pdf-advanced-search"></div>\n</div>'},function(t,e){t.exports='<div class="readcube-tooltip-title">\n  Automatic PDF Download Unsuccessful\n</div>\n<div>\n  <button ng-if="viewModel.url" ng-click="onLoginWithProxyClick(viewModel.url, viewModel)" class="readcube-blue-button">\n    Go to Article Page\n  </button>\n  <button ng-if="!viewModel.url && viewModel.doi" ng-click="onOpenDoiClick(viewModel.doi)" class="readcube-blue-button">\n    Go to Article Page\n  </button>\n  <span class="readcube-icon-holder">\n    <button ng-if="viewModel.pdfUrl" ng-click="onLoginWithProxyClick(viewModel.pdfUrl, viewModel)"\n            class="readcube-blue-button">\n      Go to PDF\n    </button>\n    <span ng-if="viewModel.pdfUrl" class="readcube-icon-extended readcube-icon-lock"></span>\n  </span>\n  <div ng-if="institutionName && sfxUrl" class="readcube-institution-sfx">\n    <a href="{{ sfxUrl }}" target="_blank"><span class="readcube-icon-extended readcube-icon-arrow-orange"></span></a>\n    <a href="{{ sfxUrl }}" target="_blank">Find at {{ institutionName }} (SFX)</a>\n  </div>\n  <div ng-if="pdfUrlsAvailable" ng-include="\'tooltip/pdf_list\'" class="readcube-pdf-advanced-search"></div>\n</div>'},function(t,e){t.exports='<div class="readcube-button-holder" add-to-library-button\n     ng-show="list.articlesList[%1$d].isReadyForShowing"\n     when-add-to-library-click="list.onAddToLibraryClick(index)"\n     when-in-library-click="list.onInLibraryClick(index)"\n     when-in-library-document-click="list.onInLibraryDocumentClick(index)"\n     when-download-pdf-click="list.onDownloadPdfClick(index)"\n     when-triangle-click="list.onTriangleClick(event, index, isInLibrary)"\n     button-data="list.articlesList[%1$d]"\n     button-index="%1$d"></div>\n'},function(t,e,n){n(2).module("App").run(["$templateCache",function(t){t.put("tooltip/pdf_expired_subscription",n(53)),t.put("tooltip/pdf_expired_trial",n(54)),t.put("tooltip/pdf_no_subscription",n(56)),t.put("tooltip/pdf_downloading",n(52)),t.put("tooltip/pdf_warning",n(57)),t.put("tooltip/pdf_warning_proxy",n(58)),t.put("tooltip/pdf_list",n(55)),t.put("tooltip/index",n(29))}])},function(t,e,n){var i=n(2),o=n(0);i.module("App").config(["$sceDelegateProvider",function(t){t.resourceUrlWhitelist(["self",o.URL_REGEXP_MAIN_URL])}])},function(t,e,n){function i(t,e,n,i,o,c,u,d,f,p,h,g,v,b){function m(t){o.listenForMessages(function(e,n){switch(e.message){case r.MESSAGE_GET_ARTICLES:n(N.articlesList);break;case r.MESSAGE_UPDATE_ARTICLE:var i=a.get(e,"data.updateDetails",{}),o=a.get(e,"data.index",null);if(!a.isNull(o)&&!a.isEmpty(i)){var s=N.articlesList.filter(function(t){return t.isReadyForShowing});a.extend(s[o],i),v.$apply()}n(!0);break;case r.MESSAGE_IS_ABSTRACT_PAGE:n(t.isAbstractPage());break;case r.MESSAGE_SELECT_ALL_SHOW:n(!0);break;case r.MESSAGE_SHOW_LOGIN:N.loginIframe.show=!0,N.queuedArticleIndexes=a.get(e,"data.queuedArticleIndexes",[]),v.$apply(),n(!0);break;default:n(null)}})}function y(){v.tooltipApi=b,v.$watchGroup(["tooltipApi.article","tooltipApi.pdfUrl","tooltipApi.messageCount"],function(t){var e=a.get(t,"[0]"),n=a.get(t,"[1]");e&&n&&N.onDownloadRawPdf(e,n)})}function _(t){var e=N.articlesList[t];n.openDocumentInLibrary(e.collection_id,e.id)}function T(t){var e=N.articlesList[t];n.openItemInLibrary(e.id,e.collection_id),h.trackEvent(r.MIXPANEL_EVENT_INJECTED_BUTTON_IN_LIBRARY_CLICKED)}function w(){var t=!1,e=!1;return d.get(r.SETTING_BUTTON_AVAILABLE_ON,[r.VALUE_BUTTON_AVAILABLE_ON_GOOGLE_SCHOLAR,r.VALUE_BUTTON_AVAILABLE_ON_PUBMED,r.VALUE_BUTTON_AVAILABLE_ON_PUBLISHER_WEBSITES]).then(function(e){return t=e.indexOf(g)>-1,d.get(r.SETTING_PDF_DOWNLOAD,r.VALUE_PDF_DOWNLOAD_AUTOMATIC_ENABLED)}).then(function(t){e=t==r.VALUE_PDF_DOWNLOAD_AUTOMATIC_ENABLED;var n=E();return n.length?i.getStatusWithMetadata(n):[]}).then(function(n){n.forEach(function(n,i){var o=N.articlesList[i];o.extend({isReadyForShowing:o.metadata&&t,id:a.get(n,"id",null),note:n.notes,pdfUrl:n.pdfUrl,pdfHash:n.pdfHash,hasPdf:n.has_file,collections:n.collections,collection_id:n.collection_id,url:n.url}).setInLibraryStatus(n.status,e)})}).catch(function(e){return a.each(N.articlesList,function(e){e.isReadyForShowing=t}),console.error(e),!0}).finally(function(){var t=N.articlesList.filter(function(t){return t.isReadyForShowing});o.sendToBackground("browser_action.SetBadgeAndIcon",t.length)})}function E(){return a.map(N.articlesList,function(t){return t.getIdentifiers()})}function A(t){t.get().forEach(function(t){N.articlesList.push(new l(t))})}function I(t,e,n){var i=N.articlesList[e];c.toggleDropdown(t,e,i,n)}function L(t){c.hideDropdown();var e=N.articlesList[t],n="";switch(g){case r.VALUE_BUTTON_AVAILABLE_ON_GOOGLE_SCHOLAR:n="Google scholar";break;case r.VALUE_BUTTON_AVAILABLE_ON_PUBMED:n="Pubmed";break;default:n="Publisher sites"}return h.trackEvent(r.MIXPANEL_EVENT_INJECTED_BUTTON_ADD_TO_LIBRARY_CLICKED,{"Browser Ext Site Type":n}),!e.isProcessingStatus()&&(e.inLibraryStatus=r.STATUS_METADATA_ADDING,R(e,t).then(function(t){return P(e)}).finally(function(){N.updateStatusForArticle(e).then(function(){C(e).then(function(){chrome.runtime.sendMessage({message:r.MESSAGE_UPDATE_POPUP_ARTICLE_FROM_CONTENT_SCRIPT,data:{index:t,updateDetails:{id:e.id,inLibraryStatus:e.inLibraryStatus,collection_id:e.collection_id,collections:e.collections}}})})})}))}function S(t){var e=N.articlesList[t];return!e.isProcessingStatus()&&P(e).finally(function(){C(e)})}function O(t,n){var i=new e(t),o=t.pdfUrl,a=t.inLibraryStatus;return t.extend({pdfUrl:n,usingPdfUrl:n}),h.setProperty(r.MIXPANEL_PROPERTY_BROWSER_EXTENSION_LAST_SEEN,(new Date).toISOString()),i.upload().then(function(t){h.incrementProperty(r.MIXPANEL_PROPERTY_BROWSER_EXTENSION_PDF,1),h.trackEvent(r.MIXPANEL_EVENT_PDF_DOWNLOADED)}).catch(function(t){h.trackEvent(r.MIXPANEL_EVENT_PDF_DOWNLOAD_FAILED)}).finally(function(){t.pdfUrl=o,t.isPdfDownloadFailed()&&(t.inLibraryStatus=a)})}function P(e,n,i){return d.get(r.SETTING_PDF_DOWNLOAD,r.VALUE_PDF_DOWNLOAD_AUTOMATIC_ENABLED).then(function(n){return n!==r.VALUE_PDF_DOWNLOAD_AUTOMATIC_ENABLED?u.reject("Automatic PDF upload is not enabled"):(h.setProperty(r.MIXPANEL_PROPERTY_BROWSER_EXTENSION_LAST_SEEN,(new Date).toISOString()),e.inLibraryStatus=r.STATUS_PDF_DOWNLOADING,new t(e).upload(i).then(function(t){h.incrementProperty(r.MIXPANEL_PROPERTY_BROWSER_EXTENSION_PDF,1),h.trackEvent(r.MIXPANEL_EVENT_PDF_DOWNLOADED),a.extend(e,{inLibraryStatus:r.STATUS_IN_LIBRARY_WITH_PDF})}).catch(function(t){return h.trackEvent(r.MIXPANEL_EVENT_PDF_DOWNLOAD_FAILED),console.error(t),u.reject("PDF upload and resolve failed")}))})}function R(t,e,n){return void 0===n&&(n=!1),h.setProperty(r.MIXPANEL_PROPERTY_BROWSER_EXTENSION_LAST_SEEN,(new Date).toISOString()),o.sendToBackground("article.AddFromMetadata",{article:t.toJson(),index:e,includeNote:n}).then(function(n){return n.success?(t.extend(n.article),h.incrementProperty(r.MIXPANEL_PROPERTY_BROWSER_EXTENSION_IMPORTED,1),h.trackEvent(r.MIXPANEL_EVENT_METADATA_IMPORTED),n):n.status===s.UNAUTHORIZED?(N.loginIframe.show=!0,N.queuedArticleIndexes=[e],u.reject("User is not authorized")):u.reject(n)})}function U(t){N.loginIframe.show=!1,N.loadArticles().then(c.loadListOptions).then(N.addQueuedArticles).finally(function(){N.queuedArticleIndexes=[]}),p.setLoggedInUserDetails(t)}function x(){var t=[];return a.each(N.queuedArticleIndexes,function(e){N.articlesList[e].isInLibrary()||t.push(N.onAddToLibraryClick(e))}),u.all(t)}function C(t){return p.getInstitutionProxy().then(function(e){return t.finishProcessingStatus(!0),!0}).catch(function(){return t.finishProcessingStatus(!1),!1})}function D(t){h.trackEvent(r.MIXPANEL_EVENT_INJECTED_BUTTON_LIST_SELECTED),this.onAddToLibraryClick(t)}var N=this;N.articlesList=[],N.loginIframe={show:!1},N.queuedArticleIndexes=[],N.onInLibraryDocumentClick=_,N.onInLibraryClick=T,N.onTriangleClick=I,N.onAddToLibraryClick=L,N.onDownloadRawPdf=O,N.onDownloadPdfClick=S,N.onListClick=D,N.onSuccessfullyLoggedIn=U,N.addArticleFromPDF=P,N.addArticleFromMetadata=R,N.initArticles=A,N.loadArticles=w,N.listenForMessages=m,N.listenForTooltip=y,N.finishArticleStatus=C,N.addQueuedArticles=x,N.updateStatusForArticle=i.updateStatusForArticle.bind(i)}i.$inject=["ProxyUpload","RawUpload","BrowserTab","Article","Message","ListDropdownApi","$q","Storage","List","User","Mixpanel","SiteType","$scope","TooltipApi"];var o=n(2),r=n(0),a=n(1),s=n(11),l=n(15);o.module("App").controller("GeneralList",i)},function(t,e,n){function i(t,e){return{restrict:"A",template:n(48),scope:{buttonIndex:"@",buttonData:"=",isPopup:"=",whenAddToLibraryClick:"&",whenInLibraryClick:"&",whenInLibraryDocumentClick:"&",whenDownloadPdfClick:"&",whenTriangleClick:"&"},controller:["$scope",function(n){function i(t){d(t),h()&&r.isFunction(n.whenAddToLibraryClick)&&n.whenAddToLibraryClick({index:n.buttonIndex})}function o(t){d(t),h()&&r.isFunction(n.whenInLibraryClick)&&n.whenInLibraryClick({index:n.buttonIndex})}function s(t){d(t),h()&&r.isFunction(n.whenInLibraryDocumentClick)&&n.whenInLibraryDocumentClick({index:n.buttonIndex})}function l(t){d(t);var e="not_found"!=n.buttonData.inLibraryStatus;if(h())return r.isFunction(n.whenTriangleClick)&&n.whenTriangleClick({index:n.buttonIndex,event:t,isInLibrary:e}),!1}function c(t){d(t),h()&&r.isFunction(n.whenDownloadPdfClick)&&n.whenDownloadPdfClick({index:n.buttonIndex})}function u(t){d(t),h()&&(n.tooltipVisibility.visible=!0)}function d(t){t instanceof MouseEvent&&(t.preventDefault(),t.stopPropagation())}function f(){h(!1)&&(n.tooltipVisibility.visible=!0)}function p(){n.tooltipVisibility.visible=!1}function h(t){return void 0===t&&(t=!0),e.isOffline()?(n.tooltipVisibility.visible=!1,t&&(n.offlineTooltipVisibility.visible=!0)):n.offlineTooltipVisibility.visible=!1,e.isOnline()}n.onAddToLibraryClick=i,n.onInLibraryClick=o,n.onInLibraryDocumentClick=s,n.onTriangleClick=l,n.preventPropagation=d,n.onDownloadPdfClick=c,n.onShowTooltipClick=u,n.onMouseEnter=f,n.onMouseLeave=p,n.tooltipVisibility={visible:!1},n.offlineTooltipVisibility={visible:!1},n.online=navigator.onLine,n.$watch("buttonData.inLibraryStatus",function(e){e===a.STATUS_IN_LIBRARY_WITHOUT_PDF_EXPIRED_SUBSCRIPTION||e===a.STATUS_IN_LIBRARY_WITHOUT_PDF_NO_SUBSCRIPTION?t.get(a.STORAGE_KEY_DISPLAYED_GO_PRO_TOOLTIP,!1).then(function(e){e?n.tooltipVisibility.visible=!1:(t.set(a.STORAGE_KEY_DISPLAYED_GO_PRO_TOOLTIP,!0),n.tooltipVisibility.visible=!0)}):n.tooltipVisibility.visible=!1})}]}}i.$inject=["Storage","OnlineStatus"];var o=n(2),r=n(1),a=n(0);o.module("App").directive("addToLibraryButton",i)},function(t,e,n){function i(t,e,i,o,f,p,h,g){return{restrict:"A",template:n(49),scope:{isBelowButton:"=?",selectedListName:"=?",whenListClick:"&",onAddToLibraryClick:"&",isAnySelected:"=?"},link:function(n,v,b){function m(){r.isFunction(n.onAddToLibraryClick)&&n.onAddToLibraryClick({index:n.api.index})}function y(t,e){t.stopPropagation(),t.preventDefault();var o=n.api.article,r=E(e,o);i.openItemInLibrary(r,e)}function _(t,e){if(e){var i=r.flatten(r.values(n.selectedItems));return r.includes(i,e)}return r.has(n.selectedItems,t)}function T(t){r.each(n.options.groups,function(e){r.each(e.collections,function(e){e._imported=r.some(t.collections,function(t){return e.collection_id==t.id}),r.each(e.lists,function(e){e._imported=r.some(e.item_ids,function(e){return r.some(t.collections,{item_id:e})})})})})}function w(t,e){return!t&&e?r.has(n.selectedItems,e)?delete n.selectedItems[e]:n.selectedItems[e]=[]:r.has(n.selectedItems,e)?r.includes(n.selectedItems[e],t)?r.pull(n.selectedItems[e],t):n.selectedItems[e].push(t):n.selectedItems[e]=[t],n.isAnySelected=!r.isEmpty(n.selectedItems),f.set({selectedItems:n.selectedItems}),!1}function E(t,e){var n=r.find(e.collections,{id:t});return r.get(n,"item_id")}function A(t,e,n){if(1==n){var i=s(c.URL_COLLECTION_IMPORT_FROM_COLLECTION,e.collection_id);return l.post(i,{from_collection_id:t.collection_id,item_ids:[t.id],annotations:!1}).then(function(n){return I(t,e,n),!0})}var o=E(e.collection_id,t),r=s(c.URL_REMOVE_FROM_COLLECTION,e.collection_id,o);return l.delete(r)}function I(t,e,n){var i=r.get(n,"data.items[0]");if(e.collection_id==i.collection_id){r.some(t.collections,{id:e.collection_id})||t.collections.push({id:i.collection_id,item_id:i.id,name:e.name,shared:e.shared})}}function L(t,e,n,i){if(1==i){var o=E(e.collection_id,t);if(o)return l.post(s(c.URL_ADD_TO_COLLECTION_LIST,e.collection_id,n.id),{item_ids:[o]}).then(function(t){S(r.get(t,"data.list"))});var a=s(c.URL_COLLECTION_IMPORT_FROM_COLLECTION,e.collection_id);return l.post(a,{from_collection_id:t.collection_id,item_ids:[t.id],annotations:!1}).then(function(i){if(i.status==d.OK){I(t,e,i);var o=r.get(i,"data.items[0].id");return e._imported=!0,l.post(s(c.URL_ADD_TO_COLLECTION_LIST,e.collection_id,n.id),{item_ids:[o]}).then(function(t){S(r.get(t,"data.list"))})}})}var o=E(e.collection_id,t);return l.post(s(c.URL_REMOVE_FROM_COLLECTION_LIST,e.collection_id,n.id),{item_ids:[o]}).then(function(t){S(r.get(t,"data.list"))})}function S(t){if(t){var e=r.find(r.flatMap(n.options.groups,"collections"),{collection_id:t.collection_id}),i=r.find(e.lists,{id:t.id});i.item_ids=t.item_ids,i.items=t.items}}function O(t){r.each(t.groups,function(t){r.each(t.collections,function(t){t._selected=_(t.collection_id,null),Object.defineProperty(t,"selected",{get:function(){return n.api.isInLibrary?t._imported:t._selected},set:function(e){n.api.isInLibrary?(t.disabled=!0,A(n.api.article,t,e).then(function(){return t._imported=e,t.disabled=!1,r.each(t.lists,function(t){t._imported=!1}),n.$apply(),a.delay(1e3).then(function(){return o.updateStatusForArticle.bind(o,n.api.article)()})}).finally(function(){t.disabled=!1})):(t._selected=e,0==e&&r.each(t.lists,function(t){1==t.selected&&(t.selected=!1)}),w(null,t.collection_id))}}),r.each(t.lists,function(e){e._selected=_(t.collection_id,e.id),Object.defineProperty(e,"selected",{get:function(){return n.api.isInLibrary?e._imported:e._selected},set:function(i){n.api.isInLibrary?(e.disabled=!0,t.disabled=!0,L(n.api.article,t,e,i).then(function(){return e._imported=i,e.disabled=!1,t.disabled=!1,n.$apply(),a.delay(1e3).then(function(){return o.updateStatusForArticle.bind(o,n.api.article)()})}).finally(function(){t.disabled=!1,e.disabled=!1})):(e._selected=i,0==t.selected&&1==i&&(t.selected=!0),t.selected&&(w(e.id,t.collection_id),r.every(t.lists,{selected:!1})&&(t.selected=!1)))}})})})})}function P(t){var e=N();return r.chain(t).keys().every(r.partial(r.has,e)).value()}function R(){return f.get("selectedItems",{}).then(function(t){if(r.isEmpty(n.options))n.selectedItems=t;else if(r.isEmpty(t)||r.has(t,"0")||!P(t)){var e=r.chain(n.options).get("groups",[]).find(function(t){return null==t.group_id||"null"==t.group_id}).get("collections[0]",null).value();if(e){e.selected=!0;var i=e.collection_id;n.selectedItems={},n.selectedItems[i]=[],f.set({selectedItems:n.selectedItems})}}else n.selectedItems=t;return!0})}function U(t){var e=r.chain(t.groups).flatMap("collections").keyBy("collection_id").value(),i=[];r.each(n.selectedItems,function(t,o){var a=e[o];if(a){var s=r.filter(t,function(t){return r.some(a.lists,{id:t})});n.selectedItems[o]=s}else i.push(o)}),r.each(i,function(t){delete n.selectedItems[t]})}function x(){return t.queryStorage().then(function(t){return O(t),n.options=t,!0}).catch(function(t){return console.error(t),!0}).then(function(){return t.queryFlat()}).then(function(t){return r.isEqual(t,n.options)||(f.set({lists:t}),U(t),O(t),n.options=t),n.selectedListName=k(),R()}).catch(function(t){t.status==d.UNAUTHORIZED&&(f.set({lists:null}),n.options={groups:[{group_id:null,collections:[{name:c.DEFAULT_PERSONAL_LIBRARY_NAME,collection_id:"0",lists:[],selected:!0}]}]},n.selectedItems={0:[]})})}function C(){return n.options&&n.options.groups&&n.options.groups.length>1}function D(t){var e=t.offset(),i=t.width(),o=e.left,r=e.top,a=u("#readcube-injected-button-dropdown");if(a.length){var s=a.offsetParent().offset();o-=s.left,r-=s.top}var l=o+i/2-70+"px";if(n.isBelowButton)n.triangleStyle={left:l,top:r+23+"px"},n.boxStyle={left:l,top:r+20+"px"};else{var c=h[0].body.clientHeight;n.triangleStyle={left:l,bottom:c-r+10+"px"},n.boxStyle={left:l,bottom:c-r+15+"px"}}}function N(){return r.chain(n.options.groups).flatMap("collections").keyBy("collection_id").value()}function k(){var t=N();return r.chain(n.selectedItems).toPairs().reduce(function(e,n){var i=n[0],o=n[1],a=t[i];if(a){var s=r.reduce(a.lists,function(t,e){return r.includes(o,e.id)?t.concat(e.name):t},[]);return r.isEmpty(s)?e.concat(a.name):e.concat(s)}return e},[]).join(", ").value()}function M(t){r.some(j,function(e){return t.target.className.indexOf(e)>-1})||n.$apply(function(){n.api.hideDropdown()})}var F=null;n.options={},p.loadListOptions=x,n.shouldDisplayAddButton=b.shouldDisplayAddButton||!1,n.api=p,n.hasMultipleCollections=C,n.selectedItems={},R().then(x).then(R),n.addToLibrary=m,n.onClickOpenArrow=y,e.listenForMessages(function(t,e){switch(t.message){case c.MESSAGE_UPDATE_LISTS:var n=r.map(r.get(t,"data.lists",[]),"data.list",[]);r.each(n,S);break;default:e(null)}});var B=r.debounce(function(){n.show&&F&&(D(F),n.$apply())},200);h.on("click",M),u(g).on("resize",B),n.$on("$destroy",function(){h.off("click",M),u(g).off("resize",B)}),n.$watch("api.show",function(){var t=n.api.event;n.shouldDisplayAddButton=!n.api.isInLibrary,n.shouldDisplayAddButton||T(n.api.article),t&&n.api.show?(F=u("caret"==t.target.className?t.target.parentElement:t.target),D(F),n.show=!0):(n.show=!1,F=null)}),n.$watch("selectedItems",function(){r.isEmpty(n.options)||(n.selectedListName=k()),f.set({selectedItems:n.selectedItems})},!0);var j=["dropdown-menu","dropdown-group-name","dropdown-group-list","dropdown-collection-header"]}}}i.$inject=["List","Message","BrowserTab","Article","Storage","ListDropdownApi","$document","$window"];var o=n(2),r=n(1),a=n(8),s=n(5).sprintf,l=n(7),c=n(0),u=n(4),d=n(11);o.module("App").directive("listDropdown",i)},function(t,e,n){function i(t){return{restrict:"A",template:n(50),scope:{show:"=",whenSuccessfullyLoggedIn:"&"},link:function(e,n,i){function o(){e.show=!1}e.iframeUrl=a.URL_LOGIN_FORM,e.onCloseButtonClick=o,e.$watch("show",function(){var n=t.document;s(n.body).add(n.documentElement).toggleClass("readcube-iframe-displayed",e.show)}),t.addEventListener("message",function(t){if(!r.get(t,"origin","").match(a.URL_REGEXP_MAIN_URL))return!1;var n=t.data;"auth:success"!==n.type||"login"!==n.auth&&"register"!==n.auth||(e.whenSuccessfullyLoggedIn({userData:n.user}),e.$apply())})}}}i.$inject=["$window"];var o=n(2),r=n(1),a=n(0),s=n(4);n(5).sprintf,n(74);o.module("App").directive("loginIframe",i)},function(t,e,n){function i(){return{restrict:"A",template:n(51),scope:{buttonData:"="},controller:["$scope",function(t){function e(){var e=t.buttonData.collections;return!!e&&e.some(function(t){return t.shared})}function n(){var e=t.buttonData.collections;if(e){return e.map(function(t){return t.name||"Personal"}).join(", ")}return""}t.isInSharedLibrary=e,t.sharedLibrariesTooltip=n}]}}var o=n(2);n(1),n(0);o.module("App").directive("sharedLibraryIcon",i)},function(t,e,n){function i(){return function(t){return r.isString(t)?a.parse(t).hostname:""}}var o=n(2),r=n(1),a=n(9);o.module("App").filter("hostname",i)},function(t,e,n){function i(t,e){return{responseError:function(n){return-1!==s.get(n,"config.url","").indexOf(r.DOMAIN_READCUBE)&&n.status==a.UNAUTHORIZED&&t.set({loggedInUserDetails:null}),e.reject(n)}}}i.$inject=["Storage","$q"];var o=n(2),r=n(0),a=n(11),s=n(1);o.module("App").factory("ClearUserDataInterceptor",i).config(["$httpProvider",function(t){t.interceptors.push("ClearUserDataInterceptor")}])},function(t,e,n){function i(){return{show:!1,isInLibrary:!1,index:null,event:null,article:null,showDropdown:function(t,e,n,i){this.event=t,this.show=!0,this.index=e,this.isInLibrary=i,this.article=n},hideDropdown:function(){this.event=null,this.show=!1,this.index=null},toggleDropdown:function(t,e,n,i){this.show?this.hideDropdown():this.showDropdown(t,e,n,i)},loadListOptions:function(){}}}n(2).module("App").factory("ListDropdownApi",i)},function(t,e,n){function i(t,e,n,i,o){function d(){return a.get("loggedInUserDetails",null).then(function(t){return a.get("selectedItems",{}).then(function(e){return{userId:c.get(t,"id",null),selectedItems:e}})})}return u(n,{upload:function(e){var n=this;n.article.extend({progressPercent:0,progressType:r.PROGRESS_DOWNLOAD,usingPdfUrl:n.article.pdfUrl});var i;return t.when(function(){return n.article.pdfUrl?(i=n.article.pdfUrl,n.getProxiedDownloadPromise(n.article.pdfUrl)):t.reject("Pdf url not available")}()).catch(function(e){function r(){return n.article.doi?o.sendToBackground("request.GetPdfUrlsFromDxDoi",n.article.doi).then(function(e){var o=c.get(e,"[0]",null);return o?(n.article.extend({progressPercent:0,usingPdfUrl:o}),i=o,n.getProxiedDownloadPromise(o)):t.reject("Unable to find PDF url from dx.doi.org resolve")}):t.reject(e)}return n.article.parsedPdfUrl?(i=n.article.parsedPdfUrl,n.getProxiedDownloadPromise(n.article.parsedPdfUrl).catch(function(t){return r()})):r()}).then(function(o){var a=n.fixPdfFilename(o.fileName);return d().then(function(t){var u=c.keys(t.selectedItems),d="";return i&&i.length&&(d=encodeURIComponent(i.substring(0,500))),c.map(u,function(t){var i=s(r.URL_UPLOAD,t,"false",o.sha256Hash,n.article.doi?n.article.doi:"",n.article.pmid?n.article.pmid:"",o.fileSize,(e?e[t]:null)||n.article.id||"",encodeURIComponent(a),d);return l.get(i)})}).then(function(e){return t.all(e).then(function(e){return t.all(c.map(e,function(e,i){var a=c.get(e,"data.url",null);return a?(0==i&&(n.article.progressPercent=0,n.article.progressType=r.PROGRESS_UPLOAD),n.getUploadPromise(a,o.blob).then(null,null,function(t){n.article.progressPercent=t})):t.reject("Url not received from preparing to upload")}))})})}).catch(function(t){return n.evaluateUploadError(t)})},getProxiedDownloadPromise:function(t){var n=this;return n.getDownloadPromise({url:t,isProxied:!1}).catch(function(){return e.getInstitutionProxy().then(function(e){var i=e.replace(r.EZPROXY_URL_REPLACE_KEY,t);return n.article.progressPercent=0,n.getDownloadPromise({url:i,isProxied:!0})})})}})}i.$inject=["$q","User","Upload","$http","Message"];var o=n(2),r=n(0),a=n(26),s=n(5).sprintf,l=n(7),c=n(1),u=n(3);o.module("App").factory("ProxyUpload",i)},,function(t,e,n){var i=n(3);t.exports=i({insertAngularDirectives:function(){},bootstrapAngular:function(){},get:function(){},getPlain:function(){},getIdentifiers:function(t){},getMetadata:function(t){},getArticleHolders:function(){},isAbstractPage:function(){},getButtonHolder:function(t){},insertButtons:function(){},getAngularInjector:function(t,e){},getExecutePromise:function(){},getDoiFromElement:function(t){}})},,,function(t,e,n){"use strict";var i=["lastName","nondropped","dropped","firstName","middle","suffix"];Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e,n){"use strict";function i(t){var e={},n=r.default(t);if(0==n.length)return e;var i=new s.default(0,n.length);if(n.length>1){e.suffix=l.tryGetSuffix(n[n.length-1]),e.suffix&&i.length--;var o=i.length-1;if(o>0){o>2&&(o=2);var a=new s.default(0,o),c=a.sliceArray(n),u=l.particlesRangeInTokens(c,!0);if(0==u.location){i.location+=u.length,i.length-=u.length;var d=u.sliceArray(n);f=l.splitParticleParts(d),e.dropped=f[0],e.nondropped=f[1]}}}return null!=i.location&&(e.lastName=i.sliceArray(n).map(function(t){return"{"==t[0]?t.substring(1):t}).join(" ")),e;var f}function o(t){var e={},n=t.split(","),o=i(n[0]);e.lastName=o.lastName,e.dropped=o.dropped,e.nondropped=o.nondropped,e.suffix=o.suffix;var c=n.length;if(c>1){var u=1;!e.suffix&&c>2&&(e.suffix=l.tryGetSuffix(n[1].trim()),e.suffix&&(u=2));var d=new s.default(u,c-u),f=d.sliceArray(n),p=f.reduce(function(t,e){return t.concat(r.default(e))},[]);h=l.firstAndMiddleFromTokens(p),e.firstName=h[0],e.middle=h[1]}return e.nameString=a.default(e),e;var h}var r=n(28),a=n(27),s=n(17),l=n(18);Object.defineProperty(e,"__esModule",{value:!0}),e.default=o},function(t,e,n){"use strict";function i(t){var e={},n=o.default(t);if(n.length>1){var i=n[n.length-1];e.suffix=s.tryGetSuffix(i)}var l=n.length;e.suffix&&l--,n.length>0&&l--;var c=n.slice(0,l),u=s.particlesRangeInTokens(c),d=new r.default;u.notFound()?(n.length>0&&(d=new r.default(n.length-1,1),e.suffix&&d.location--),u=new r.default(d.location,0)):(d.location=u.maxRange(),d.length=n.length-d.location,e.suffix&&d.length--),n=n.map(function(t){return"{"==t[0]?t.substring(1):t});var f=new r.default(0,u.location),p=f.sliceArray(n);if(v=s.firstAndMiddleFromTokens(p),e.firstName=v[0],e.middle=v[1],u.length>0){var h=u.sliceArray(n);b=s.splitParticleParts(h),e.dropped=b[0],e.nondropped=b[1]}if(1==d.length&&void 0!==d.location)e.lastName=n[d.location];else if(d.length>1){var g=d.sliceArray(n);e.lastName=g.join(" ")}return e.nameString=a.default(e),e;var v,b}var o=n(28),r=n(17),a=n(27),s=n(18);Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e,n){"use strict";function i(t){if(!t)throw"Invalid value";return t.indexOf(",")>-1?r.default(t):o.default(t)}var o=n(77),r=n(76),a=n(18);e.fullnameForAuthor=a.fullnameForAuthor,Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e,n){"use strict";var i={al:["al",""],dos:["dos",""],el:["el",""],"de las":["de","Las"],lo:["lo",""],les:["les",""],il:["il",""],del:["","del"],dela:["dela",""],della:["della",""],dello:["dello",""],di:["","Di"],da:["","Da"],do:["","Do"],lou:["","Lou"],pietro:["","Pietro"],de:["","de"],"de la":["de","La"],du:["du",""],"d'":["d'",""],le:["","Le"],la:["","La"],"l'":["","L'"],saint:["","Saint"],sainte:["","Sainte"],"st.":["","Saint"],"ste.":["","Sainte"],van:["","van"],"van de":["","van de"],"van der":["","van der"],"van den":["","van den"],vander:["","vander"],"v.d.":["","vander"],vd:["","vander"],"van het":["","van het"],ver:["","ver"],ten:["ten",""],ter:["ter",""],te:["te",""],"op de":["op de",""],"in de":["in de",""],"in 't":["in 't",""],"in het":["in het",""],"uit de":["uit de",""],"uit den":["uit den",""],von:["von",""],"von der":["von der",""],"von dem":["von dem",""],"von zu":["von zu",""],"v.":["von",""],v:["von",""],vom:["vom",""],das:["das",""],zum:["zum",""],zur:["zur",""],den:["den",""],der:["der",""],des:["des",""],"auf den":["auf den",""],mac:["","Mac"],mc:["","Mc"],"o'":["","O'"],ben:["","Ben"],bin:["","Bin"],sen:["sen",""]};Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){var i=n(2);n(190),n(73),i.module("App",["ngAnimate"]).constant("PubMedIds",n(171)),function(t){t.keys().forEach(t)}(n(254)),n(66),n(63),n(35),n(33),n(64),n(65),n(34),n(69),n(44),n(68),n(36),n(23),n(37),n(71),n(22),n(39),n(38),n(40),n(24),n(41),n(61),n(60),n(21),n(43),n(70),n(42),n(67),n(32),n(62),t.exports=i.module("App")},function(t,e,n){var i=n(4);i(".rprt.abstract").length>0?t.exports=n(257):i("#maincontent .article").length>0?t.exports=n(258):t.exports=n(259)},,,,,,,,,,,,,,,,,,,function(t,e){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){function i(t){return n(o(t))}function o(t){var e=r[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}var r={"./app.js":170,"./controllers/list.js":255};i.keys=function(){return Object.keys(r)},i.resolve=o,t.exports=i,i.id=254},function(t,e,n){function i(t,e,n,i,a,s,l,c,u,d,f,p,h,g,v){var b=this;o.extend(b,i("GeneralList",{ProxyUpload:a,RawUpload:s,BrowserTab:l,Article:c,Message:u,ListDropdownApi:d,$q:f,Storage:p,List:h,User:g,Mixpanel:v,SiteType:r.VALUE_BUTTON_AVAILABLE_ON_PUBMED,$scope:e,TooltipApi:n})),b.initArticles(t),b.loadArticles(),b.listenForMessages(t),b.listenForTooltip()}i.$inject=["PubMedIds","$scope","TooltipApi","$controller","ProxyUpload","RawUpload","BrowserTab","Article","Message","ListDropdownApi","$q","Storage","List","User","Mixpanel"];var o=n(2),r=(n(1),n(0));o.module("App").controller("List",i)},function(t,e,n){var i=n(171);i.insertAngularDirectives(),n(170),i.bootstrapAngular()},function(t,e,n){var i=n(4),o=n(0),r=n(1),a=n(12),s=n(10),l=n(3),c=l(s,{getButtonHolder:function(t){return t.find(".afflist").length?t.find(".afflist:first"):t.find(".auths:first")},getArticleHolders:function(){return i(".rprt.abstract")},getMetadata:function(t){var e=r.get(t.find(".cit").text().match(o.REGEXP_YEAR),"[0]",""),n=t.find(".auths").clone();return n.find("sup").remove(),{title:t.find("h1").text(),authors:a.getAuthorsArray(n.text()),journal:t.find(".cit [role=menubar] a").attr("title"),abstract:t.find("abstracttext").text(),year:e}},getIdentifiers:function(t){return{pmid:t.find(".rprtid dd:first").text(),doi:r.get(t.find(".cit").text().match(o.REGEXP_DOI),"[0]",null),gsid:null}}});t.exports=new c},function(t,e,n){var i=n(4),o=n(0),r=n(1),a=n(10),s=n(3),l=s(a,{getButtonHolder:function(t){var e=t.find(".inline_block.eight_col.va_top"),n=e.find(".doi"),i=e.find(".cit");return n.length?n:i.length?i:e},getArticleHolders:function(){return i("html")},getMetadata:function(t){var e=r.get(t.find(".cit").text().match(o.REGEXP_YEAR),"[0]",""),n=t.find(".fm-author > a").toArray().map(function(t){return t.innerText}),i=t.find('h2:contains("Abstract")').siblings("div:has(p)").text();return i.indexOf("\n")>-1&&(i=i.replace(/\n/g,"")),{title:t.find(".content-title").text(),authors:n,journal:t.find(".cit [role=menubar] a").text(),abstract:i,year:e}},getIdentifiers:function(t){var e=t.find('link[type="application/pdf"]').attr("href"),n=null;if(e){var i=document.createElement("a");i.href=e,n=i.href}return{pmid:t.find("meta[name=citation_pmid]").attr("content"),doi:null,gsid:null,parsedPdfUrl:n}}});t.exports=new l},function(t,e,n){var i=n(4),o=n(1),r=n(0),a=n(12),s=n(10),l=n(3),c=l(s,{getButtonHolder:function(t){return t.find(".resc")},getArticleHolders:function(){return i("div:has(>.rprt)").find(".rprt")},getMetadata:function(t){var e=o.get(t.find(".details").text().match(r.REGEXP_YEAR),"[0]","");return{title:t.find(".title").text(),authors:a.getAuthorsArray(t.find(".desc").text()),journal:t.find(".details .jrnl").attr("title"),year:e}},getIdentifiers:function(t){var e=t.find(".rprtid dd").text();0==e.indexOf("PMC")&&(e=null);var n=t.find(".details .doi").text(),i=t.find(".details").text(),a=n||i;return{pmid:e,gsid:null,doi:o.get(a.match(r.REGEXP_DOI),"[0]",null)}},isAbstractPage:function(){return!1}});t.exports=new c}],[256]);