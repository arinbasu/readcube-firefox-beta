webpackJsonp([6],{11:function(t,e){t.exports={100:"Continue",101:"Switching Protocols",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Time-out",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Large",415:"Unsupported Media Type",416:"Requested Range not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",429:"Too Many Requests",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Time-out",505:"HTTP Version not Supported",507:"Insufficient Storage",CONTINUE:100,SWITCHING_PROTOCOLS:101,OK:200,CREATED:201,ACCEPTED:202,NON_AUTHORITATIVE_INFORMATION:203,NO_CONTENT:204,RESET_CONTENT:205,PARTIAL_CONTENT:206,MULTIPLE_CHOICES:300,MOVED_PERMANENTLY:301,FOUND:302,SEE_OTHER:303,NOT_MODIFIED:304,USE_PROXY:305,TEMPORARY_REDIRECT:307,BAD_REQUEST:400,UNAUTHORIZED:401,PAYMENT_REQUIRED:402,FORBIDDEN:403,NOT_FOUND:404,METHOD_NOT_ALLOWED:405,NOT_ACCEPTABLE:406,PROXY_AUTHENTICATION_REQUIRED:407,REQUEST_TIMEOUT:408,CONFLICT:409,GONE:410,LENGTH_REQUIRED:411,PRECONDITION_FAILED:412,REQUEST_ENTITY_TOO_LARGE:413,REQUEST_URI_TOO_LONG:414,UNSUPPORTED_MEDIA_TYPE:415,REQUESTED_RANGE_NOT_SATISFIABLE:416,EXPECTATION_FAILED:417,UNPROCESSABLE_ENTITY:422,LOCKED:423,FAILED_DEPENDENCY:424,TOO_MANY_REQUESTS:429,UNAVAILABLE_FOR_LEGAL_REASONS:451,INTERNAL_SERVER_ERROR:500,NOT_IMPLEMENTED:501,BAD_GATEWAY:502,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,HTTP_VERSION_NOT_SUPPORTED:505,INSUFFICIENT_STORAGE:507}},13:function(t,e,n){var r=n(1),o=n(9),i=n(0),a={getPdfFilenameFromUrl:function(t){return"string"!=typeof t||0===t.length?"":r.chain(o.parse(t)).get("pathname","").thru(function(t){return t.split("/")}).last().thru(function(t){var e=decodeURIComponent(t).toLowerCase();return r.endsWith(e,".pdf")?e:""}).value()},isReadcubeUrl:function(t){return-1!==t.indexOf(i.DOMAIN_READCUBE)},isUrlAbsolute:function(t){return t.indexOf("://")>0||0===t.indexOf("//")},isProtocol:function(t,e){return"string"==typeof t&&0!=t.length&&r.chain(o.parse(t)).get("protocol","").thru(function(t){return-1!==e.indexOf(t)}).value()},getHostnameFromUrl:function(t){return"string"!=typeof t||0===t.length?"":o.parse(t).hostname},getUrlWithoutQuery:function(t){return"string"!=typeof t||0===t.length?"":o.format(r.extend(o.parse(t),{hash:null,query:null,search:null}))},publisherWebsiteRegExps:r.reduce(i,function(t,e,n){return n.indexOf("URL_REGEXP_PUBLISHER")>-1?t.concat(e):t},[]),isPublisherWebsite:function(t){if("string"!=typeof t||0===t.length)return!1;var e=a.getUrlWithoutQuery(t);return a.publisherWebsiteRegExps.some(function(t){return"string"==typeof t?-1!==t.indexOf(e):t.test(e)})},isRsc:function(t){if("string"!=typeof t||0===t.length)return!1;var e=a.getUrlWithoutQuery(t);return i.URL_REGEXP_PUBLISHER_RSC.test(e)},isGoogleScholar:function(t){if("string"!=typeof t||0===t.length)return!1;var e=a.getUrlWithoutQuery(t);return i.URL_REGEXP_SOURCE_GOOGLE_SCHOLAR.test(e)},isPubmed:function(t){if("string"!=typeof t||0===t.length)return!1;var e=a.getUrlWithoutQuery(t);return i.URL_REGEXP_SOURCE_PUBMED.test(e)},isReadcubeWebLibrary:function(t){if("string"!=typeof t||0===t.length)return!1;var e=a.getUrlWithoutQuery(t);return i.URL_REGEXP_WEB_LIBRARY_URL.test(e)}};t.exports=a},135:function(t,e){/**
 * @license AngularJS v1.6.6
 * (c) 2010-2017 Google, Inc. http://angularjs.org
 * License: MIT
 */
!function(window,t){"use strict";function e(t,e){if(u(t)){e=e||[];for(var n=0,r=t.length;n<r;n++)e[n]=t[n]}else if(c(t)){e=e||{};for(var o in t)"$"===o.charAt(0)&&"$"===o.charAt(1)||(e[o]=t[o])}return e||t}function n(){function n(e,n){return t.extend(Object.create(e),n)}function r(t,e){var n=e.caseInsensitiveMatch,r={originalPath:t,regexp:t},o=r.keys=[];return t=t.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)(\*\?|[?*])?/g,function(t,e,n,r){var i="?"===r||"*?"===r?"?":null,a="*"===r||"*?"===r?"*":null;return o.push({name:n,optional:!!i}),e=e||"",(i?"":e)+"(?:"+(i?e:"")+(a&&"(.+?)"||"([^/]+)")+(i||"")+")"+(i||"")}).replace(/([\/$*])/g,"\\$1"),r.regexp=new RegExp("^"+t+"$",n?"i":""),r}u=t.isArray,c=t.isObject,s=t.isDefined,l=t.noop;var o={};this.when=function(n,i){var a=e(i);if(t.isUndefined(a.reloadOnSearch)&&(a.reloadOnSearch=!0),t.isUndefined(a.caseInsensitiveMatch)&&(a.caseInsensitiveMatch=this.caseInsensitiveMatch),o[n]=t.extend(a,n&&r(n,a)),n){var u="/"===n[n.length-1]?n.substr(0,n.length-1):n+"/";o[u]=t.extend({redirectTo:n},r(u,a))}return this},this.caseInsensitiveMatch=!1,this.otherwise=function(t){return"string"==typeof t&&(t={redirectTo:t}),this.when(null,t),this},f=!0,this.eagerInstantiationEnabled=function(t){return s(t)?(f=t,this):f},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$templateRequest","$sce","$browser",function(e,r,i,a,u,c,s,f){function p(t,e){var n=e.keys,r={};if(!e.regexp)return null;var o=e.regexp.exec(t);if(!o)return null;for(var i=1,a=o.length;i<a;++i){var u=n[i-1],c=o[i];u&&c&&(r[u.name]=c)}return r}function h(n){var r=A.current;b=T(),(O=b&&r&&b.$$route===r.$$route&&t.equals(b.pathParams,r.pathParams)&&!b.reloadOnSearch&&!I)||!r&&!b||e.$broadcast("$routeChangeStart",b,r).defaultPrevented&&n&&n.preventDefault()}function v(){var n=A.current,r=b;if(O)n.params=r.params,t.copy(n.params,i),e.$broadcast("$routeUpdate",n);else if(r||n){I=!1,A.current=r;var o=a.resolve(r);f.$$incOutstandingRequestCount(),o.then(g).then(m).then(function(a){return a&&o.then(y).then(function(o){r===A.current&&(r&&(r.locals=o,t.copy(r.params,i)),e.$broadcast("$routeChangeSuccess",r,n))})}).catch(function(t){r===A.current&&e.$broadcast("$routeChangeError",r,n,t)}).finally(function(){f.$$completeOutstandingRequest(l)})}}function g(e){var n={route:e,hasRedirection:!1};if(e)if(e.redirectTo)if(t.isString(e.redirectTo))n.path=_(e.redirectTo,e.params),n.search=e.params,n.hasRedirection=!0;else{var o=r.path(),i=r.search(),c=e.redirectTo(e.pathParams,o,i);t.isDefined(c)&&(n.url=c,n.hasRedirection=!0)}else if(e.resolveRedirectTo)return a.resolve(u.invoke(e.resolveRedirectTo)).then(function(e){return t.isDefined(e)&&(n.url=e,n.hasRedirection=!0),n});return n}function m(t){var e=!0;if(t.route!==A.current)e=!1;else if(t.hasRedirection){var n=r.url(),o=t.url;o?r.url(o).replace():o=r.path(t.path).search(t.search).replace().url(),o!==n&&(e=!1)}return e}function y(e){if(e){var n=t.extend({},e.resolve);t.forEach(n,function(e,r){n[r]=t.isString(e)?u.get(e):u.invoke(e,null,null,r)});var r=E(e);return t.isDefined(r)&&(n.$template=r),a.all(n)}}function E(e){var n,r;return t.isDefined(n=e.template)?t.isFunction(n)&&(n=n(e.params)):t.isDefined(r=e.templateUrl)&&(t.isFunction(r)&&(r=r(e.params)),t.isDefined(r)&&(e.loadedTemplateUrl=s.valueOf(r),n=c(r))),n}function T(){var e,i;return t.forEach(o,function(o,a){!i&&(e=p(r.path(),o))&&(i=n(o,{params:t.extend({},r.search(),e),pathParams:e}),i.$$route=o)}),i||o[null]&&n(o[null],{params:{},pathParams:{}})}function _(e,n){var r=[];return t.forEach((e||"").split(":"),function(t,e){if(0===e)r.push(t);else{var o=t.match(/(\w+)(?:[?*])?(.*)/),i=o[1];r.push(n[i]),r.push(o[2]||""),delete n[i]}}),r.join("")}var b,O,I=!1,A={routes:o,reload:function(){I=!0;var t={defaultPrevented:!1,preventDefault:function(){this.defaultPrevented=!0,I=!1}};e.$evalAsync(function(){h(t),t.defaultPrevented||v()})},updateParams:function(e){if(!this.current||!this.current.$$route)throw d("norout","Tried updating route when with no current route");e=t.extend({},this.current.params,e),r.path(_(this.current.$$route.originalPath,e)),r.search(e)}};return e.$on("$locationChangeStart",h),e.$on("$locationChangeSuccess",v),A}]}function r(t){f&&t.get("$route")}function o(){this.$get=function(){return{}}}function i(e,n,r){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(o,i,a,u,c){function s(){d&&(r.cancel(d),d=null),f&&(f.$destroy(),f=null),p&&(d=r.leave(p),d.done(function(t){!1!==t&&(d=null)}),p=null)}function l(){var a=e.current&&e.current.locals,u=a&&a.$template;if(t.isDefined(u)){var l=o.$new(),d=e.current,g=c(l,function(e){r.enter(e,null,p||i).done(function(e){!1===e||!t.isDefined(h)||h&&!o.$eval(h)||n()}),s()});p=g,f=d.scope=l,f.$emit("$viewContentLoaded"),f.$eval(v)}else s()}var f,p,d,h=a.autoscroll,v=a.onload||"";o.$on("$routeChangeSuccess",l),l()}}}function a(t,e,n){return{restrict:"ECA",priority:-400,link:function(r,o){var i=n.current,a=i.locals;o.html(a.$template);var u=t(o.contents());if(i.controller){a.$scope=r;var c=e(i.controller,a);i.controllerAs&&(r[i.controllerAs]=c),o.data("$ngControllerController",c),o.children().data("$ngControllerController",c)}r[i.resolveAs||"$resolve"]=a,u(r)}}}var u,c,s,l,f,p=t.module("ngRoute",[]).info({angularVersion:"1.6.6"}).provider("$route",n).run(r),d=t.$$minErr("ngRoute");r.$inject=["$injector"],p.provider("$routeParams",o),p.directive("ngView",i),p.directive("ngView",a),i.$inject=["$route","$anchorScroll","$animate"],a.$inject=["$compile","$controller","$route"]}(window,window.angular)},136:function(t,e,n){n(135),t.exports="ngRoute"},138:function(t,e,n){n(139),t.exports="toaster"},139:function(t,e){!function(window,t){"use strict";angular.module("toaster",[]).constant("toasterConfig",{limit:0,"tap-to-dismiss":!0,"close-button":!1,"close-html":'<button class="toast-close-button" type="button">&times;</button>',"newest-on-top":!0,"time-out":5e3,"icon-classes":{error:"toast-error",info:"toast-info",wait:"toast-wait",success:"toast-success",warning:"toast-warning"},"body-output-type":"","body-template":"toasterBodyTmpl.html","icon-class":"toast-info","position-class":"toast-top-right","title-class":"toast-title","message-class":"toast-message","prevent-duplicates":!1,"mouseover-timer-stop":!0}).service("toaster",["$rootScope","toasterConfig",function(t,e){this.pop=function(e,n,r,o,i,a,u,c,s,l){if(angular.isObject(e)){var f=e;this.toast={type:f.type,title:f.title,body:f.body,timeout:f.timeout,bodyOutputType:f.bodyOutputType,clickHandler:f.clickHandler,showCloseButton:f.showCloseButton,closeHtml:f.closeHtml,uid:f.toastId,onShowCallback:f.onShowCallback,onHideCallback:f.onHideCallback,directiveData:f.directiveData},s=f.toastId,u=f.toasterId}else this.toast={type:e,title:n,body:r,timeout:o,bodyOutputType:i,clickHandler:a,showCloseButton:c,uid:s,onHideCallback:l};t.$emit("toaster-newToast",u,s)},this.clear=function(e,n){t.$emit("toaster-clearToasts",e,n)};for(var n in e["icon-classes"])this[n]=function(t){return function(e,n,r,o,i,a,u,c,s){angular.isString(e)?this.pop(t,e,n,r,o,i,a,u,c,s):this.pop(angular.extend(e,{type:t}))}}(n)}]).factory("toasterEventRegistry",["$rootScope",function(t){var e,n=null,r=null,o=[],i=[];return e={setup:function(){n||(n=t.$on("toaster-newToast",function(t,e,n){for(var r=0,i=o.length;r<i;r++)o[r](t,e,n)})),r||(r=t.$on("toaster-clearToasts",function(t,e,n){for(var r=0,o=i.length;r<o;r++)i[r](t,e,n)}))},subscribeToNewToastEvent:function(t){o.push(t)},subscribeToClearToastsEvent:function(t){i.push(t)},unsubscribeToNewToastEvent:function(t){var e=o.indexOf(t);e>=0&&o.splice(e,1),0===o.length&&(n(),n=null)},unsubscribeToClearToastsEvent:function(t){var e=i.indexOf(t);e>=0&&i.splice(e,1),0===i.length&&(r(),r=null)}},{setup:e.setup,subscribeToNewToastEvent:e.subscribeToNewToastEvent,subscribeToClearToastsEvent:e.subscribeToClearToastsEvent,unsubscribeToNewToastEvent:e.unsubscribeToNewToastEvent,unsubscribeToClearToastsEvent:e.unsubscribeToClearToastsEvent}}]).directive("directiveTemplate",["$compile","$injector",function(t,e){return{restrict:"A",scope:{directiveName:"@directiveName",directiveData:"@directiveData"},replace:!0,link:function(n,r,o){n.$watch("directiveName",function(i){if(angular.isUndefined(i)||i.length<=0)throw new Error("A valid directive name must be provided via the toast body argument when using bodyOutputType: directive");var a;try{a=e.get(o.$normalize(i)+"Directive")}catch(t){throw new Error(i+" could not be found. The name should appear as it exists in the markup, not camelCased as it would appear in the directive declaration, e.g. directive-name not directiveName.")}var u=a[0];if(!0!==u.scope&&u.scope)throw new Error("Cannot use a directive with an isolated scope. The scope must be either true or falsy (e.g. false/null/undefined). Occurred for directive "+i+".");if(u.restrict.indexOf("A")<0)throw new Error('Directives must be usable as attributes. Add "A" to the restrict option (or remove the option entirely). Occurred for directive '+i+".");n.directiveData&&(n.directiveData=angular.fromJson(n.directiveData));var c=t("<div "+i+"></div>")(n);r.append(c)})}}}]).directive("toasterContainer",["$parse","$rootScope","$interval","$sce","toasterConfig","toaster","toasterEventRegistry",function(t,e,n,r,o,i,a){return{replace:!0,restrict:"EA",scope:!0,link:function(e,u,c){function s(t,r){t.timeoutPromise=n(function(){e.removeToast(t.id)},r,1)}function l(n,o){if(n.type=h["icon-classes"][n.type],n.type||(n.type=h["icon-class"]),!0===h["prevent-duplicates"])if(d(o)){if(e.toasters.length>0&&e.toasters[e.toasters.length-1].body===n.body)return}else{var i,a;for(i=0,a=e.toasters.length;i<a;i++)e.toasters[i].uid===o&&(f(i),i--,a=e.toasters.length)}n.id=++v,d(o)||(n.uid=o);var u=h["close-button"];if("boolean"==typeof n.showCloseButton);else if("boolean"==typeof u)n.showCloseButton=u;else if("object"==typeof u){var c=u[n.type];void 0!==c&&null!==c&&(n.showCloseButton=c)}else n.showCloseButton=!1;switch(n.showCloseButton&&(n.closeHtml=r.trustAsHtml(n.closeHtml||e.config.closeHtml)),n.bodyOutputType=n.bodyOutputType||h["body-output-type"],n.bodyOutputType){case"trustedHtml":n.html=r.trustAsHtml(n.body);break;case"template":n.bodyTemplate=n.body||h["body-template"];break;case"templateWithData":var s=t(n.body||h["body-template"]),l=s(e);n.bodyTemplate=l.template,n.data=l.data;break;case"directive":n.html=n.body}e.configureTimer(n),!0===h["newest-on-top"]?(e.toasters.unshift(n),h.limit>0&&e.toasters.length>h.limit&&e.toasters.pop()):(e.toasters.push(n),h.limit>0&&e.toasters.length>h.limit&&e.toasters.shift()),angular.isFunction(n.onShowCallback)&&n.onShowCallback()}function f(t){var r=e.toasters[t];r.timeoutPromise&&n.cancel(r.timeoutPromise),e.toasters.splice(t,1),angular.isFunction(r.onHideCallback)&&r.onHideCallback()}function p(t){for(var n=e.toasters.length-1;n>=0;n--)d(t)?f(n):e.toasters[n].uid==t&&f(n)}function d(t){return angular.isUndefined(t)||null===t}var h,v=0;h=angular.extend({},o,e.$eval(c.toasterOptions)),e.config={toasterId:h["toaster-id"],position:h["position-class"],title:h["title-class"],message:h["message-class"],tap:h["tap-to-dismiss"],closeButton:h["close-button"],closeHtml:h["close-html"],animation:h["animation-class"],mouseoverTimer:h["mouseover-timer-stop"]},e.$on("$destroy",function(){a.unsubscribeToNewToastEvent(e._onNewToast),a.unsubscribeToClearToastsEvent(e._onClearToasts)}),e.configureTimer=function(t){var e=angular.isNumber(t.timeout)?t.timeout:h["time-out"];"object"==typeof e&&(e=e[t.type]),e>0&&s(t,e)},e.removeToast=function(t){var n,r;for(n=0,r=e.toasters.length;n<r;n++)if(e.toasters[n].id===t){f(n);break}},e.toasters=[],e._onNewToast=function(t,n,r){(d(e.config.toasterId)&&d(n)||!d(e.config.toasterId)&&!d(n)&&e.config.toasterId==n)&&l(i.toast,r)},e._onClearToasts=function(t,n,r){("*"==n||d(e.config.toasterId)&&d(n)||!d(e.config.toasterId)&&!d(n)&&e.config.toasterId==n)&&p(r)},a.setup(),a.subscribeToNewToastEvent(e._onNewToast),a.subscribeToClearToastsEvent(e._onClearToasts)},controller:["$scope","$element","$attrs",function(t,e,r){t.stopTimer=function(e){!0===t.config.mouseoverTimer&&e.timeoutPromise&&(n.cancel(e.timeoutPromise),e.timeoutPromise=null)},t.restartTimer=function(e){!0===t.config.mouseoverTimer?e.timeoutPromise||t.configureTimer(e):null===e.timeoutPromise&&t.removeToast(e.id)},t.click=function(e,n){if(!0===t.config.tap||!0===e.showCloseButton&&!0===n){var r=!0;e.clickHandler&&(angular.isFunction(e.clickHandler)?r=e.clickHandler(e,n):angular.isFunction(t.$parent.$eval(e.clickHandler))?r=t.$parent.$eval(e.clickHandler)(e,n):console.log("TOAST-NOTE: Your click handler is not inside a parent scope of toaster-container.")),r&&t.removeToast(e.id)}}}],template:'<div id="toast-container" ng-class="[config.position, config.animation]"><div ng-repeat="toaster in toasters" class="toast" ng-class="toaster.type" ng-click="click(toaster)" ng-mouseover="stopTimer(toaster)" ng-mouseout="restartTimer(toaster)"><div ng-if="toaster.showCloseButton" ng-click="click(toaster, true)" ng-bind-html="toaster.closeHtml"></div><div ng-class="config.title">{{toaster.title}}</div><div ng-class="config.message" ng-switch on="toaster.bodyOutputType"><div ng-switch-when="trustedHtml" ng-bind-html="toaster.html"></div><div ng-switch-when="template"><div ng-include="toaster.bodyTemplate"></div></div><div ng-switch-when="templateWithData"><div ng-include="toaster.bodyTemplate"></div></div><div ng-switch-when="directive"><div directive-template directive-name="{{toaster.html}}" directive-data="{{toaster.directiveData}}"></div></div><div ng-switch-default >{{toaster.body}}</div></div></div></div>'}}])}(window,document)},14:function(t,e){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(t){if(l===setTimeout)return setTimeout(t,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(t,0);try{return l(t,0)}catch(e){try{return l.call(null,t,0)}catch(e){return l.call(this,t,0)}}}function i(t){if(f===clearTimeout)return clearTimeout(t);if((f===r||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(t);try{return f(t)}catch(e){try{return f.call(null,t)}catch(e){return f.call(this,t)}}}function a(){v&&d&&(v=!1,d.length?h=d.concat(h):g=-1,h.length&&u())}function u(){if(!v){var t=o(a);v=!0;for(var e=h.length;e;){for(d=h,h=[];++g<e;)d&&d[g].run();g=-1,e=h.length}d=null,v=!1,i(t)}}function c(t,e){this.fun=t,this.array=e}function s(){}var l,f,p=t.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(t){l=n}try{f="function"==typeof clearTimeout?clearTimeout:r}catch(t){f=r}}();var d,h=[],v=!1,g=-1;p.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];h.push(new c(t,e)),1!==h.length||v||o(u)},c.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=s,p.addListener=s,p.once=s,p.off=s,p.removeListener=s,p.removeAllListeners=s,p.emit=s,p.prependListener=s,p.prependOnceListener=s,p.listeners=function(t){return[]},p.binding=function(t){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(t){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},167:function(t,e,n){var r=n(2);n(184),n(73),n(136),n(138),n(187),r.module("App",["checklist-model","ngAnimate","ngRoute","toaster"]),n(65),n(71),n(24),n(41),n(22),n(68),n(61),n(21),function(t){t.keys().forEach(t)}(n(229)),t.exports=r.module("App")},184:function(t,e){angular.module("checklist-model",[]).directive("checklistModel",["$parse","$compile",function(t,e){function n(t,e,n){if(angular.isArray(t))for(var r=t.length;r--;)if(n(t[r],e))return!0;return!1}function r(t,e,r){return t=angular.isArray(t)?t:[],n(t,e,r)||t.push(e),t}function o(t,e,n){if(angular.isArray(t))for(var r=t.length;r--;)if(n(t[r],e)){t.splice(r,1);break}return t}function i(i,a,u){function c(t,e){i[u.ngModel]=n(t,d,h)}var s=u.checklistModel;u.$set("checklistModel",null),e(a)(i),u.$set("checklistModel",s);var l=t(s),f=l.assign,p=t(u.checklistChange),d=u.checklistValue?t(u.checklistValue)(i.$parent):u.value,h=angular.equals;if(u.hasOwnProperty("checklistComparator"))if("."==u.checklistComparator[0]){var v=u.checklistComparator.substring(1);h=function(t,e){return t[v]===e[v]}}else h=t(u.checklistComparator)(i.$parent);i.$watch(u.ngModel,function(t,e){if(t!==e){var n=l(i.$parent);angular.isFunction(f)&&(!0===t?f(i.$parent,r(n,d,h)):f(i.$parent,o(n,d,h))),p&&p(i)}}),angular.isFunction(i.$parent.$watchCollection)?i.$parent.$watchCollection(s,c):i.$parent.$watch(s,c,!0)}return{restrict:"A",priority:1e3,terminal:!0,scope:!0,compile:function(t,e){if(("INPUT"!==t[0].tagName||"checkbox"!==e.type)&&"MD-CHECKBOX"!==t[0].tagName&&!e.btnCheckbox)throw'checklist-model should be applied to `input[type="checkbox"]` or `md-checkbox`.';if(!e.checklistValue&&!e.value)throw"You should provide `value` or `checklist-value`.";return e.ngModel||e.$set("ngModel","checked"),i}}}])},187:function(t,e){},19:function(t,e,n){(function(t,e){!function(t,n){"use strict";function r(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var r={callback:t,args:e};return s[c]=r,u(c),c++}function o(t){delete s[t]}function i(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(n,r)}}function a(t){if(l)setTimeout(a,0,t);else{var e=s[t];if(e){l=!0;try{i(e)}finally{o(t),l=!1}}}}if(!t.setImmediate){var u,c=1,s={},l=!1,f=t.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(t);p=p&&p.setTimeout?p:t,"[object process]"==={}.toString.call(t.process)?function(){u=function(t){e.nextTick(function(){a(t)})}}():function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?function(){var e="setImmediate$"+Math.random()+"$",n=function(n){n.source===t&&"string"==typeof n.data&&0===n.data.indexOf(e)&&a(+n.data.slice(e.length))};t.addEventListener?t.addEventListener("message",n,!1):t.attachEvent("onmessage",n),u=function(n){t.postMessage(e+n,"*")}}():t.MessageChannel?function(){var t=new MessageChannel;t.port1.onmessage=function(t){a(t.data)},u=function(e){t.port2.postMessage(e)}}():f&&"onreadystatechange"in f.createElement("script")?function(){var t=f.documentElement;u=function(e){var n=f.createElement("script");n.onreadystatechange=function(){a(e),n.onreadystatechange=null,t.removeChild(n),n=null},t.appendChild(n)}}():function(){u=function(t){setTimeout(a,0,t)}}(),p.setImmediate=r,p.clearImmediate=o}}("undefined"==typeof self?void 0===t?this:t:self)}).call(e,n(16),n(14))},20:function(t,e,n){function r(t,e){this._id=t,this._clearFn=e}var o=Function.prototype.apply;e.setTimeout=function(){return new r(o.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new r(o.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(19),e.setImmediate=setImmediate,e.clearImmediate=clearImmediate},200:function(t,e){t.exports='Your account has an associated ezproxy configuration. <br/>\nIf you need to disable it, configure the ezproxy manually in your\n<a href="%s" target="_blank">account</a>'},201:function(t,e){t.exports='Unfortunately your account doesn\'t have an associated ezproxy configuration. <br/>\nPlease check the institution name or configure the ezproxy manually in your\n<a href="%s" target="_blank">account</a>'},202:function(t,e){t.exports='<div class="container">\n  <div class="starter-template">\n    <a target="_blank" href="https://www.readcube.com/">\n      <img src="icons/readcube-logo.png" alt="Readcube logo"/>\n    </a>\n    <div id="settings">\n      <h2 class="title">Browser Extension Preferences</h2>\n      <form role="form" class="form">\n        <div class="form-group">\n          <table ng-if="ctrl.loggedIn" class="session-details">\n            <tr>\n              <td>\n                <label>Logged in as:</label>\n              </td>\n              <td class="left-align">\n                <button ng-click="ctrl.onAccountButtonClick()"\n                        class="btn btn-sm btn-primary logged-in-button">{{ ctrl.userData.name }}</button>\n              </td>\n            </tr>\n            <tr>\n              <td class="right-align logout-cell" colspan="2">\n                <a class="logout" ng-click="ctrl.onLogOutButtonClick($event)" href="#">\n                  <span class="readcube-icon-extended\n                  readcube-icon-logout"></span>Log out\n                </a>\n              </td>\n            </tr>\n          </table>\n          <table ng-if="!ctrl.loggedIn" class="session-details">\n            <tr>\n              <td>\n                <label>Logged out:</label>\n              </td>\n              <td class="right-align">\n                <button ng-click="ctrl.onLogInButtonClick()" class="btn btn-sm btn-default logged-out-button">Login</button>\n              </td>\n            </tr>\n          </table>\n        </div>\n        <div class="form-group">\n          <label class="overwrite-label">\n            Institutional Affiliation (Proxy access)\n          </label>\n          <div>\n            <div class="checkbox">\n              <table class="institution-table">\n                <tr>\n                  <td>Your institution:</td>\n                  <td>{{ ctrl.userData.institution ? ctrl.userData.institution : \'N/A\' }}</td>\n                </tr>\n                <tr>\n                  <td>Proxy access to full-text content and PDFs:</td>\n                  <td ng-switch="ctrl.userData.proxy_url_selection">\n                    <span ng-switch-when="institution">Enabled</span>\n                    <span ng-switch-when="manual">Enabled (manual proxy URL)</span>\n                    <span ng-switch-default="">Disabled</span>\n                  </td>\n                </tr>\n              </table>\n              <div>\n                <a target="_blank" class="account" ng-href="{{ctrl.C.URL_ACCOUNT}}">\n                  Edit institution and proxy settings\n                </a>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class="form-group">\n          <label class="overwrite-label">\n            Show "Add to Library" button on:\n          </label>\n          <div class="checkbox">\n            <label>\n              <input checklist-change="ctrl.onButtonAvailableOnChange()" checklist-value="ctrl.C.VALUE_BUTTON_AVAILABLE_ON_PUBMED"\n                     checklist-model="ctrl.buttonAvailableOn"\n                     type="checkbox"/>Pubmed\n            </label>\n          </div>\n          <div class="checkbox">\n            <label>\n              <input checklist-change="ctrl.onButtonAvailableOnChange()" checklist-value="ctrl.C.VALUE_BUTTON_AVAILABLE_ON_GOOGLE_SCHOLAR"\n                     checklist-model="ctrl.buttonAvailableOn"\n                     type="checkbox"/>Google Scholar\n            </label>\n          </div>\n          <div class="checkbox">\n            <label>\n              <input checklist-change="ctrl.onButtonAvailableOnChange()" checklist-value="ctrl.C.VALUE_BUTTON_AVAILABLE_ON_PUBLISHER_WEBSITES"\n                     checklist-model="ctrl.buttonAvailableOn"\n                     type="checkbox"/>Publisher websites\n            </label>\n          </div>\n        </div>\n        <div class="form-group">\n          <label class="overwrite-label">\n            Automatic PDF Downloads\n          </label>\n          <div class="radio">\n            <label>\n              <input ng-change="ctrl.onPdfDownloadChange()" ng-model="ctrl.automaticPdfDownloads" type="radio" name="pdf-download"\n                     ng-value="ctrl.C.VALUE_PDF_DOWNLOAD_AUTOMATIC_ENABLED">\n              Attempt to automatically find, download and import PDFs for references added to your library\n            </label>\n          </div>\n          <div class="radio">\n            <label>\n              <input ng-change="ctrl.onPdfDownloadChange()" ng-model="ctrl.automaticPdfDownloads" type="radio" name="pdf-download"\n                     ng-value="ctrl.C.VALUE_PDF_DOWNLOAD_AUTOMATIC_DISABLED">\n              Turn off automatic PDF downloads - only metadata will be imported\n            </label>\n          </div>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>\n<div login-iframe when-successfully-logged-in="ctrl.onSuccessfullyLoggedIn(userData)" show="ctrl.loginIframe.show"></div>\n<toaster-container></toaster-container>'},21:function(t,e,n){var r=n(2),o=n(0);r.module("App").run(["Mixpanel",function(t){var e=chrome.runtime.getManifest().version;t.setProperty(o.MIXPANEL_PROPERTY_BROWSER_EXTENSION_VERSION,e);var n={};n[o.MIXPANEL_SUPER_PROPERTY_CLIENT]="Browser Ext",n[o.MIXPANEL_SUPER_PROPERTY_BROWSER_EXTENSION_VERSION]=e,t.setSuperProperty(n),t.union(o.MIXPANEL_PROPERTY_CLIENTS_USED,"browser_ext")}])},22:function(t,e,n){function r(t,e){var n=!1;i.init(a.MIXPANEL_TOKEN,{api_host:a.MIXPANEL_API_URL});var r={get:function(){return n?t.resolve(i):(n=!0,e.evaluateLoggedInUserDetail().then(function(e){return e.id?(i.identify(e.id),i):t.reject("Unable to get user id")}).catch(function(e){return console.error(e),t.reject(e)}))},getObjectFromParams:function(t,e){var n={};return"string"==typeof t?n[t]=e:n=t,n},setProperty:function(t,e){return r.get().then(function(n){return n.people.set(r.getObjectFromParams(t,e)),!0})},setSuperProperty:function(t,e){return r.get().then(function(n){return n.register(r.getObjectFromParams(t,e)),!0})},incrementProperty:function(t,e){return r.get().then(function(n){return n.people.increment(r.getObjectFromParams(t,e)),!0})},trackEvent:function(t,e){return r.get().then(function(n){return n.track(t,e),!0})},union:function(t,e){return r.get().then(function(n){return n.people.union(t,e),!0})}};return r}r.$inject=["$q","User"];var o=n(2),i=n(47),a=n(0);o.module("App").factory("Mixpanel",r)},229:function(t,e,n){function r(t){return n(o(t))}function o(t){var e=i[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}var i={"./app.js":167,"./config/cache.js":230,"./config/mixpanel.js":231,"./config/route.js":232,"./controllers/options.js":233};r.keys=function(){return Object.keys(i)},r.resolve=o,t.exports=r,r.id=229},230:function(t,e,n){n(2).module("App").run(["$templateCache",function(t){t.put("options",n(202))}])},231:function(t,e,n){var r=n(2),o=n(0);r.module("App").run(["Mixpanel",function(t){t.trackEvent(o.MIXPANEL_EVENT_SETTINGS_PAGE_OPENED)}])},232:function(t,e,n){n(2).module("App").config(["$routeProvider",function(t){t.when("/",{templateUrl:"options",controller:"Options",controllerAs:"ctrl"}).when("/actions/:action",{templateUrl:"options",controller:"Options",controllerAs:"ctrl"}).otherwise({redirectTo:"/"})}])},233:function(t,e,n){function r(t,e,r,o,u,c,s,l){function f(){t.set(i.SETTING_PDF_DOWNLOAD,E.automaticPdfDownloads)}function p(){t.get(i.SETTING_BUTTON_AVAILABLE_ON,[i.VALUE_BUTTON_AVAILABLE_ON_GOOGLE_SCHOLAR,i.VALUE_BUTTON_AVAILABLE_ON_PUBMED,i.VALUE_BUTTON_AVAILABLE_ON_PUBLISHER_WEBSITES]).then(function(e){return e.forEach(function(t){if(-1===E.buttonAvailableOn.indexOf(t)){var e;switch(t){case i.VALUE_BUTTON_AVAILABLE_ON_GOOGLE_SCHOLAR:e="Google Scholar";break;case i.VALUE_BUTTON_AVAILABLE_ON_PUBMED:e="Pubmed";break;default:e="Publisher websites"}console.log(e),s.trackEvent(i.MIXPANEL_EVENT_SETTINGS_PAGE_INJECTION_TURNED_OFF,{"Browser Ext Turned Off":e})}}),t.set(i.SETTING_BUTTON_AVAILABLE_ON,E.buttonAvailableOn)})}function d(){e.open(i.URL_ACCOUNT)}function h(){E.loginIframe.show=!0}function v(t){t.preventDefault(),r.logout().then(function(t){E.userData={},E.loggedIn=!1,r.clearLoggedInUserDetails(),o.clear(),l.$apply()})}function g(){r.clearProcessingStatus(),r.evaluateLoggedInUserDetail().then(function(t){E.loginIframe.show=!1,E.userData=t,E.loggedIn=!0})}function m(t){E.userData=t,E.loggedIn=!0}function y(t){E.userData={},E.loggedIn=!1}var E=this;if(E.C=i,E.loggedIn=!1,E.userData={},E.loginIframe={show:!1},E.onPdfDownloadChange=f,E.onButtonAvailableOnChange=p,E.onAccountButtonClick=d,E.onLogInButtonClick=h,E.onLogOutButtonClick=v,E.onSuccessfullyLoggedIn=g,t.get(i.SETTING_PDF_DOWNLOAD,i.VALUE_PDF_DOWNLOAD_AUTOMATIC_ENABLED).then(function(t){E.automaticPdfDownloads=t}),t.get(i.SETTING_BUTTON_AVAILABLE_ON,[i.VALUE_BUTTON_AVAILABLE_ON_GOOGLE_SCHOLAR,i.VALUE_BUTTON_AVAILABLE_ON_PUBMED,i.VALUE_BUTTON_AVAILABLE_ON_PUBLISHER_WEBSITES]).then(function(t){E.buttonAvailableOn=t}),r.getLoggedInUserDetails().then(m).catch(y),r.evaluateLoggedInUserDetail().then(m).catch(y),u.action)switch(u.action){case i.ACTION_SHOW_LOGIN_FORM:E.loginIframe.show=!0;break;case i.ACTION_SHOW_PROXY_URL_MISSING:r.getInstitutionProxy().catch(function(){c.pop({type:"warning",body:a(n(201),i.URL_ACCOUNT),bodyOutputType:"trustedHtml",showCloseButton:!0,timeout:1e4})});break;case i.ACTION_SHOW_PROXY_URL_EXISTING:r.getInstitutionProxy().then(function(){c.pop({type:"info",body:a(n(200),i.URL_ACCOUNT),bodyOutputType:"trustedHtml",showCloseButton:!0,timeout:1e4})})}}r.$inject=["Storage","$window","User","List","$routeParams","toaster","Mixpanel","$scope"];var o=n(2),i=n(0),a=(n(1),n(5).sprintf);o.module("App").controller("Options",r)},234:function(t,e,n){n(167)},24:function(t,e,n){function r(t,e,n){var r={INITIAL:0,PROCESSING:1,DONE:2},o=r.INITIAL,s=[],l={getLoggedInUserDetails:function(){return e.get(i.STORAGE_KEY_LOGGED_IN_USER_DETAILS,null).then(function(t){return a.get(t,"id")?t:n.reject("User data not available in the storage")})},evaluateLoggedInUserDetail:function(){var t=this,e=n.defer();if(o===r.INITIAL)o=r.PROCESSING,s.push(e),t.queryUserDetails().then(function(t){l.setLoggedInUserDetails(t),o=r.DONE,s.forEach(function(e){e.resolve(t)})}).catch(function(e){t.clearLoggedInUserDetails(),o=r.INITIAL,s.forEach(function(t){t.reject(e)})}).finally(function(){s=[]});else{if(o!==r.PROCESSING)return l.getLoggedInUserDetails();s.push(e)}return e.promise},clearProcessingStatus:function(){o=r.INITIAL},getInstitutionProxy:function(){return this.evaluateLoggedInUserDetail().then(function(t){switch(a.get(t,"proxy_url_selection",null)){case i.VALUE_PROXY_URL_SELECTION_NONE:case i.VALUE_PROXY_URL_SELECTION_NULL:return n.reject('Proxy url selection is "none" or "null"');case i.VALUE_PROXY_URL_SELECTION_MANUAL:var e=a.get(t,"proxy_url",null);return e||n.reject("Proxy url is not available");case i.VALUE_PROXY_URL_SELECTION_INSTITUTION:var r=a.get(t,"institution_proxy_url",null);return r||n.reject("Institution proxy url is not available");default:return n.reject("Unknown proxy selection option")}})},getSfxUrlByDoiAndPmid:function(t,e){return this.evaluateLoggedInUserDetail().then(function(r){var o=a.get(r,"sfx_url",null);if(!o)return n.reject("Sfx url is not available");var i=c.parse(o,!0);return t&&(i.query.__DOI__="doi:"+t),e&&(i.query.__PMID__="pmid:"+e),c.format(i).replace("__DOI__","id").replace("__PMID__","id")})},getSubscriptionStatus:function(){return this.querySubscriptionStatus().then(function(t){return"free"===t.account?"expired"===t.status?"trial"===t.previous_type?i.SUBSCRIPTION_TRIAL_EXPIRED:i.SUBSCRIPTION_PRO_EXPIRED:i.SUBSCRIPTION_FREE:i.SUBSCRIPTION_PRO}).catch(function(){return i.SUBSCRIPTION_FREE})},setLoggedInUserDetails:function(t){e.set(i.STORAGE_KEY_LOGGED_IN_USER_DETAILS,t)},clearLoggedInUserDetails:function(){e.set(i.STORAGE_KEY_LOGGED_IN_USER_DETAILS,null),e.set(i.STORAGE_KEY_DISPLAYED_GO_PRO_TOOLTIP,!1)},queryUserDetails:function(){return u.get(i.URL_USER_DETAILS).then(function(t){var e=a.get(t,"data",null);return e?{email:e.email,name:e.full_name,id:e.id,institution:e.institution,institution_proxy_url:e.institution_proxy_url,proxy_url:e.proxy_url,proxy_url_selection:e.proxy_url_selection,sfx_url:e.sfx_url}:n.reject("Unable to get user details")})},querySubscriptionStatus:function(){return u.get(i.URL_SUBSCRIPTION_STATUS).then(function(t){var e=a.get(t,"data",null);return e||n.reject("Unable to load subscription details")})},logout:function(){return u.get(i.URL_LOGOUT,!0)}};return l}r.$inject=["$http","Storage","$q"];var o=n(2),i=n(0),a=n(1),u=n(7),c=n(9);o.module("App").factory("User",r)},41:function(t,e,n){function r(t,e,n){function r(t){return!t.group_id&&!t.name}function o(){return c.get(i.URL_COLLECTIONS).then(function(t){var e=u.get(t,"data.collections",[]),n=[];return e.forEach(function(t){r(t)&&(t.name=i.DEFAULT_PERSONAL_LIBRARY_NAME),n.push(c.get(s(i.URL_COLLECTION_LISTS,t.collection_id)).then(function(e){var n=u.get(e,"data.lists",[]);return t.lists=f(n),!0}))}),a.all(n).then(function(){return l().then(function(t){return{groups:u.reduce(t,function(t,n,r){return t.push({group_id:r,collections:u.filter(e,{group_id:parseInt(r)||null})}),t},[]).sort(function(t){return null!==t}),groupNames:t}})})})}function l(){return c.get(i.URL_GROUPS).then(function(t){var e=u.get(t,"data.groups",[]);return u.reduce(e,function(t,e){return t[e.id]=e.name,t},{null:"Personal"})})}function f(t){function e(t,n,r,o){return u.sortBy(t,"name").forEach(function(t){t.level=r,o.push(t);var i=u.partition(n,{parent_id:t.id});e(i[0],i[1],r+1,o)}),o}var n=u.partition(t,function(t){return!t.parent_id});return e(n[0],n[1],0,[])}return{queryFlat:function(){return o()},queryStorage:function(){return e.get("lists",null).then(function(t){return u.isNull(t)?n.reject("The lists array is empty"):t})},addItems:function(t,e){return c.post(s(i.URL_LISTS_ADD_ITEMS,t),{item_ids:e})},clear:function(){e.set("lists",null)}}}r.$inject=["$http","Storage","$q"];var o=n(2),i=n(0),a=n(8),u=n(1),c=n(7),s=n(5).sprintf;o.module("App").factory("List",r)},50:function(t,e){t.exports='<div class="readcube-login-container" ng-if="show" ng-click="onCloseButtonClick()">\n  <div class="readcube-login-close">\n    <div class="readcube-login-close-button">×</div>\n  </div>\n  <iframe class="readcube-login-iframe" src="{{iframeUrl}}"></iframe>\n</div>'},61:function(t,e,n){var r=n(2),o=n(0);r.module("App").config(["$sceDelegateProvider",function(t){t.resourceUrlWhitelist(["self",o.URL_REGEXP_MAIN_URL])}])},65:function(t,e,n){function r(t){return{restrict:"A",template:n(50),scope:{show:"=",whenSuccessfullyLoggedIn:"&"},link:function(e,n,r){function o(){e.show=!1}e.iframeUrl=a.URL_LOGIN_FORM,e.onCloseButtonClick=o,e.$watch("show",function(){var n=t.document;u(n.body).add(n.documentElement).toggleClass("readcube-iframe-displayed",e.show)}),t.addEventListener("message",function(t){if(!i.get(t,"origin","").match(a.URL_REGEXP_MAIN_URL))return!1;var n=t.data;"auth:success"!==n.type||"login"!==n.auth&&"register"!==n.auth||(e.whenSuccessfullyLoggedIn({userData:n.user}),e.$apply())})}}}r.$inject=["$window"];var o=n(2),i=n(1),a=n(0),u=n(4);n(5).sprintf,n(74);o.module("App").directive("loginIframe",r)},68:function(t,e,n){function r(t,e){return{responseError:function(n){return-1!==u.get(n,"config.url","").indexOf(i.DOMAIN_READCUBE)&&n.status==a.UNAUTHORIZED&&t.set({loggedInUserDetails:null}),e.reject(n)}}}r.$inject=["Storage","$q"];var o=n(2),i=n(0),a=n(11),u=n(1);o.module("App").factory("ClearUserDataInterceptor",r).config(["$httpProvider",function(t){t.interceptors.push("ClearUserDataInterceptor")}])},7:function(t,e,n){function r(t,e,n,r,a){var u=o.defer(),c=new XMLHttpRequest;return c.open(e,t,!0),c.onload=function(){c.status>=200&&c.status<400?u.resolve({data:r?c.responseText:JSON.parse(c.responseText),status:c.status,url:c.responseURL}):u.reject({status:c.status})},c.onerror=function(){u.reject("Error in xhr."+e)},i.isReadcubeUrl(t)&&s.forEach(function(t){c.setRequestHeader(t[0],t[1])}),a&&c.setRequestHeader("Accept",a),n?(c.setRequestHeader("Content-Type","application/json; charset=UTF-8"),c.send(JSON.stringify(n))):c.send(),u.promise}var o=n(8),i=n(13),a=n(5).sprintf,u=n(0),c=chrome.runtime.getManifest().version,s=[["Sync-Version",u.HEADER_SYNC_VERSION],["X-Readcube-Sync-Token",a(u.HEADER_VALUE_SYNC_TOKEN,c)],["X-Readcube-Sync-Client",a(u.HEADER_VALUE_SYNC_CLIENT,"chrome",c)]];!function(){var t}();t.exports={get:function(t,e,n){return r(t,"GET",null,e,n)},patch:function(t,e){return r(t,"PATCH",e)},delete:function(t){return r(t,"DELETE")},post:function(t,e){return r(t,"POST",e)}}},8:function(t,e,n){(function(e,n){/*!
 *
 * Copyright 2009-2012 Kris Kowal under the terms of the MIT
 * license found at http://github.com/kriskowal/q/raw/master/LICENSE
 *
 * With parts by Tyler Close
 * Copyright 2007-2009 Tyler Close under the terms of the MIT X license found
 * at http://www.opensource.org/licenses/mit-license.html
 * Forked at ref_send.js version: 2009-05-11
 *
 * With parts by Mark Miller
 * Copyright (C) 2011 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */
!function(e){"use strict";if("function"==typeof bootstrap)bootstrap("promise",e);else{t.exports=e()}}(function(){"use strict";function t(t){return function(){return W.apply(t,arguments)}}function r(t){return t===Object(t)}function o(t){return"[object StopIteration]"===nt(t)||t instanceof V}function i(t,e){if(F&&e.stack&&"object"==typeof t&&null!==t&&t.stack&&-1===t.stack.indexOf(rt)){for(var n=[],r=e;r;r=r.source)r.stack&&n.unshift(r.stack);n.unshift(t.stack);var o=n.join("\n"+rt+"\n");t.stack=a(o)}}function a(t){for(var e=t.split("\n"),n=[],r=0;r<e.length;++r){var o=e[r];s(o)||u(o)||!o||n.push(o)}return n.join("\n")}function u(t){return-1!==t.indexOf("(module.js:")||-1!==t.indexOf("(node.js:")}function c(t){var e=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(t);if(e)return[e[1],Number(e[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(t);if(n)return[n[1],Number(n[2])];var r=/.*@(.+):(\d+)$/.exec(t);return r?[r[1],Number(r[2])]:void 0}function s(t){var e=c(t);if(!e)return!1;var n=e[0],r=e[1];return n===H&&r>=Y&&r<=ct}function l(){if(F)try{throw new Error}catch(r){var t=r.stack.split("\n"),e=t[0].indexOf("@")>0?t[1]:t[2],n=c(e);if(!n)return;return H=n[0],n[1]}}function f(t){return t instanceof v?t:E(t)?L(t):w(t)}function p(){function t(t){e=t,i.source=t,K(n,function(e,n){f.nextTick(function(){t.promiseDispatch.apply(t,n)})},void 0),n=void 0,r=void 0}var e,n=[],r=[],o=Z(p.prototype),i=Z(v.prototype);if(i.promiseDispatch=function(t,o,i){var a=Q(arguments);n?(n.push(a),"when"===o&&i[1]&&r.push(i[1])):f.nextTick(function(){e.promiseDispatch.apply(e,a)})},i.valueOf=function(){if(n)return i;var t=m(e);return y(t)&&(e=t),t},i.inspect=function(){return e?e.inspect():{state:"pending"}},f.longStackSupport&&F)try{throw new Error}catch(t){i.stack=t.stack.substring(t.stack.indexOf("\n")+1)}return o.promise=i,o.resolve=function(n){e||t(f(n))},o.fulfill=function(n){e||t(w(n))},o.reject=function(n){e||t(R(n))},o.notify=function(t){e||K(r,function(e,n){f.nextTick(function(){n(t)})},void 0)},o}function d(t){if("function"!=typeof t)throw new TypeError("resolver must be a function.");var e=p();try{t(e.resolve,e.reject,e.notify)}catch(t){e.reject(t)}return e.promise}function h(t){return d(function(e,n){for(var r=0,o=t.length;r<o;r++)f(t[r]).then(e,n)})}function v(t,e,n){void 0===e&&(e=function(t){return R(new Error("Promise does not support operation: "+t))}),void 0===n&&(n=function(){return{state:"unknown"}});var r=Z(v.prototype);if(r.promiseDispatch=function(n,o,i){var a;try{a=t[o]?t[o].apply(r,i):e.call(r,o,i)}catch(t){a=R(t)}n&&n(a)},r.inspect=n,n){var o=n();"rejected"===o.state&&(r.exception=o.reason),r.valueOf=function(){var t=n();return"pending"===t.state||"rejected"===t.state?r:t.value}}return r}function g(t,e,n,r){return f(t).then(e,n,r)}function m(t){if(y(t)){var e=t.inspect();if("fulfilled"===e.state)return e.value}return t}function y(t){return t instanceof v}function E(t){return r(t)&&"function"==typeof t.then}function T(t){return y(t)&&"pending"===t.inspect().state}function _(t){return!y(t)||"fulfilled"===t.inspect().state}function b(t){return y(t)&&"rejected"===t.inspect().state}function O(){ot.length=0,it.length=0,ut||(ut=!0)}function I(t,n){ut&&("object"==typeof e&&"function"==typeof e.emit&&f.nextTick.runAfter(function(){-1!==z(it,t)&&(e.emit("unhandledRejection",n,t),at.push(t))}),it.push(t),n&&void 0!==n.stack?ot.push(n.stack):ot.push("(no stack) "+n))}function A(t){if(ut){var n=z(it,t);-1!==n&&("object"==typeof e&&"function"==typeof e.emit&&f.nextTick.runAfter(function(){var r=z(at,t);-1!==r&&(e.emit("rejectionHandled",ot[n],t),at.splice(r,1))}),it.splice(n,1),ot.splice(n,1))}}function R(t){var e=v({when:function(e){return e&&A(this),e?e(t):this}},function(){return this},function(){return{state:"rejected",reason:t}});return I(e,t),e}function w(t){return v({when:function(){return t},get:function(e){return t[e]},set:function(e,n){t[e]=n},delete:function(e){delete t[e]},post:function(e,n){return null===e||void 0===e?t.apply(void 0,n):t[e].apply(t,n)},apply:function(e,n){return t.apply(e,n)},keys:function(){return et(t)}},void 0,function(){return{state:"fulfilled",value:t}})}function L(t){var e=p();return f.nextTick(function(){try{t.then(e.resolve,e.reject,e.notify)}catch(t){e.reject(t)}}),e.promise}function N(t){return v({isDef:function(){}},function(e,n){return D(t,e,n)},function(){return f(t).inspect()})}function U(t,e,n){return f(t).spread(e,n)}function S(t){return function(){function e(t,e){var a;if("undefined"==typeof StopIteration){try{a=n[t](e)}catch(t){return R(t)}return a.done?f(a.value):g(a.value,r,i)}try{a=n[t](e)}catch(t){return o(t)?f(t.value):R(t)}return g(a,r,i)}var n=t.apply(this,arguments),r=e.bind(e,"next"),i=e.bind(e,"throw");return r()}}function C(t){f.done(f.async(t)())}function P(t){throw new V(t)}function k(t){return function(){return U([this,$(arguments)],function(e,n){return t.apply(e,n)})}}function D(t,e,n){return f(t).dispatch(e,n)}function $(t){return g(t,function(t){var e=0,n=p();return K(t,function(r,o,i){var a;y(o)&&"fulfilled"===(a=o.inspect()).state?t[i]=a.value:(++e,g(o,function(r){t[i]=r,0==--e&&n.resolve(t)},n.reject,function(t){n.notify({index:i,value:t})}))},void 0),0===e&&n.resolve(t),n.promise})}function x(t){if(0===t.length)return f.resolve();var e=f.defer(),n=0;return K(t,function(r,o,i){function a(t){e.resolve(t)}function u(){0===--n&&e.reject(new Error("Can't get fulfillment value from any promise, all promises were rejected."))}function c(t){e.notify({index:i,value:t})}var s=t[i];n++,g(s,a,u,c)},void 0),e.promise}function j(t){return g(t,function(t){return t=J(t,f),g($(J(t,function(t){return g(t,X,X)})),function(){return t})})}function B(t){return f(t).allSettled()}function M(t,e){return f(t).then(void 0,void 0,e)}function G(t,e){return f(t).nodeify(e)}var F=!1;try{throw new Error}catch(t){F=!!t.stack}var H,V,Y=l(),X=function(){},q=function(){function t(){for(var t,e;o.next;)o=o.next,t=o.task,o.task=void 0,e=o.domain,e&&(o.domain=void 0,e.enter()),r(t,e);for(;s.length;)t=s.pop(),r(t);a=!1}function r(e,n){try{e()}catch(e){if(c)throw n&&n.exit(),setTimeout(t,0),n&&n.enter(),e;setTimeout(function(){throw e},0)}n&&n.exit()}var o={task:void 0,next:null},i=o,a=!1,u=void 0,c=!1,s=[];if(q=function(t){i=i.next={task:t,domain:c&&e.domain,next:null},a||(a=!0,u())},"object"==typeof e&&"[object process]"===e.toString()&&e.nextTick)c=!0,u=function(){e.nextTick(t)};else if("function"==typeof n)u="undefined"!=typeof window?n.bind(window,t):function(){n(t)};else if("undefined"!=typeof MessageChannel){var l=new MessageChannel;l.port1.onmessage=function(){u=f,l.port1.onmessage=t,t()};var f=function(){l.port2.postMessage(0)};u=function(){setTimeout(t,0),f()}}else u=function(){setTimeout(t,0)};return q.runAfter=function(t){s.push(t),a||(a=!0,u())},q}(),W=Function.call,Q=t(Array.prototype.slice),K=t(Array.prototype.reduce||function(t,e){var n=0,r=this.length;if(1===arguments.length)for(;;){if(n in this){e=this[n++];break}if(++n>=r)throw new TypeError}for(;n<r;n++)n in this&&(e=t(e,this[n],n));return e}),z=t(Array.prototype.indexOf||function(t){for(var e=0;e<this.length;e++)if(this[e]===t)return e;return-1}),J=t(Array.prototype.map||function(t,e){var n=this,r=[];return K(n,function(o,i,a){r.push(t.call(e,i,a,n))},void 0),r}),Z=Object.create||function(t){function e(){}return e.prototype=t,new e},tt=t(Object.prototype.hasOwnProperty),et=Object.keys||function(t){var e=[];for(var n in t)tt(t,n)&&e.push(n);return e},nt=t(Object.prototype.toString);V="undefined"!=typeof ReturnValue?ReturnValue:function(t){this.value=t};var rt="From previous event:";f.resolve=f,f.nextTick=q,f.longStackSupport=!1,"object"==typeof e&&e&&e.env&&e.env.Q_DEBUG&&(f.longStackSupport=!0),f.defer=p,p.prototype.makeNodeResolver=function(){var t=this;return function(e,n){e?t.reject(e):arguments.length>2?t.resolve(Q(arguments,1)):t.resolve(n)}},f.Promise=d,f.promise=d,d.race=h,d.all=$,d.reject=R,d.resolve=f,f.passByCopy=function(t){return t},v.prototype.passByCopy=function(){return this},f.join=function(t,e){return f(t).join(e)},v.prototype.join=function(t){return f([this,t]).spread(function(t,e){if(t===e)return t;throw new Error("Can't join: not the same: "+t+" "+e)})},f.race=h,v.prototype.race=function(){return this.then(f.race)},f.makePromise=v,v.prototype.toString=function(){return"[object Promise]"},v.prototype.then=function(t,e,n){function r(e){try{return"function"==typeof t?t(e):e}catch(t){return R(t)}}function o(t){if("function"==typeof e){i(t,u);try{return e(t)}catch(t){return R(t)}}return R(t)}function a(t){return"function"==typeof n?n(t):t}var u=this,c=p(),s=!1;return f.nextTick(function(){u.promiseDispatch(function(t){s||(s=!0,c.resolve(r(t)))},"when",[function(t){s||(s=!0,c.resolve(o(t)))}])}),u.promiseDispatch(void 0,"when",[void 0,function(t){var e,n=!1;try{e=a(t)}catch(t){if(n=!0,!f.onerror)throw t;f.onerror(t)}n||c.notify(e)}]),c.promise},f.tap=function(t,e){return f(t).tap(e)},v.prototype.tap=function(t){return t=f(t),this.then(function(e){return t.fcall(e).thenResolve(e)})},f.when=g,v.prototype.thenResolve=function(t){return this.then(function(){return t})},f.thenResolve=function(t,e){return f(t).thenResolve(e)},v.prototype.thenReject=function(t){return this.then(function(){throw t})},f.thenReject=function(t,e){return f(t).thenReject(e)},f.nearer=m,f.isPromise=y,f.isPromiseAlike=E,f.isPending=T,v.prototype.isPending=function(){return"pending"===this.inspect().state},f.isFulfilled=_,v.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},f.isRejected=b,v.prototype.isRejected=function(){return"rejected"===this.inspect().state};var ot=[],it=[],at=[],ut=!0;f.resetUnhandledRejections=O,f.getUnhandledReasons=function(){return ot.slice()},f.stopUnhandledRejectionTracking=function(){O(),ut=!1},O(),f.reject=R,f.fulfill=w,f.master=N,f.spread=U,v.prototype.spread=function(t,e){return this.all().then(function(e){return t.apply(void 0,e)},e)},f.async=S,f.spawn=C,f.return=P,f.promised=k,f.dispatch=D,v.prototype.dispatch=function(t,e){var n=this,r=p();return f.nextTick(function(){n.promiseDispatch(r.resolve,t,e)}),r.promise},f.get=function(t,e){return f(t).dispatch("get",[e])},v.prototype.get=function(t){return this.dispatch("get",[t])},f.set=function(t,e,n){return f(t).dispatch("set",[e,n])},v.prototype.set=function(t,e){return this.dispatch("set",[t,e])},f.del=f.delete=function(t,e){return f(t).dispatch("delete",[e])},v.prototype.del=v.prototype.delete=function(t){return this.dispatch("delete",[t])},f.mapply=f.post=function(t,e,n){return f(t).dispatch("post",[e,n])},v.prototype.mapply=v.prototype.post=function(t,e){return this.dispatch("post",[t,e])},f.send=f.mcall=f.invoke=function(t,e){return f(t).dispatch("post",[e,Q(arguments,2)])},v.prototype.send=v.prototype.mcall=v.prototype.invoke=function(t){return this.dispatch("post",[t,Q(arguments,1)])},f.fapply=function(t,e){return f(t).dispatch("apply",[void 0,e])},v.prototype.fapply=function(t){return this.dispatch("apply",[void 0,t])},f.try=f.fcall=function(t){return f(t).dispatch("apply",[void 0,Q(arguments,1)])},v.prototype.fcall=function(){return this.dispatch("apply",[void 0,Q(arguments)])},f.fbind=function(t){var e=f(t),n=Q(arguments,1);return function(){return e.dispatch("apply",[this,n.concat(Q(arguments))])}},v.prototype.fbind=function(){var t=this,e=Q(arguments);return function(){return t.dispatch("apply",[this,e.concat(Q(arguments))])}},f.keys=function(t){return f(t).dispatch("keys",[])},v.prototype.keys=function(){return this.dispatch("keys",[])},f.all=$,v.prototype.all=function(){return $(this)},f.any=x,v.prototype.any=function(){return x(this)},f.allResolved=function(t,e,n){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(e+" is deprecated, use "+n+" instead.",new Error("").stack),t.apply(t,arguments)}}(j,"allResolved","allSettled"),v.prototype.allResolved=function(){return j(this)},f.allSettled=B,v.prototype.allSettled=function(){return this.then(function(t){return $(J(t,function(t){function e(){return t.inspect()}return t=f(t),t.then(e,e)}))})},f.fail=f.catch=function(t,e){return f(t).then(void 0,e)},v.prototype.fail=v.prototype.catch=function(t){return this.then(void 0,t)},f.progress=M,v.prototype.progress=function(t){return this.then(void 0,void 0,t)},f.fin=f.finally=function(t,e){return f(t).finally(e)},v.prototype.fin=v.prototype.finally=function(t){return t=f(t),this.then(function(e){return t.fcall().then(function(){return e})},function(e){return t.fcall().then(function(){throw e})})},f.done=function(t,e,n,r){return f(t).done(e,n,r)},v.prototype.done=function(t,n,r){var o=function(t){f.nextTick(function(){if(i(t,a),!f.onerror)throw t;f.onerror(t)})},a=t||n||r?this.then(t,n,r):this;"object"==typeof e&&e&&e.domain&&(o=e.domain.bind(o)),a.then(void 0,o)},f.timeout=function(t,e,n){return f(t).timeout(e,n)},v.prototype.timeout=function(t,e){var n=p(),r=setTimeout(function(){e&&"string"!=typeof e||(e=new Error(e||"Timed out after "+t+" ms"),e.code="ETIMEDOUT"),n.reject(e)},t);return this.then(function(t){clearTimeout(r),n.resolve(t)},function(t){clearTimeout(r),n.reject(t)},n.notify),n.promise},f.delay=function(t,e){return void 0===e&&(e=t,t=void 0),f(t).delay(e)},v.prototype.delay=function(t){return this.then(function(e){var n=p();return setTimeout(function(){n.resolve(e)},t),n.promise})},f.nfapply=function(t,e){return f(t).nfapply(e)},v.prototype.nfapply=function(t){var e=p(),n=Q(t);return n.push(e.makeNodeResolver()),this.fapply(n).fail(e.reject),e.promise},f.nfcall=function(t){var e=Q(arguments,1);return f(t).nfapply(e)},v.prototype.nfcall=function(){var t=Q(arguments),e=p();return t.push(e.makeNodeResolver()),this.fapply(t).fail(e.reject),e.promise},f.nfbind=f.denodeify=function(t){var e=Q(arguments,1);return function(){var n=e.concat(Q(arguments)),r=p();return n.push(r.makeNodeResolver()),f(t).fapply(n).fail(r.reject),r.promise}},v.prototype.nfbind=v.prototype.denodeify=function(){var t=Q(arguments);return t.unshift(this),f.denodeify.apply(void 0,t)},f.nbind=function(t,e){var n=Q(arguments,2);return function(){function r(){return t.apply(e,arguments)}var o=n.concat(Q(arguments)),i=p();return o.push(i.makeNodeResolver()),f(r).fapply(o).fail(i.reject),i.promise}},v.prototype.nbind=function(){var t=Q(arguments,0);return t.unshift(this),f.nbind.apply(void 0,t)},f.nmapply=f.npost=function(t,e,n){return f(t).npost(e,n)},v.prototype.nmapply=v.prototype.npost=function(t,e){var n=Q(e||[]),r=p();return n.push(r.makeNodeResolver()),this.dispatch("post",[t,n]).fail(r.reject),r.promise},f.nsend=f.nmcall=f.ninvoke=function(t,e){var n=Q(arguments,2),r=p();return n.push(r.makeNodeResolver()),f(t).dispatch("post",[e,n]).fail(r.reject),r.promise},v.prototype.nsend=v.prototype.nmcall=v.prototype.ninvoke=function(t){var e=Q(arguments,1),n=p();return e.push(n.makeNodeResolver()),this.dispatch("post",[t,e]).fail(n.reject),n.promise},f.nodeify=G,v.prototype.nodeify=function(t){if(!t)return this;this.then(function(e){f.nextTick(function(){t(null,e)})},function(e){f.nextTick(function(){t(e)})})},f.noConflict=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var ct=l();return f})}).call(e,n(14),n(20).setImmediate)}},[234]);